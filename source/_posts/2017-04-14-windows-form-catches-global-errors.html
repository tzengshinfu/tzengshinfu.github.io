---
layout: post
title: Windows Form捕捉全域錯誤並處理
tag:
- windows form
---

在Program.cs的進入點(Main方法)新增<br /><pre><span style="color: green;">// 宣告在Application.Run之前</span>
<span style="color: grey;">#region</span> 捕捉全域錯誤
Application.ThreadException += new ThreadExceptionEventHandler(<span style="color: #3367d6;">OnThreadException</span>);
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException);
AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(<span style="color: #0b8043;">OnUnhandledException</span>);
<span style="color: grey;">#endregion</span></pre><br /> 並在<font color="#3367d6">OnThreadException</font>和<font color="#0b8043">OnUnhandledException</font>事件做處理<div>
<br />
<br />
參考：<a href="https://learn.microsoft.com/zh-tw/dotnet/api/system.windows.forms.application.setunhandledexceptionmode?view=windowsdesktop-8.0" rel="nofollow" target="_blank">Application.SetUnhandledExceptionMode 方法</a><br /></div>
