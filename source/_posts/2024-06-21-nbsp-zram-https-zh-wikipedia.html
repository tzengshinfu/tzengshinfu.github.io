---
layout: post
title: 樹莓派啟用ZRAM以改善效能
tag:
- raspberry pi 4
- zram
---

<p>&nbsp;ZRAM解釋&nbsp;<a href="https://zh.wikipedia.org/zh-tw/Zram" rel="nofollow" target="_blank">https://zh.wikipedia.org/zh-tw/Zram</a></p><p><i>zram仍有利於嵌入式裝置、小筆電和其它相似的低階硬體裝置。這些裝置通常使用固態儲存，它們由於其原生性質而壽命有限，因而避免以其提供交換空間可防止其迅速磨損。此外，使用zRAM還可顯著降低Linux系統用於交換的I/O。</i></p><p>1.建立設定ZRAM的ShellScript</p><p><span style="color: #8cc265;">user@HOST</span>:<span style="color: #4aa5f0;">~&nbsp;$</span> sudo nano /usr/local/sbin/zram_setup.sh</p><p>內容如下</p><p><span style="background-color: #f3f3f3;"><span style="color: #42b3c2;">#!/bin/bash<br /><br /></span>memsize=<span style="color: #8cc265;">$(</span>free <span style="color: #8cc265;">|</span> <span style="color: #4aa5f0;">grep</span> <span style="color: #c162de;">-e</span> "^Mem:" <span style="color: #8cc265;">|</span> <span style="color: #4aa5f0;">awk </span>'{print $2}'<span style="color: #8cc265;">)<br /></span><span style="color: #4aa5f0;">echo </span><span style="color: #8cc265;">$((</span> <span style="color: #e05561;">$memsize</span> * 1024 <span style="color: #8cc265;">))</span> <span style="color: #8cc265;">|</span> sudo tee /sys/block/zram0/disksize<br />mkswap /dev/zram0<br />swapon <span style="color: #c162de;">-p</span> 10 /dev/zram0</span></p><p><br /></p><p>2.將其設定為可執行檔</p><p><span style="color: #8cc265;">user@HOST</span>:<span style="color: #4aa5f0;">~&nbsp;$</span>&nbsp;sudo chmod +x /usr/local/sbin/zram_setup.sh</p><p><br /></p><p>3.設定服務，指向設定ZRAM的ShellScript</p><p><span style="color: #8cc265;">user@HOST</span>:<span style="color: #4aa5f0;">~&nbsp;$</span>&nbsp;sudo nano /etc/systemd/system/zram_setup.service</p><p>內容如下</p><p><span style="background-color: #f3f3f3;"><span style="color: #8cc265;">[Service]</span><br />Type=simple<br />ExecStart=/usr/local/sbin/zram_setup.sh</span></p><p><span style="background-color: #f3f3f3;"><span style="color: #8cc265;">[Install]</span><br />WantedBy=default.target</span></p><p><span style="background-color: #f3f3f3;"><br /></span></p>4.編輯/etc/modules<div><span style="color: #8cc265;">user@HOST</span>:<span style="color: #4aa5f0;">~&nbsp;$</span>&nbsp;sudo nano&nbsp;/etc/modules<div><div>新增內容</div><div><span style="background-color: #f3f3f3;">zram</span></div><div><br /></div><div>5.啟用ZRAM服務</div><div><br /></div><div><span style="color: #8cc265;">user@HOST</span>:<span style="color: #4aa5f0;">~&nbsp;$</span>&nbsp;sudo systemctl daemon-reload</div><div><span style="color: #8cc265;">user@HOST</span>:<span style="color: #4aa5f0;">~&nbsp;$</span>&nbsp;sudo systemctl start zram_setup.service</div><div><span style="color: #8cc265;">user@HOST</span>:<span style="color: #4aa5f0;">~&nbsp;$</span>&nbsp;sudo systemctl enable zram_setup.service</div><div><p><br /></p><p>參考來源：<a href="https://www.team-bob.org/raspberry-pi-%E6%95%88%E8%83%BD%E6%94%B9%E5%96%84-%E4%BD%BF%E7%94%A8-zram/" rel="nofollow" target="_blank">Raspberry Pi 效能改善 – 使用 ZRAM</a></p></div></div></div>
