---
layout: post
title: 已加入gitignore的檔案移除版控並保留本機檔案
tag:
- git
---

<p>Windows</p><p>1.開啟命令列</p><p>2.修改目前路徑到該repo</p><p>3.執行<span style="color: #c7254e;">chcp 65001</span></p><li data-end="249" data-start="188"><span style="font-size: x-small;">65001=UTF-8，避免路徑字串與命令列語系不同導致<span style="font-family: monospace;">fatal: pathspec '檔案路徑' did not match any files</span>的亂碼問題。</span></li><p>4.執行<span style="color: #c7254e; font-family: Menlo, Monaco, Consolas, Courier New, monospace;"><span style="text-wrap-mode: nowrap;">for /f "delims=" %f in ('git ls-files -i -c --exclude-from=.gitignore') do git rm --cached "%f"</span></span></p><li data-end="249" data-start="188"><span style="font-size: x-small;"><code data-end="211" data-start="190">for /f "delims=" %f</code>：使用 <code data-end="224" data-start="215">delims=</code> 避免空格導致的分割問題，確保整個檔名被正確處理。</span></li><li data-end="340" data-start="250"><span style="font-size: x-small;"><code data-end="305" data-start="252">in ('git ls-files -i -c --exclude-from=.gitignore')</code>：執行 <code data-end="323" data-start="309">git ls-files</code> 並將輸出逐行存入變數 <code data-end="339" data-start="335">%f</code>。</span></li><li data-end="392" data-start="341"><span style="font-size: x-small;"><code data-end="365" data-start="343">git rm --cached "%f"</code>：用雙引號包住變數，確保帶空格的檔案名稱能被正確處理。</span></li><p><br /></p><p>Linux</p><p>1.開啟命令列</p><p>2.修改目前路徑到該repo</p><p>3.執行<span style="color: #c7254e; font-size: medium;">git ls-files -i -c --exclude-from=.gitignore -z | xargs -0 git rm --cached</span></p><li data-end="271" data-start="215"><span style="font-size: x-small;"><code data-end="221" data-start="217">-z</code>：讓 <code data-end="238" data-start="224">git ls-files</code> 以 NUL (<code data-end="250" data-start="246">\0</code>) 分隔檔名，防止空格或特殊字符導致問題。</span></li><li data-end="343" data-start="272"><span style="font-size: x-small;"><code data-end="284" data-start="274">xargs -0</code>：讓 <code data-end="294" data-start="287">xargs</code> 以 NUL 分隔來處理檔名，確保帶空格的檔案能被正確傳遞給 <code data-end="342" data-start="325">git rm --cached</code>。</span></li><p><br /></p><p>參考來源：ChatGPT</p>
