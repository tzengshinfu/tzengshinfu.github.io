---
layout: post
title: 修正線上進行中的舊表單Js程式
tag:
- easyflow gp
- sql
---

<br />
<div class="MsoListParagraph" style="margin-left: 18pt; mso-list: l0 level1 lfo1; mso-para-margin-left: 0gd; text-indent: -18pt;">
<!--[if !supportLists]--><span lang="EN-US" style="color: black; mso-bidi-font-family: Calibri; mso-fareast-font-family: Calibri;"><span style="mso-list: Ignore;">1.<span style="font-family: &quot;times new roman&quot;; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: normal; font: 7pt &quot;times new roman&quot;; line-height: normal;">&nbsp; &nbsp; &nbsp;&nbsp;</span></span></span><span style="font-family: , sans-serif; text-indent: -18pt;">用[</span><span style="font-family: , sans-serif; text-indent: -18pt;">程式片段]定位</span><span style="font-family: , sans-serif; text-indent: -18pt;">線上進行中所有的表單版號</span></div><pre><code class="sql"> DECLARE @CODE NVARCHAR(4000) = '[要尋找的程式片段]'; <br /><br /> SELECT <br />     DISTINCT FormDefinition.id, <br />     FormDefinition.version, <br />     FormDefinition.formDefinitionName, <br />     CAST(FormDefinition.script AS NVARCHAR(MAX)) AS script, <br />     '進行中' AS status <br /> FROM <br />     ProcessInstance <br />     INNER JOIN LocalRelevantData ON LocalRelevantData.containerOID = ProcessInstance.contextOID <br />     INNER JOIN FormInstance ON FormInstance.OID = LocalRelevantData.valueOID <br />     INNER JOIN FormDefinition ON FormDefinition.OID = FormInstance.definitionOID <br /> WHERE <br />     ProcessInstance.currentState IN (0, 1, 2) <br />     AND FormDefinition.script LIKE '%' + @CODE + '%' <br /> UNION <br /> SELECT <br />     id, <br />     version, <br />     formDefinitionName, <br />     CAST(FormDefinition.script AS NVARCHAR(MAX)) AS script, <br />     '最新版' AS status <br /> FROM <br />     FormDefinition <br /> WHERE <br />     publicationStatus = 'RELEASED' <br />     AND FormDefinition.script LIKE '%' + @CODE + '%';</code></pre>
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhB7PEIoMNCbloETo6BtO_KLBV64vxNMVspuUNNCNEc8yuvKWZGN6knDxy9VYQNOVFlOsa7kr1gNthGqE9eDMaDPyOMDmEL54h-Y8anWlvLXcdbUBoTmeu-aqhWzEFcwWFWLgrCG3iMZGSw/s1600/ATT.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="185" data-original-width="1143" height="63" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhB7PEIoMNCbloETo6BtO_KLBV64vxNMVspuUNNCNEc8yuvKWZGN6knDxy9VYQNOVFlOsa7kr1gNthGqE9eDMaDPyOMDmEL54h-Y8anWlvLXcdbUBoTmeu-aqhWzEFcwWFWLgrCG3iMZGSw/s400/ATT.png" width="400" /></a></div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgExkOgUh59Xf7NXcpZPVJV4X-XGFxh1_FJTMTdjaoIvokp4ACGkPHQCtQ3yskkojJ-TNbrKpk2jY3IahWZQUhb8jcg4_5lfvZVgbAHMptwBjhmH6iviLpeLZ-XTTeRlL6H6QXJrIF893RK/s1600/1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgExkOgUh59Xf7NXcpZPVJV4X-XGFxh1_FJTMTdjaoIvokp4ACGkPHQCtQ3yskkojJ-TNbrKpk2jY3IahWZQUhb8jcg4_5lfvZVgbAHMptwBjhmH6iviLpeLZ-XTTeRlL6H6QXJrIF893RK/s1600/1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgExkOgUh59Xf7NXcpZPVJV4X-XGFxh1_FJTMTdjaoIvokp4ACGkPHQCtQ3yskkojJ-TNbrKpk2jY3IahWZQUhb8jcg4_5lfvZVgbAHMptwBjhmH6iviLpeLZ-XTTeRlL6H6QXJrIF893RK/s1600/1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgExkOgUh59Xf7NXcpZPVJV4X-XGFxh1_FJTMTdjaoIvokp4ACGkPHQCtQ3yskkojJ-TNbrKpk2jY3IahWZQUhb8jcg4_5lfvZVgbAHMptwBjhmH6iviLpeLZ-XTTeRlL6H6QXJrIF893RK/s1600/1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgExkOgUh59Xf7NXcpZPVJV4X-XGFxh1_FJTMTdjaoIvokp4ACGkPHQCtQ3yskkojJ-TNbrKpk2jY3IahWZQUhb8jcg4_5lfvZVgbAHMptwBjhmH6iviLpeLZ-XTTeRlL6H6QXJrIF893RK/s1600/1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgExkOgUh59Xf7NXcpZPVJV4X-XGFxh1_FJTMTdjaoIvokp4ACGkPHQCtQ3yskkojJ-TNbrKpk2jY3IahWZQUhb8jcg4_5lfvZVgbAHMptwBjhmH6iviLpeLZ-XTTeRlL6H6QXJrIF893RK/s1600/1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgExkOgUh59Xf7NXcpZPVJV4X-XGFxh1_FJTMTdjaoIvokp4ACGkPHQCtQ3yskkojJ-TNbrKpk2jY3IahWZQUhb8jcg4_5lfvZVgbAHMptwBjhmH6iviLpeLZ-XTTeRlL6H6QXJrIF893RK/s1600/1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><div class="MsoNormal"><span lang="EN-US" style="color: black; mso-bidi-font-family: Calibri; mso-fareast-font-family: Calibri; text-indent: -18pt;"><span style="mso-list: Ignore;"><br /></span></span></div><div class="MsoNormal"><span lang="EN-US" style="color: black; mso-bidi-font-family: Calibri; mso-fareast-font-family: Calibri; text-indent: -18pt;"><span style="mso-list: Ignore;">2.<span style="font-family: &quot;times new roman&quot;; font-size: 7pt; font-stretch: normal; font-style: normal; font-variant-east-asian: normal; font-variant-numeric: normal; font-variant: normal; font-weight: normal; font: 7pt &quot;times new roman&quot;; line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><!--[endif]--><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">在表單設計師→右鍵</span><span lang="EN-US" style="color: black; text-indent: -18pt;">[</span><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">檢視表單發行歷程</span><span lang="EN-US" style="color: black; text-indent: -18pt;">]</span><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">→找到對應版號→右鍵</span><span lang="EN-US" style="color: black; text-indent: -18pt;">[</span><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">取出此版本</span><span lang="EN-US" style="color: black; text-indent: -18pt;">]</span><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">→修正</span><span lang="EN-US" style="color: black; text-indent: -18pt;">Js</span><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">程式→按</span><span lang="EN-US" style="color: black; text-indent: -18pt;">[</span><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">更新腳本</span><span lang="EN-US" style="color: black; text-indent: -18pt;">]</span><span style="color: black; font-family: 微軟正黑體, sans-serif; text-indent: -18pt;">即可。<br /><br /><a href="https://www.blogger.com/#"><img border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkCriBGIPCm9hpuQEki_-v_LgEPc6v02HzUXufskrk66HELqxj64pfCS7GyjFnTLiD-v101VWmnDpVFVvQuDeuRMvFVqkDjfXXBXACryvaSKBe3eotNI7EBV7VHAJkE8f3Nw9oaJUfwBZk/s400/2.png" /></a></span></div>
<br />
