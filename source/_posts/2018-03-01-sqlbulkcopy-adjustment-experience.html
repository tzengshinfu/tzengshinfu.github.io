---
layout: post
title: SqlBulkCopy調整心得
tag:
- ".net framework"
- sql
---

場景：<br />
從MySQL同步數個Table到MSSQL，採取先清空(Truncate Table)再寫入的策略；<br />
因為某些Table筆數較多(約百萬筆)，所以使用SqlBulkCopy類進行大量批次寫入。<br />
<br />
做法：<br />
1_取得各Table的筆數,設定SqlBulkCopy.BatchSize屬性=該Table筆數。<br />
<br />
2_SqlBulkCopy.BulkCopyTimeout(逾時)設為0。<br />
<br />
<span style="color: #666666;"><strike>3_設定SqlBulkCopyOptions.TableLock,可以更快完成,但寫入期間會造成Table被鎖定。</strike></span><br />
<span style="color: blue;">→個人測試加入此選項反而增加30秒的寫入時間。</span>
