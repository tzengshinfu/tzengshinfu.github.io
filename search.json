[{"title":"自訂PowerShell 6+快捷鍵","url":"/2025/12/27/powershell-custom-shortcut/","content":"\n1. 列出已綁定的快捷鍵。  \n`\nPS $env:USERPROFILE> Get-PSReadLineKeyHandler\n`\n\n2. 列出其他未綁定的快捷鍵。  \n`\nPS $env:USERPROFILE> Get-PSReadLineKeyHandler -Unbound\n`\n\n3. 要綁定的快捷鍵功能可參考上述指令結果。\n\n4. 編輯設定檔。  \n`\nPS $env:USERPROFILE> notepad(或其他文字編輯器) $PROFILE\n`\n\n5. 寫入新的快捷鍵並存檔，如：  \n`\nSet-PSReadLineKeyHandler -Key Tab -Function ForwardChar\nSet-PSReadLineKeyHandler -Key Ctrl+k -Function ForwardDeleteInput\nSet-PSReadLineKeyHandler -Key Ctrl+RightArrow -Function ForwardWord\n`\n\n6. 即套用在新的PowerShell視窗。","tags":["PowerShell"]},{"title":"在受限的網路環境(沒有無線AP)連線遠端主機","url":"/2025/12/03/connect-remote-host-restricted-network/","content":"\n 情況：  \n要使用筆電當主控端，對遠端桌機(被控端)連線(本例是遠端桌面)，被控端雖然具備有線區網和無線網卡但沒有無線AP可連接。\n\n解法：  \n使用\"行動熱點\"將被控端變成無線AP，然後主控端連到被控端所共享的有線區網。\n\n步驟：\n\n1.進入被控端\"行動熱點\"(hotspot)設定。\n\n[![](mstsc_20251203_121238.png)](mstsc_20251203_121238.png)\n\n2.開啟\"行動熱點\"設定，並設定密碼。  \n[![](mstsc_20251203_121306.png)](mstsc_20251203_121306.png)\n\n  \n\n3.查詢被控端無線網卡目前的IP位址。\n\n4.主控端用WIFI連接被控端。\n\n5.主控端用遠端桌面連接第3步查詢的IP位址即可。\n\nPS: 上述是被控端有線區網能對外(網際網路)的狀態。\n","tags":["windows"]},{"title":"今天是[程式設計師節]!!","url":"/2025/10/24/programmers-day/","content":"\n```\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n```\n","tags":["happy1024!"]},{"title":"GitHub Copilot CLI工作完成發送桌面通知","url":"/2025/10/23/github_copilot_cli-desktop-notification/","content":"目前v0.0349無hook可設定在執行事件前後觸發，\n\n但可以用系統層級的提示詞達到相同目的。\n\n1.安裝PowerShell模組\n`Install-Module -Name BurntToast -Scope CurrentUser`\n\n2.在系統層級提示詞%USERPROFILE%\\.copilot\\copilot-instructions.md新增\n\n- The PowerShell module `BurntToast` has been installed on this machine. You must send me a notification after each work. Execute the PowerShell command `New-BurntToastNotification -Text \"{title}\", \"{content}\" -Sound Alarm2`\n\n[![](Capture_20251023_164252.png)](Capture_20251023_164252.png )\n\n","tags":["windows","github copilot cli"]},{"title":"GitHub Copilot CLI在Windows Terminal按Shift+Enter換行","url":"/2025/10/23/github_copilot_cli-newline-key/","content":"\n目前v0.0349仍無法直接設定，但可修改Windows Terminal設定檔以達成相同目的。\n\n```\n{\n\n    \"actions\":\n\n\n\n    [\n\n\n\n        //#region 新增這段\n\n\n\n        {\n\n\n\n            \"command\":\n\n\n\n            {\n\n\n\n                \"action\": \"sendInput\",\n\n\n\n                \"input\": \"\\n\"\n\n\n\n            },\n\n\n\n            \"id\": \"linefeed\"\n\n\n\n        }\n\n\n\n        //#endregion\n\n\n\n    ],\n\n\n\n    \"keybindings\":\n\n\n\n    [\n\n\n\n        //#region 新增這段\n\n\n\n        {\n\n\n\n            \"id\": \"linefeed\",\n\n\n\n            \"keys\": \"shift+enter\"\n\n\n\n        }\n\n\n\n        //#endregion\n\n\n\n    ]\n\n\n\n}\n```\n\n參考來源：[CLI should support multi-line mode in input box](https://github.com/github/copilot-cli/issues/14#issuecomment-3399405101 \"https://github.com/github/copilot-cli/issues/14#issuecomment-3399405101\")\n","tags":["windows terminal","github copilot cli"]},{"title":"安裝GitHub Copilot CLI","url":"/2025/10/13/install-github_copilot_cli/","content":"\n 1.在[命令提示字元]執行以下指令以安裝Node.js  \nwinget install OpenJS.NodeJS.LTS\n\n2.在[命令提示字元]執行以下指令以安裝Git  \nwinget install --id Git.Git -e --source winget\n\n3.在[命令提示字元]執行GitHub Copilot CLI  \nnpm install -g @github/copilot@latest\n\n4.(選用)在[命令提示字元]執行  \nsetx COPILOT\\_ALLOW\\_ALL true  \n(會直接信任GitHub Copilot CLI，允許任何工具執行並不提出確認要求，有**安全性**問題，所以需評估便利與安全性的取捨。)\n\n5.(選用)可在%USERPROFILE%\\.copilot\\copilot-instructions.md預寫入系統層級的提示詞，如  \nPowerShell執行檔位置、檔案處理需以UTF-8(無BOM)行之等。\n\n6.在[命令提示字元]執行  \ncopilot  \n(會要求登入)\n","tags":["github copilot cli"]},{"title":"在git worktree add後使用TortoiseGit查看log的錯誤(Windows)","url":"/2025/10/08/tortoisegit-view-log-error/","content":"\n[![](2025-10-08_10-11-18.png)](2025-10-08_10-11-18.png )\n\n  \n\n原因\n\n在Repo1使用git worktree add建立的資料夾Repo2，  \n其擁有者是繼承上位資料夾Workspace，  \n但上位資料夾擁有者和目前使用者並不是同一個人。\n\n示意如下：  \nWorkspace(擁有者：Administrators)  \n└Repo1(擁有者：User1)  \n└Repo2(擁有者：Administrators)\n\n解法\n\n執行以下指令將Repo2擁有者改為目前使用者即可。\n\ntakeown /f  Workspace\\Repo1\\.git\\worktrees\\Repo2 /r /d y  \ntakeown /f  Workspace\\Repo2 /r /d y\n\n","tags":["windows","git"]},{"title":"Visual Studio 2022同時偵錯(啟動)多個專案","url":"/2025/09/30/vs2022-debug-multiple-project/","content":"\n在最上層的方案按右鍵=>屬性=>通用屬性=>設定啟動專案，  \n如下圖設定：\n\n[![](devenv_20250930_142829.png)](devenv_20250930_142829.png )\n\n  \n\n","tags":["visual studio 2022"]},{"title":"OpenAI Codex CLI另一種編寫提示詞的方式","url":"/2025/09/20/openai_codex_cli-alternative-prompt/","content":"\n其實在終端機編寫提示詞並不太方便，\n\n大量文字新增修改貼上及移動鼠標位置等操作還是在文字編輯器最方便，\n\n因為Codex有支援自訂提示詞功能，\n\n我們可以在$CODEX\\_HOME/prompts/\n\n(Windows是%USERPROFILE%/.codex/prompts\n\nLinux/WSL 2是~/.codex/prompts/)\n\n新增自訂提示詞檔案，副檔名必須是.md，如my-prompt.md\n\n甚至可以直接用IDE編輯該提示詞檔案，\n\n編輯時Visual Studio 2202可以使用右鍵選單[Copy Full  Path]複製檔案路徑；\n\nVisual Studio Code則能用[Copy Path]或[Copy Relative Path]複製檔案路徑。\n\n重啟Codex(codex resume session\\_id)並在Codex CLI輸入/<自訂提示詞檔名>，如/my-prompt\n\n就能將檔案內容作為提示詞送給Codex。\n\n參考來源：[Custom Prompts](https://github.com/openai/codex/blob/main/docs/prompts.md \"https://github.com/openai/codex/blob/main/docs/prompts.md\")\n","tags":["codex cli"]},{"title":"安裝OpenAI Codex CLI","url":"/2025/09/12/install-openai_codex_cli/","content":"\n1.在[命令提示字元]執行以下指令以安裝Node.js  \nwinget install OpenJS.NodeJS.LTS\n\n2.在[命令提示字元]執行以下指令以安裝Git  \nwinget install --id Git.Git -e --source winget\n\n3.在[命令提示字元]執行Codex CLI  \nnpm install -g @openai/codex@latest\n\n4.(選用)在[命令提示字元]執行  \nmkdir \"%USERPROFILE%\\.codex\" 2>nul & (echo approval\\_policy = \"**never**\" & echo sandbox\\_mode = \"**danger-full-access**\" & echo web\\_search\\_request = **true**) > \"%USERPROFILE%\\.codex\\config.toml\"\n\n(會直接信任codex，允許不提出任何提升權限要求，有**安全性**問題，所以需評估便利與安全性的取捨。)\n\n5.在[命令提示字元]執行  \ncodex  \n(會要求登入)\n","tags":["openai codex cli"]},{"title":"Visual Studio 2022 清除專案同時清空bin/obj資料夾","url":"/2025/09/05/vs2022-clean-project/","content":"\n 在專案.csproj檔新增\n\n```\n<Project>\n```\n\n...\n\n<!-- #region 清理 bin 和 obj 資料夾 -->\n\n  <Target Name=\"CleanBinObjFolders\" AfterTargets=\"Clean\">\n\n<!-- Remove obj folder -->\n\n    <RemoveDir Directories=\"$(BaseIntermediateOutputPath)\" />\n\n<!-- Remove bin folder -->\n\n    <RemoveDir Directories=\"$(BaseOutputPath)\" />\n\n  </Target>\n\n<!-- #endregion -->\n\n</Project>\n\n參考來源：[How to fully clean bin and obj folders within Visual Studio?](https://stackoverflow.com/a/12206011 \"https://stackoverflow.com/a/12206011\")\n","tags":["visual studio 2022"]},{"title":"Dev Drive vs RamDisk","url":"/2025/09/05/devdrive-vs-ramdisk/","content":"\n純個人體感，RamDisk勝！\n\nWindows form專案，在[Dev Drive](https://learn.microsoft.com/zh-tw/windows/dev-drive/ \"https://learn.microsoft.com/zh-tw/windows/dev-drive/\")編譯，未開啟Microsoft Defender，  \n時不時會繞圈圈甚至卡死必須重啟Visual Studio；\n\n用RamDisk([AIM Toolkit](https://sourceforge.net/projects/aim-toolkit/ \"https://sourceforge.net/projects/aim-toolkit/\")，新版ImDisk Toolkit)，編譯過程絲滑，  \n單元測試也是亳無卡頓。\n\n目前使用方法：\n\n1.原始碼備份儲存在D:\\Workspace。\n\n2.開機時會複製至AIM Toolkit建立的R:\\。\n\n3.關機時會同步回D:\\Workspace。\n\n[![](RamDiskUI_20250911_084159.png)](RamDiskUI_20250911_084159.png )\n\n  \n\n4.為避免當機等意外造成進度消失，在開發過程須上傳到版控主機。  \n5.亦可用同步軟體或腳本(如Robocopy)進行複製和偵測到檔案變更時回寫D:\\Workspace。\n\n網友AIM Toolkit使用心得：[AIM Toolkit(ImDisk Toolkitの後継)がリリースされたので使ってみた](https://otogeworks.com/blog/creation-ramdisk-using-aim-toolkit/ \"https://otogeworks.com/blog/creation-ramdisk-using-aim-toolkit/\")\n\n","tags":["dev drive","ramdisk"]},{"title":"Visual Studio 2022偵錯所選擇的專案","url":"/2025/09/02/vs2022-debug-selected-project/","content":"\n快捷鍵F5預設是偵錯設為啟動專案的專案，\n\n如果要直接偵錯在方案總管**所選擇的專案**，\n\n可在快捷鍵設定，\n\n1.進入工具(T)>選項(O)...>環境>鍵盤\n\n2.尋找\"啟動新的執行個體\"，再將快捷鍵F5綁定即可。\n\n[![](devenv_20250902_162127.png)](devenv_20250902_162127.png )\n\n  \n\n","tags":["visual studio 2022"]},{"title":"Visual Studio 2022在方案總管直接打開Windows Terminal","url":"/2025/09/02/vs2022-open-windows_terminal/","content":"\n因為內建終端機快捷鍵與Visual Studio共用，當安裝Clink(擴充cmd.exe功能)時，  \n像Ctrl+K(刪除游標後所有字元)會被當成快捷鍵的組合鍵而無效。\n\n可以改在Windows Terminal以解決這個問題。\n\n1.進入工具(T)>選項(O)...>環境>終端\n\n2.新增設定檔，並**設為預設**  \n名稱：Windows Terminal  \n殼層位置：C:\\Windows\\System32\\cmd.exe  \n引數：/c wt.exe -d .\\\n\n[![](devenv_20250902_084612.png)](devenv_20250902_084612.png )\n\n  \n\n3.在方案總管任一位置按右鍵>在終端機中開啟，  \n即會在對應路徑打開Windows Terminal。\n\n","tags":["visual studio 2022","windows terminal"]},{"title":"Claude Code在VSCode終端機多行輸入及多Profile快捷鍵問題及解法","url":"/2025/08/22/claude_code-vscode-terminal-error/","content":"\n環境\n\nWindows 11 24H2  \nVSCode 1.103.1\n\n1. 多行輸入\n\n問題：執行/terminal-setup後，按Shift+Enter每行都以一個多餘的\"\\\"結尾。\n\n[![](478846268-19939a9a-b1a7-48d3-b471-c0748aa34ca4.png)](478846268-19939a9a-b1a7-48d3-b471-c0748aa34ca4.png )\n\n  \n\n解決方法：參考[網友](https://github.com/anthropics/claude-code/issues/1259#issuecomment-3135636804 \"https://github.com/anthropics/claude-code/issues/1259#issuecomment-3135636804\")的設定。\n\n將\"\\\\\\r\\n\"改成\"\\u001B\\u000A\"即可正常運作。\n\n2. 多個設定檔\n\n問題：切換到其他設定檔後，即使執行/terminal-setup也無法使捷徑生效。\n\n原因：不同的設定檔引用了各自的keybindings.json。\n\n解決方案：\n\n1.首先複製快捷鍵配置\n\n%USERPROFILE%\\AppData\\Roaming\\Code\\User\\keybindings.json。\n\n2.然後切換到新的Profile，按下Ctrl+Shift+P，執行Open Keyboard Shortcuts (JSON)，\n\n並將複製的快捷鍵配置貼上到該Profile的keybindings.json。\n\n或將該Profile的快捷鍵改成與預設Profile共用。\n\n[![](Code_20250822_091245.png)](Code_20250822_091245.png )\n\n  \n\n","tags":["claude code","vscode"]},{"title":"在資料夾右鍵新增\"在終端中開啟\"(WindowsTerminal)","url":"/2025/08/06/folder-context_menu-open-windows_terminal/","content":"\n```\n將以下內容另存.reg檔，修改[WindowsTerminal路徑(以兩個反斜線區隔)]並匯入登錄檔：\n```\n\n```\nWindows Registry Editor Version 5.00  \n  \n[HKEY_CLASSES_ROOT\\Directory\\shell\\wt]  \n@=\"在終端中開啟\"  \n\"Icon\"=\"\\\"%USERPROFILE%\\AppData\\Local\\Microsoft\\WindowsApps\\wt.exe\\\"\"  \n  \n[HKEY_CLASSES_ROOT\\Directory\\shell\\wt\\command]  \n@=\"\\\"%USERPROFILE%\\AppData\\Local\\Microsoft\\WindowsApps\\wt.exe\\\" -d \\\"%V\\\"\"\n```\n","tags":["windows 11","windows terminal"]},{"title":"取得測試專案路徑","url":"/2025/06/12/get-tested-project-path/","content":"\n場景：\n\n被測試專案組件有以下敘述：\n\n```\nPath.Combine(Path.GetDirectoryName(Assembly.GetEntryAssembly().Location) ??\n    throw new NullReferenceException(), fileName)\n```\n\n專案本身啟動能正常執行，但因為測試專案無法取得被測試專案的Assembly.GetEntryAssembly().Location(組件路徑，通常是被測試專案的bin目錄)而拋出NullReferenceException。\n\n解法：\n\n改寫為以下敘述取得測試專案路徑即可正常測試。\n\n```\nPath.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), fileName)\n```\n","tags":[".net framework","c#"]},{"title":"測試專案顯示組件相依性問題","url":"/2025/06/12/tested-project-component-dependency-error/","content":"\n被測試專案組件如下\n\nSerilog, Version=4.3.0.0\n\nSerilog.Sinks.Async, Version=2.1.0.0\n\n專案本身啟動能正常執行，\n\n因為被測試專案csproj檔本身已有AutoGenerateBindingRedirects屬性，且內容為true；\n\n但在引用該專案進行單元測試時，會拋出例外，FusionLog內容如下：\n\n```\n=== 繫結前狀態資訊 ===\n\n\n\n...\n\n\n\n正在呼叫組件 : Serilog.Sinks.Async, Version=2.1.0.0, Culture=neutral, PublicKeyToken=24c2f752a8e58a10。\n\n\n\n===\n\n\n\n...\n\n\n\n記錄: 原則後參考: Serilog, Version=4.1.0.0, Culture=neutral,\n    PublicKeyToken=24c2f752a8e58a10\n\n\n\n...\n\n\n\n警告: 比較組件名稱發現不符項目: 次要版本\n\n\n\n錯誤: 無法完成組件的安裝 (hr = 0x80131040)。已終止探查。\n```\n\n此時要在測試專案csproj檔的**目前啟動的**組態屬性群組新增GenerateBindingRedirectsOutputType屬性，且內容為true：\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>  \n<Project ToolsVersion=\"15.0\"\n    xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">  \n    <Import\n    Project=\"$(MSBuildExtensionsPath)\\$(MSBuildToolsVersion)\\Microsoft.Common.props\"\n    Condition=\"Exists('$(MSBuildExtensionsPath)\\$(MSBuildToolsVersion)\\Microsoft.Common.props')\" />  \n \n      <PropertyGroup>  \n        ...\n        <!--↓↓↓在此插入↓↓↓-->\n        <GenerateBindingRedirectsOutputType>true</GenerateBindingRedirectsOutputType>\n      </PropertyGroup>\n```\n\n並重載測試專案即可正常測試。\n","tags":[".net framework"]},{"title":"Windows 11修改Notepad++檔案圖示","url":"/2025/04/25/modify-notepad-icon-on-windows/","content":"\n 想用Notepad++開啟文字檔，卻想保留Windows文字檔案的圖示\n\n1.執行regedit.exe\n\n2.路徑指向HKEY\\_CLASSES\\_ROOT\\Notepad++\\_file\\DefaultIcon\n\n3.修改(預設值)數值資料為:%SystemRoot%\\System32\\Shell32.dll,70\n\n4.在文字檔按右鍵，開啟檔案(H)>選擇其他應用程式(C)>Notepad++>一律\n\n5.修改完成\n\n參考來源：[How can I change the icon for Notepad++](https://community.notepad-plus-plus.org/post/99994 \"https://community.notepad-plus-plus.org/post/99994\")\n","tags":["windows 11"]},{"title":"VSCode在Linux同步異常","url":"/2025/04/16/vscode-synchronization-exception-linux/","content":"出現錯誤訊息Failed to execute default Web Browser.\n\n[![](1.png)](1.png )\n\n  \n\n解法：\n\n1. 在Settings→Workbench: External Browser輸入已安裝的瀏覽器如firefox。\n\n[![](2.png)](2.png )\n\n  \n\n2. 會跳出Firefox並執行同步登入作業，如果出現以下錯誤  \nError while turning on Settings Sync. Cancelled\n\n則改執行後來跳出的對話框\n\nWould you like to try a different way?(local server)。\n\n[![](3.png)](3.png )\n\n  \n\n3. 設定同步作業成功。\n\n[![](4.png)](4.png )\n\n  \n\n","tags":["visual studio code"]},{"title":"RDP視窗自動縮放","url":"/2025/04/16/rdp-windows-smart_sizing/","content":"\n1.連線時在視窗邊緣按右鍵->選擇\"智慧縮放(A)\"\n\n[![](2025-04-16-19-12-04.png)](2025-04-16-19-12-04.png )\n\n  \n\n2.在連線設定檔(.rdp)新增或修改屬性 smart sizing:i:1\n\n[![](2025-04-16-19-16-47.png)](2025-04-16-19-16-47.png )\n\n  \n\n參考來源：[Smart Resizing of Remote Desktop Windows](https://support.smartbear.com/testcomplete/docs/testing-with/running/via-rdp/smart-resizing.html \"https://support.smartbear.com/testcomplete/docs/testing-with/running/via-rdp/smart-resizing.html\")\n\n","tags":["rdp"]},{"title":"Linux安裝X11VNC並設為服務","url":"/2025/04/07/install-x11vnc-as-service-linux/","content":"\n```\nsudo apt update  \n#更新APT套件清單\n```\n\n```\nsudo apt install -y x11vnc  \n#安裝X11VNC\n```\n\n```\nsudo vncpasswd  \n#建立VNC密碼檔(最多8個字元，可包含數字/特殊符號)\n```\n\n```\nsudo nano /etc/systemd/system/graphical.target  \n#新增graphical.target 是一個 systemd 目標單元，負責啟動系統的圖形介面，並確保相關的服務（如顯示管理器和 VNC 服務）在適當的順序下啟動\n```\n\n`graphical.target`內容如下：\n\n```\n[Unit]  \nDescription=Graphical Interface  \nDocumentation=man:systemd.special(7)  \nRequires=multi-user.target  \nAfter=multi-user.target  \nConflicts=rescue.target  \nWants=display-manager.service  \nWants=x11vnc.service  \nAllowIsolate=yes\n```\n\n[Install]  \nAlias=default.target\n\n```\nsudo nano /etc/systemd/system/x11vnc.service  \n#新增X11VNC服務\n```\n\nx11vnc.service內容如下：\n\n```\n[Unit]  \nDescription=X11VNC service  \nRequires=display-manager.service  \nAfter=display-manager.service\n```\n\n[Service]  \nType=forking  \nExecStart=/usr/bin/x11vnc \\  \n-display\n:0 \\  \n-rfbport 5900 \\  \n#-localhost \\  \n-rfbauth [VNC密碼檔路徑] \\  \n#-shared \\  \n-bg \\  \n-xkb\n\\  \n-ncache \\  \n-ncache\\_cr \\  \n-forever \\  \n-repeat \\  \n-auth guess\n\n[Install]  \nWantedBy=display-manager.service\n\n```\nsudo systemctl daemon-reload  \n#重新讀取已新增的服務設定檔\n```\n\n```\nsudo systemctl start graphical.target  \n#啟動graphical.target服務\n```\n\n```\nsudo systemctl status graphical.target  \n#查看graphical.target服務狀態\n```\n\n```\nsudo systemctl start x11vnc.service  \n#啟動X11VNC服務\n```\n\n```\nsudo systemctl status x11vnc.service  \n#查看X11VNC服務狀態\n```\n\n  \n\n```\nsudo systemctl enable graphical.target  \n#將graphical.target服務設為開機啟動\n```\n\n```\nsudo systemctl enable x11vnc.service  \n#將X11VNC服務設為開機啟動\n```\n\n(在樹莓派5實測還是[xrdp](https://learn.microsoft.com/zh-tw/azure/virtual-machines/linux/use-remote-desktop?tabs=azure-cli \"https://learn.microsoft.com/zh-tw/azure/virtual-machines/linux/use-remote-desktop?tabs=azure-cli\")效能較佳)\n\n參考來源：[launch x11vnc on bootup](https://unix.stackexchange.com/a/110308 \"https://unix.stackexchange.com/a/110308\")\n","tags":["linux","x11vnc","xrdp"]},{"title":"Windows無法用ssh-copy-id複製公鑰的替代方法","url":"/2025/04/03/windows-ssh_copy_id-alternative/","content":"\n在命令提示字元視窗執行\n\n```\ntype %USERPROFILE%\\.ssh\\[SSH公鑰檔名] | ssh [Linux使用者]@[Linux主機] \"cat >> .ssh/authorized_keys\"\n```\n\n參考來源：[Alternative to ssh-copy-id on windows](https://superuser.com/a/1815968/209426 \"https://superuser.com/a/1815968/209426\")\n","tags":["windows","ssh"]},{"title":"Linux無法用.local域名連線","url":"/2025/04/03/linux-cannot-use-m_dns/","content":"\n啟動AVAHI服務即可\n\n```\nsystemctl start avahi-daemon\n```\n\n再將AVAHI服務設定為開機啟用\n\n```\nsystemctl enable avahi-daemon\n```\n","tags":["linux"]},{"title":"快速切換網路介面卡設定","url":"/2025/03/31/quickly-switch-network_card-setting/","content":"\n場景1: 筆電有線網路連接內部路由器與PLC連線\n\n執行\n\n```\nnetsh interface ip set address \"[有線網路名稱]\" static [PLC內網的IP位址] 255.255.255.0 [PLC內網的預設閘道IP位址] 1\n```\n\n場景2: 回到辦公室改回DHCP\n\n執行\n\n```\nnetsh interface ip set address \"[有線網路名稱]\" dhcp\n```\n\n上述指令可製成批次檔\n\n(檔案編碼需為Big5)\n\n參考來源：[使用 netsh 設定網路卡 IP 位址 - 1](https://ithelp.ithome.com.tw/m/articles/10080955 \"https://ithelp.ithome.com.tw/m/articles/10080955\")\n","tags":["windows"]},{"title":"GX Works2 切換介面語系","url":"/2025/03/26/gx_works2-switch-ui-language/","content":"\n問題：\n\n要切換介面顯示語系，但發現工具>選擇語言是針對工程內容，而不是介面顯示。\n\n解法：\n\n1. 關閉GX Works2。\n\n2. 開啟登錄編輯程式，路徑：\n\nHKEY\\_CURRENT\\_USER\\Software\\MITSUBISHI\\SWnDN-GPPW2\\App\\CodePage\n\n編輯 DWORD (32-位元) 值\n\n底數選十進位(D)\n\n數值資料輸入如下：\n\n[![](regedit_20250326_130507.png)](regedit_20250326_130507.png )\n\n  \n\n數值資料內容[說明](https://zh.wikipedia.org/zh-tw/%E4%BB%A3%E7%A0%81%E9%A1%B5 \"https://zh.wikipedia.org/zh-tw/%E4%BB%A3%E7%A0%81%E9%A1%B5\")：\n\n1252 西歐拉丁字母ISO-8859-1\n\n950  繁體中文（大五碼）\n\n936  簡體中文（GBK）\n\n932  日文（Shift\\_JIS）\n\n3. 重新啟動GX Works2即可。\n\n參考來源：[GX WORKS2 1.77F 語言檔問題,簡中,繁中,英文](http://www.ymmfa.com/read-gktid-1371103-uid-3.html \"http://www.ymmfa.com/read-gktid-1371103-uid-3.html\")\n\n","tags":["gx works2"]},{"title":"Windows Forms建立SQLite連線時顯示Library e\\_sqlite3找不到的錯誤","url":"/2025/03/18/windows_form-e_sqlite3-not_found/","content":"\n版本：\n\nVS2022 v17.13.3\n\nSQLite-net v1.9.172\n\n1. 使用新增Windows Forms App (.NET Framework)專案。\n\n2. 安裝Nuget套件SQLite-net NuGet\\Install-Package sqlite-net-pcl -Version [最新版]\n\n3. 建立SQLite連線時顯示錯誤訊息：Library e\\_sqlite3找不到\n\n[![](Capture_20250318_092722.png)](Capture_20250318_092722.png )\n\n  \n\n解法：\n\n1. 降版SQLitePCLRaw.lib.e\\_sqlite3至v2.0.7\n\n參考來源：[【茶包射手日記】.NET Framework 專案 SQLite 執行錯誤：找不到 e\\_sqlite3](https://blog.darkthread.net/blog/sqlite-n-netfx/#9ab43c6e-601b-46f2-b6bf-f89caf1e6f79 \"https://blog.darkthread.net/blog/sqlite-n-netfx/#9ab43c6e-601b-46f2-b6bf-f89caf1e6f79\")\n\n2. 遷移package.config到PackageReference\n\n[![](Capture_20250318_092433.png)](Capture_20250318_092433.png )\n\n  \n\n[![](devenv_20250318_092440.png)](devenv_20250318_092440.png )\n\n  \n\n因為VS2022建立的Windows Forms App (.NET Framework)專案，\n\n預設使用package.config管理Nuget套件，\n\n但SQLite-net相依的SQLitePCLRaw NuGet套件在v2.1.0後需要使用PackageReference管理。\n\n參考來源：[Exception after updating from 2.0.8 to 2.1.0](https://github.com/ericsink/SQLitePCL.raw/issues/483 \"https://github.com/ericsink/SQLitePCL.raw/issues/483\")\n\n參考來源：[從 package.config 移轉到 PackageReference](https://learn.microsoft.com/zh-tw/nuget/consume-packages/migrate-packages-config-to-package-reference \"https://learn.microsoft.com/zh-tw/nuget/consume-packages/migrate-packages-config-to-package-reference\")\n\n  \n\n","tags":["windows form",".net framework","sqlite","visual studio 2022"]},{"title":"Windows 11無法安裝.NET Framework 3.5","url":"/2025/03/17/windows11-cannot-install-net3_5/","content":"\n1. 在Windows 功能勾選**.NET Framework 3.5 (包括.NET 2.0和3.0)**\n\n2. 在安裝進度完成後卻顯示Windows 無法完成要求的變更(錯誤碼: 0x80240021)\n\n[![](devenv_20250317_105141.png)](devenv_20250317_105141.png )\n\n  \n  \n\n3. 先勾選**SMB 1.0/CIFS 檔案共用支援**>確定>安裝完成(可先不重開機)。\n\n[![](OptionalFeatures_20250317_134110.png)](OptionalFeatures_20250317_134110.png )\n\n  \n\n4. 再勾選**.NET Framework 3.5 (包括.NET 2.0和3.0)**>確定>安裝完成(**要重開機**)。\n\n[![](devenv_20250317_114254.png)](devenv_20250317_114254.png )\n\n  \n\n5. 即可安裝相依.NET Framework 3.5的軟體。\n\n6. 再取消勾選**SMB 1.0/CIFS 檔案共用支援**即可。\n\n參考來源：[NET Framework 3.5 在Windows 11 下無法安裝](https://vocus.cc/article/6698fec7fd89780001c7d821 \"https://vocus.cc/article/6698fec7fd89780001c7d821\")\n\n","tags":[".net framework 3.5","windows 11"]},{"title":"Windows新電腦快速還原安裝程式(含設定)","url":"/2025/03/07/windows-computer-restore-quickly/","content":"\n1. 在舊電腦的準備工作\n\n   #### 本例\"存放路徑\"為使用者文件(%USERPROFILE%\\Documents)\n\n   1. 匯出**已安裝程式清單**檔案  \n      執行\n\n      ```\n      winget export --output [存放路徑]\\[已安裝程式清單JSON檔]\n      ```\n   2. 複製已安裝程式設定檔資料夾到存放路徑\n   3. 工作排程器>匯出>將工作XML檔儲存到存放路徑(如果有需要)\n   4. 複製使用者捷徑到存放路徑(如果有需要)\n   5. 複製使用者啟動資料夾捷徑到存放路徑(如果有需要)\n   6. 記錄使用者路徑(Path)環境變數\n2. 在新電腦執行匯入\n\n   1. 執行\n\n      ```\n      winget import --import-file [存放路徑]\\[已安裝程式清單JSON檔]\n      ```\n   2. 將已安裝程式的設定檔資料夾重新指向存放路徑\n\n      #### 以下指令需以BatchScript形式執行\n\n      ```\n      :: 以下是檢查檔案是否為連結的範例\n      :: 檢查.gitconfig檔案是否為連結\n      DIR \"%USERPROFILE%\" | FINDSTR \".gitconfig\" | FINDSTR \"<SYMLINK>\"\n\n      :: 如果不是，刪除並建立連結到存放路徑\n      IF %ERRORLEVEL% EQU 1 (\n       DEL /Q \"%USERPROFILE%\\.gitconfig\"\n       MKLINK \"%USERPROFILE%\\.gitconfig\" \"[存放路徑]\\.gitconfig\"\n      )\n\n      :: 以下是檢查目錄是否為連結的範例\n      :: 檢查.ssh資料夾是否為連結\n      DIR \"%USERPROFILE%\" | FINDSTR \".ssh\" | FINDSTR \"<JUNCTION>\"\n\n      :: 如果不是，刪除並建立連結到存放路徑\n      IF %ERRORLEVEL% EQU 1 (\n       RMDIR /S /Q \"%USERPROFILE%\\.ssh\"\n       MKLINK /J \"%USERPROFILE%\\.ssh\" \"[存放路徑]\\.ssh\"\n      )\n      ```\n   3. 匯入工作排程(如果有需要)  \n      執行\n\n      ```\n      SCHTASKS /CREATE /TN \\%USERNAME%\\[工作名稱] /XML \"[存放路徑]\\[工作XML檔]\"\n      ```\n   4. 複製捷徑至使用者開始功能表以利後續釘選(如果有需要)  \n      執行\n\n      ```\n      XCOPY /S \"[存放路徑]\\[開始功能表捷徑資料夾]\\*\" \"%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\\"\n      ```\n   5. 複製捷徑至使用者啟動資料夾(如果有需要)  \n      執行\n\n      ```\n      XCOPY /S \"[存放路徑]\\[啟動捷徑資料夾]\\*\" \"%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\"\n      ```\n   6. 設定使用者路徑(Path)變數(如果有需要)\n\n      #### 以下指令需以BatchScript形式執行\n\n      ```\n      FOR /F \"delims=\" %%A IN ('PowerShell -NoProfile -Command \"(Get-ItemProperty HKCU:\\Environment).Path\"') DO SET UserPath=%%A\n      SETX Path \"%UserPath%\";[使用者路徑清單(以分號區隔)]\n      SET UserPath=\n      ```\n","tags":["windows"]},{"title":"使用ProcDump+WinDbg定位.NET Framework問題(筆記)","url":"/2025/03/04/procdump-windbg-locate-netframework-error/","content":"\n 1.首要條件\n\n專案>右鍵>屬性>建置>輸出>進階(D)...>輸出>偵錯訊息(E):>僅限 Pdb\n\n[![](image_20250303_083605.png)](image_20250303_083605.png )\n\n  \n\n參考來源：[.NET 知識高裝檢 - .pdb 檔、編譯最佳化與偵錯](https://blog.darkthread.net/blog/about-dotnet-pdb/ \"https://blog.darkthread.net/blog/about-dotnet-pdb/\")\n\n2.執行ProcDump生成記憶體傾印檔案\n\nprocdump -accepteula -ma [TargetApp.exe] [D:\\target-app\\_dumps]\n\n* **`-accepteula`**：自動接受終端使用者授權協議（EULA），避免在執行時出現提示\n* **`-ma`**：生成完整的記憶體傾印，包括所有的記憶體內容，提供最詳細的調試資訊\n* **`TargetApp.exe`**：目標應用程式的名稱，即需要監控的程式\n* **`D:\\target-app_dumps`**：指定記憶體傾印檔案的儲存路徑\n\n參考來源：[ProcDump - Sysinternals](https://learn.microsoft.com/zh-tw/sysinternals/downloads/procdump \"https://learn.microsoft.com/zh-tw/sysinternals/downloads/procdump\")\n\n3.執行WinDbg分析問題\n\n安裝來源[安裝 Windows 調試程式](https://learn.microsoft.com/zh-tw/windows-hardware/drivers/debugger/ \"https://learn.microsoft.com/zh-tw/windows-hardware/drivers/debugger/\")\n\n起手式\n\n> 執行!sym noisy\n\n+ 啟用詳細符號載入\n\n> 執行.sympath+ [Pdb路徑]\n\n+ 設定符號搜尋路徑\n\n> 執行.reload\n>\n> 執行ld\\*\n\n+ 強制載入符號\n\n> 執行.loadby sos clr\n\n+ 載入.NET類別資訊偵錯用\n\n> 執行.chain\n\n+ 檢查載入是否成功\n\n再依問題類型下對應指令查詢\n\n參考來源：[真实案例大全](https://github.com/ctripxchuang/dotnetfly \"https://github.com/ctripxchuang/dotnetfly\")\n\n","tags":[".net framework","procdump","windbg"]},{"title":"KeePassXC自動輸入{CLEARFIELD}無法清除欄位內容","url":"/2025/03/04/keepassxc-automatic-input-cannot-clearfield/","content":"\n由KeePass改用跨平台的KeePassXC，\n\n發現原本設定的自動輸入{CLEARFIELD}不會清除已有文字存在的欄位內容。\n\n解法：\n\n將{CLEARFIELD}改為^a{DELETE}即可。\n\n參考來源：[{CLEARFIELD} not working on Windows 11 either (with SQuirreL)](https://github.com/keepassxreboot/keepassxc/issues/10916#issuecomment-2175914913 \"https://github.com/keepassxreboot/keepassxc/issues/10916#issuecomment-2175914913\")\n","tags":["keepassxc"]},{"title":"備份Mozilla Thunderbird設定","url":"/2025/02/25/backup-mozilla-thunderbird-setting/","content":"\n1.Thunderbird工具列>工具>匯出>點擊**開啟設定檔目錄**\n\n2.備份Mail/ImapMail資料夾以外的檔案及目錄\n\n3.Mail是本機郵件檔，建議備份頻率和位置另外設定\n\n4.ImapMail是雲端郵件檔，不備份亦可，即使丟失還可重新下載到本機\n","tags":["thunderbird"]},{"title":"已加入gitignore的檔案移出版控並保留本機檔案","url":"/2025/02/24/uncommit-file-from-gitignore/","content":"\nWindows\n\n1.開啟命令列\n\n2.修改目前路徑到該repo\n\n3.執行chcp 65001\n\n- 65001=UTF-8，避免路徑字串與命令列語系不同導致fatal: pathspec '檔案路徑' did not match any files的亂碼問題。\n\n4.執行for /f \"delims=\" %f in ('git ls-files -i -c --exclude-from=.gitignore') do git rm --cached \"%f\"\n\n- `for /f \"delims=\" %f`：使用 `delims=` 避免空格導致的分割問題，確保整個檔名被正確處理。\n- `in ('git ls-files -i -c --exclude-from=.gitignore')`：執行 `git ls-files` 並將輸出逐行存入變數 `%f`。\n- `git rm --cached \"%f\"`：用雙引號包住變數，確保帶空格的檔案名稱能被正確處理。\n\nLinux\n\n1.開啟命令列\n\n2.修改目前路徑到該repo\n\n3.執行git ls-files -i -c --exclude-from=.gitignore -z | xargs -0 git rm --cached\n\n- `-z`：讓 `git ls-files` 以 NUL (`\\0`) 分隔檔名，防止空格或特殊字符導致問題。\n- `xargs -0`：讓 `xargs` 以 NUL 分隔來處理檔名，確保帶空格的檔案能被正確傳遞給 `git rm --cached`。\n\n參考來源：ChatGPT\n","tags":["git"]},{"title":"JetBrains Toolbox在WSL執行未回應","url":"/2025/02/21/jetbrains-toolbox-not_responding-wsl2/","content":"\n1.依照[SOP](https://www.jetbrains.com/help/idea/installation-guide.html#toolbox_linux \"https://www.jetbrains.com/help/idea/installation-guide.html#toolbox_linux\")安裝Toolbox。\n\n2.在命令列執行JetBrains Toolbox後無回應\n\n(user@host:/opt/jetbrains-toolbox-<build>$ ./jetbrains-toolbox)\n\n解法：安裝以下元件即可正常執行\n\nsudo apt install libgtk-3-dev\n\n參考來源：[Cannot launch jetbrains-toolbox from WSL2 environment](https://youtrack.jetbrains.com/issue/TBX-8755/Cannot-launch-jetbrains-toolbox-from-WSL2-environment#focus=Comments-27-6724754.0-0 \"https://youtrack.jetbrains.com/issue/TBX-8755/Cannot-launch-jetbrains-toolbox-from-WSL2-environment#focus=Comments-27-6724754.0-0\")\n","tags":["wsl2","jetbrains toolbox"]},{"title":"IIS Express使用NSSM掛載成本機網站服務","url":"/2025/01/16/iis_express-nssm-windows_service/","content":"\n 本機有網頁格式的說明文件，想掛載成網站服務\n\n1.安裝NSSM\n\n執行\n\n```\nwinget install nssm.nssm\n```\n\n2.透過NSSM新增服務\n\n執行\n\n```\nnssm install \"服務名稱\"\n```\n\n會啟動設定用的GUI\n\n[![](image_20250116_114557.png)](image_20250116_114557.png )\n\n  \n\n在Path設定<IIS Express路徑>\n\nArguments設定 /port:<PORT號碼> /path:\"<文件路徑>\"\n\nPS:如果直接執行sc create \"IIS Express\" binPath=\"<IIS Express路徑> /port:<PORT號碼> /path:\"<文件路徑>\" 新增服務，在啟動時會失敗並顯示\"錯誤 1503\n: 服務並未已適時的方式回應啟動獲控制請求\"，因為IIS Express沒有能以服務啟動的介面。\n\n","tags":["windows","iis express","nssm"]},{"title":"VS2022開啓.NETFramework4.0的專案","url":"/2024/12/30/vs2022-open-netframework4-project-error/","content":"\n問題：\n\n 1.VS2022開啓.NETFramework4.0的專案，出現以下錯誤。\n\n[![](p1.png)](p1.png )\n\n2.因爲VS2022已不支援.NETFramework4.0。\n\n[![](p2.png)](p2.png )\n\n  \n\n3.就算手動安裝.NETFramework4.0會顯示以下提示而安裝失敗。\n\n[![](p3.png)](p3.png )\n\n解法：\n\n1.在nuget.org搜尋\"Microsoft.NETFramework.ReferenceAssemblies.net40\"\n\n點擊Microsoft官方的package。\n\n[![](p4.png)](p4.png )\n\n  \n\n2.點擊[Download package](https://www.nuget.org/api/v2/package/Microsoft.NETFramework.ReferenceAssemblies.net40/1.0.3 \"https://www.nuget.org/api/v2/package/Microsoft.NETFramework.ReferenceAssemblies.net40/1.0.3\")下載這個package。\n\n[![](p5.png)](p5.png )\n\n  \n\n3.用解壓縮軟體開啟這個package。\n\n[![](page6.png)](page6.png )\n\n  \n\n4.將這個package根目錄下的build\\.NETFramework\\v4.0內容解壓縮並覆蓋\n\n%ProgramFiles(x86)%\\Reference Assemblies\\Microsoft\\Framework\\.NETFramework\\v4.0\n\n5.重啟VS2022再開啟專案即可。\n\n  \n\n","tags":["visual studio",".net framework"]},{"title":"Synology Drive Client同步Git資料夾失敗","url":"/2024/12/05/synology_drive_client-sync-error/","content":"\n問題：Synology Drive Client同步時間過長，發現Git資料夾下的子資料夾(.git/objects) 同步異常。\n\n[![](image_20241205_082724.png)](image_20241205_082724.png )\n\n  \n\n解法：將.git/objects資料夾的唯讀屬性取消即可。\n\n[![](image_20241205_082411.png)](image_20241205_082411.png )\n\n  \n\n參考來源：[Drive client gets stuck with .git directory](https://community.synology.com/enu/forum/1/post/142847 \"https://community.synology.com/enu/forum/1/post/142847\")\n\n","tags":["git","synology drive client"]},{"title":"今天是[程式設計師節]!!","url":"/2024/10/23/programmers-day/","content":"\n```\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n```\n","tags":["happy1024!"]},{"title":"設定Windows 10右下角通知停留時間","url":"/2024/07/09/set-windows10-notification-dwell-time/","content":"\n 1.設定->輕鬆存取\n\n[![](image_20240709_143953.png)](image_20240709_143953.png )\n\n  \n\n2.簡化及個人化Windows->顯示通知->修改訊息停置秒數\n\n[![](image_20240709_144030.png)](image_20240709_144030.png )\n\n  \n\n3.自訂秒數則需修改註冊檔，\n\n路徑：HKEY\\_CURRENT\\_USER\\Control Panel\\Accessibility\n\n底數改為十進位，並修改數值資料為訊息停置秒數，\n\n登出或重開機套用變更。\n\n[![](image_20240709_144116.png)](image_20240709_144116.png )\n\n  \n\n參考來源：[Windows 10 show notification time setting is not working](https://answers.microsoft.com/en-us/windows/forum/all/windows-10-show-notification-time-setting-is-not/fa81b950-4808-4afa-9fc2-e14e3a28ce88 \"https://answers.microsoft.com/en-us/windows/forum/all/windows-10-show-notification-time-setting-is-not/fa81b950-4808-4afa-9fc2-e14e3a28ce88\")\n\n","tags":["windows"]},{"title":"樹莓派啟用ZRAM以改善效能","url":"/2024/06/21/raspberry_pi-zram-speedup/","content":"\n ZRAM解釋 [https://zh.wikipedia.org/zh-tw/Zram](https://zh.wikipedia.org/zh-tw/Zram \"https://zh.wikipedia.org/zh-tw/Zram\")\n\n*zram仍有利於嵌入式裝置、小筆電和其它相似的低階硬體裝置。這些裝置通常使用固態儲存，它們由於其原生性質而壽命有限，因而避免以其提供交換空間可防止其迅速磨損。此外，使用zRAM還可顯著降低Linux系統用於交換的I/O。*\n\n1.建立設定ZRAM的ShellScript\n\nuser@HOST:~ $ sudo nano /usr/local/sbin/zram\\_setup.sh\n\n內容如下\n\n#!/bin/bash  \n  \nmemsize=$(free | grep -e \"^Mem:\" | awk '{print $2}')  \necho $(( $memsize \\* 1024 )) | sudo tee /sys/block/zram0/disksize  \nmkswap /dev/zram0  \nswapon -p 10 /dev/zram0\n\n2.將其設定為可執行檔\n\nuser@HOST:~ $ sudo chmod +x /usr/local/sbin/zram\\_setup.sh\n\n3.設定服務，指向設定ZRAM的ShellScript\n\nuser@HOST:~ $ sudo nano /etc/systemd/system/zram\\_setup.service\n\n內容如下\n\n[Service]  \nType=simple  \nExecStart=/usr/local/sbin/zram\\_setup.sh\n\n[Install]  \nWantedBy=default.target\n\n4.編輯/etc/modules\n\nuser@HOST:~ $ sudo nano /etc/modules\n\n新增內容\n\nzram\n\n5.啟用ZRAM服務\n\nuser@HOST:~ $ sudo systemctl daemon-reload\n\nuser@HOST:~ $ sudo systemctl start zram\\_setup.service\n\nuser@HOST:~ $ sudo systemctl enable zram\\_setup.service\n\n參考來源：[Raspberry Pi 效能改善 – 使用 ZRAM](https://www.team-bob.org/raspberry-pi-%E6%95%88%E8%83%BD%E6%94%B9%E5%96%84-%E4%BD%BF%E7%94%A8-zram/ \"https://www.team-bob.org/raspberry-pi-%E6%95%88%E8%83%BD%E6%94%B9%E5%96%84-%E4%BD%BF%E7%94%A8-zram/\")\n","tags":["raspberry pi 4","zram"]},{"title":"在Kaggle執行PaddleOCR(百度的OCR library)","url":"/2024/05/10/run-baidu-paddleocr-in-kaggle/","content":"1.安裝PaddlePaddle\n\n```\n!python3 -m pip install paddlepaddle-gpu -i https://mirror.baidu.com/pypi/simple\n```\n\n2.安裝PaddleOCR whl包\n\n```\n!pip install \"paddleocr>=2.0.1\"\n```\n\n3.下載測試用圖片(可自定義)\n\n```\n!wget https://paddleocr.bj.bcebos.com/dygraph_v2.1/ppocr_img.zip\n```\n\n4.解壓縮圖片\n\n```\n!unzip ppocr_img.zip\n```\n\n5.執行識別指令\n\n```\n!paddleocr --image_dir <圖片路徑> --use_angle_cls true --use_gpu true\n```\n","tags":["kaggle","paddleocr"]},{"title":"在Kaggle執行QAnything(支援任意格式檔或資料庫的本地知識庫問答系統)","url":"/2024/05/06/run-q_anything-in-kaggle/","content":"1.複製QAnything倉庫\n\n```\n!git clone -b develop_for_v1.3.1 https://github.com/netease-youdao/QAnything.git\n```\n\n2.切換工作目錄\n\n```\n%cd '/kaggle/working/QAnything'\n```\n\n3.更新Kaggle vllm版本\n\n```\n!pip install vllm -U\n```\n\n4.更新Kaggle pydantic版本\n\n```\n!pip install -U pydantic\n```\n\n5.安裝QAnything所需元件\n\n```\n!pip install -e .\n```\n\n6.安裝ngrok執行檔\n\n```\n !curl -s https://ngrok-agent.s3.amazonaws.com/ngrok.asc | sudo tee /etc/apt/trusted.gpg.d/ngrok.asc >/dev/null && echo \"deb https://ngrok-agent.s3.amazonaws.com buster main\" | sudo tee /etc/apt/sources.list.d/ngrok.list && sudo apt update && sudo apt install ngrok\n```\n\n7.新增ngrok認證token(需預先註冊)\n\n```\n!ngrok config add-authtoken <ngrok認證token>\n```\n\n8.安裝pyngrok\n\n```\n!pip install pyngrok\n```\n\n9.執行完成後會顯示public\\_url=\"<公開網址>\"\n\n```\nfrom pyngrok import ngrok, conf\n\nconf.get_default().auth_token = \"<ngrok認證token>\"\nport = \"8777\"\npublic_url = ngrok.connect(port).public_url\nprint(f\"public_url=\\\"{public_url}\\\"\")\n```\n\n10.執行完成後即可連至<公開網址>/qanything/進行知識庫問答\n\n```\n!bash scripts/run_for_3B_in_Linux_or_WSL.sh\n```\n","tags":["kaggle","qanything"]},{"title":"LimeSurvey特定問題依其他題目的答案而變更為選填或必填","url":"/2024/04/17/limesurvey-optional-by-specific-question/","content":"\n1.把特定問題(本例為Q02意見題)的**設定**>**一般化設置**>**必填**改為'關'(='選填')，用後續的公式來控制'選填'或'必填'。\n\n[![](1.jpg)](1.jpg )\n\n2.在Q02意見題的**設定**>**邏輯**>**問題驗證方程式**填入驗證公式：\n\n(\n\nQ01 >= 3                                    #當Q01等級大於等於3\n\nor                                                 #或\n\n(Q01 < 3 and !is\\_empty(Q02))  #當Q01等級小於3 以及 Q02意見題 不得為空\n\n)\n\n並在**設定**>**邏輯**>**問題驗證提示**填入\"Q01如果是3顆星以下則此題必填\"。\n\n[![](2.jpg)](2.jpg )\n\n  \n\n3.當不通過驗證公式時將會無法送出，如下圖：\n\n[![](image_20240417_190331.png)](image_20240417_190331.png )\n\n  \n\n參考來源：[How Do I Make Question As Mandatory Based On Certain Answer Of Previous Question](https://forums.limesurvey.org/forum/can-i-do-this-with-limesurvey/121752-how-do-i-make-question-as-mandatory-based-on-certain-answer-of-previous-question \"https://forums.limesurvey.org/forum/can-i-do-this-with-limesurvey/121752-how-do-i-make-question-as-mandatory-based-on-certain-answer-of-previous-question\")\n\n","tags":["limesurvey"]},{"title":"Docker v.26開啟管理port:2375","url":"/2024/03/28/docker26-open-management-port/","content":"\n官方文件有2種修改方法：\n\n[Configuring remote access with systemd unit file](https://docs.docker.com/config/daemon/remote-access/#configuring-remote-access-with-systemd-unit-file \"https://docs.docker.com/config/daemon/remote-access/#configuring-remote-access-with-systemd-unit-file\")\n\n└→不想動到服務設定，不管是docker.service設定檔本身或是override.conf。\n\n[Configuring remote access with daemon.json](https://docs.docker.com/config/daemon/remote-access/#configuring-remote-access-with-daemonjson \"https://docs.docker.com/config/daemon/remote-access/#configuring-remote-access-with-daemonjson\")\n\n└→無法啟動服務，因為設定與docker.service設定檔沖突。\n\n解決方法：\n\n編輯/etc/default/docker，新增DOCKER\\_OPTS=\"-H tcp://0.0.0.0:2375\"，\n\n再執行sudo systemctl daemon-reload && sudo systemctl restart docker，\n\n並驗證如下：\n\n$ sudo netstat -lntp | grep dockerd\n\ntcp6       0      0 :::2375                 :::\\*                    LISTEN      534451/dockerd\n","tags":["docker"]},{"title":"Windows 10啟動資料夾路徑","url":"/2024/03/24/windows10-startup-folder-path/","content":"\n 1.全部使用者：Windows鍵 + R鍵→輸入shell:common startup\n\n或路徑C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\n\n2.個別使用者：Windows鍵 + R鍵→輸入shell:startup\n\n或路徑C:\\Users\\<使用者帳號>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n","tags":["windows"]},{"title":"Git on Linux: server certificate verification failed. CAfile: none CRLfile: date: 2024-03-20 15:28:00 none","url":"/2024/03/20/git-linux-server-certificate-error/","content":"\n狀況：\n\n在Linux平台使用git push/pull/clone等指令遇到錯誤如下，\n\nSomeUser@SomeServer:~/SomeRepo$ git pull\n\nfatal: unable to access 'https://mygit.com/SomeRepo.git/': server certificate verification failed. CAfile: none CRLfile: none\n\n解法：\n\n將SomeRepo主機SSL憑證上傳至該Linux平台主機存放憑證處即可。\n\n(本例為/etc/ssl/certs/，可用`curl-config --ca`查詢存放處。)\n","tags":["ssl","linux","git"]},{"title":"Git on Windows: SSL certificate problem: unable to get local issuer certificate","url":"/2024/03/19/git-windows-ssl-certificate-error/","content":"\n狀況：\n\n在Windows平台使用git push/pull/clone等指令遇到錯誤如下，\n\nD:\\SomeRepo>git pull\n\nfatal: unable to access 'https://mygit.com/SomeRepo.git/': SSL certificate problem: unable to get local issuer certificate\n\n解法：\n\n設定Windows憑證儲存機制即可。\n\nD:\\SomeRepo>git config --system http.sslbackend \"schannel\"\n","tags":["windows","ssl","git"]},{"title":"MySQL容器SQL腳本初始化UTF8內容為亂碼","url":"/2024/03/13/mysql-container-initialize-script-mojibake/","content":"\n原因：因為執行初始化的終端環境語系不是UTF-8。\n\n解法：在docker-compose.yml MySQL服務的環境變數加上\"LANG: C.UTF-8\"即可。\n\n```\nversion : '3.8'\nservices:\n  mysql:\n  ..............\n    environment:\n      LANG: C.UTF-8 #加上這行\n```\n\n參考來源：[Docker Mysql DB 初始化 UTF8 乱码问题的解决](https://www.codesky.me/archives/docker-mysql-utf8-encoded.wind \"https://www.codesky.me/archives/docker-mysql-utf8-encoded.wind\")\n","tags":["docker","mysql"]},{"title":"docker compose v1遷移到v2指令的變化","url":"/2024/03/08/migrate-docker_compose-v1-to-v2/","content":"\n 影響：\n\ndocker-compose指令在v2版本改成docker compose(整合進docker變成副指令)\n\n有些舊專案卻還是用v1版本的docker-compose造成執行異常(找不到指令)\n\n解法：\n\n1. 建立捷徑檔(user@host:~$ sudo touch /bin/docker-compose)\n\n2. 編輯內容為docker compose --compatibility \"$@\"\n\n3. 增加捷徑檔執行權限(user@host:~$ sudo chmod +x /bin/docker-compose)\n\n4. docker compose與docker-compose都能執行成功\n\n參考來源：[How to alias docker-compose to docker compose?](https://stackoverflow.com/a/72187587 \"https://stackoverflow.com/a/72187587\")\n","tags":["docker"]},{"title":"假的SMTP伺服器","url":"/2024/03/05/fake-smtp-server/","content":"\n```\nversion: \"3.8\"\n\nservices:\n  fake-smtp-server:\n    container_name: fake-smtp-server\n    image: gessnerfl/fake-smtp-server:latest\n    restart: always #重開機自動帶起\n    ports:\n      - \"465:465\"\n      - \"8081:8081\"\n      - \"8082:8082\"\n    environment:\n      - FAKESMTP_PORT=465 #SMTP埠號\n      - SERVER_PORT=8081 #Web管理介面埠號\n      - MANAGEMENT_SERVER_PORT=8082 #API埠號\n    volumes:\n      - /etc/timezone:/etc/timezone # 使用宿主機時區\n      - /etc/localtime:/etc/localtime # 使用宿主機時間\n```\n\n啟動後連接到http://<假的SMTP伺服器位址>:8081/可以看到所寄送的郵件列表。\n\n[![](image_20240305_114231.png)](image_20240305_114231.png )\n\n  \n  \n  \n  \n  \n\n參考來源：[Fake SMTP Server](https://github.com/gessnerfl/fake-smtp-server \"https://github.com/gessnerfl/fake-smtp-server\")\n\n","tags":["testing","docker","smtp"]},{"title":"docker ps 輸出結果格式化","url":"/2024/02/27/docker-ps-output-formatting/","content":"1.開啟~/.docker/config.json。(不存在則新增)\n\n2.編輯內容，新增屬性\"psFormat\"，輸出欄位可參照[Format the output (--format)](https://docs.docker.com/reference/cli/docker/container/ls/#format \"https://docs.docker.com/reference/cli/docker/container/ls/#format\")。\n\n{\n\n\"psFormat\": \"table {% raw %}{{.Names}}{% endraw %}\\t{% raw %}{{.Image}}{% endraw %}\\t{% raw %}{{.Status}}{% endraw %}\\t{% raw %}{{.Ports}}{% endraw %}\"\n\n}\n\n參考來源：[Docker CLI configuration file (config.json) properties](https://docs.docker.com/engine/reference/commandline/cli/#docker-cli-configuration-file-configjson-properties \"https://docs.docker.com/engine/reference/commandline/cli/#docker-cli-configuration-file-configjson-properties\")\n","tags":["docker"]},{"title":"用AutoHotKey建立全域自訂快捷鍵","url":"/2024/02/24/autohotkey-global-custom-shortcut/","content":"\n想達到\n\n1.雙按Esc=Ctrl+W(關閉分頁，大部份程式適用)\n\n2.雙按左Ctrl=Alt+←(瀏覽器為回上一頁)\n\n3.雙按左Alt=Alt+→(瀏覽器為到下一頁)\n\n4.按Ctrl+Shift切換輸入法(等同於WinKey+Space)\n\n的目的：\n\n本例使用AutoHotKey v2.0：\n\n0.安裝AutoHotKey v2，執行winget install AutoHotkey.AutoHotkey。\n\n1.開啟AutoHotKey Dash，選擇\"New script\"並選擇\"Minimal for v2\"。\n\n2.編輯AHK script，內容為\n\n```\n#Requires AutoHotkey v2.0\n\n~Esc::\n{\n    if (A_PriorHotkey != \"~Esc\" or A_TimeSincePriorHotkey > 400)\n    {\n        KeyWait \"Esc\"\n        return\n    }\n\n    Send \"{Ctrl down}w{Ctrl up}\"\n}\n\n~LControl::\n{\n    if (A_PriorHotkey != \"~LControl\" or A_TimeSincePriorHotkey > 400)\n    {\n        KeyWait \"LControl\"\n        return\n    }\n\n    Send \"{Alt down}{Left}{Alt up}\"\n}\n\n~LAlt:: {\n    if (A_PriorHotkey != \"~LAlt\" or A_TimeSincePriorHotkey > 400)\n    {\n        KeyWait \"LAlt\"\n        return\n    }\n\n    Send \"{Alt down}{Right}{Alt up}\"\n}\n```\n\n```\nLControl & LShift:: {\n    Send \"{LWin down}{Space}{LWin up}\"\n}\n```\n\n※**A\\_TimeSincePriorHotkey**需依不同執行環境調整。\n\n3.選擇\"Compile\"，開啟Ahk2Exe轉成執行檔，建立捷徑放在**啟動**資料夾。\n\n參考來源：[KeyWait - Syntax & Usage | AutoHotkey v2](https://www.autohotkey.com/docs/v2/lib/KeyWait.htm#ExDouble \"https://www.autohotkey.com/docs/v2/lib/KeyWait.htm#ExDouble\")\n","tags":["autohotkey"]},{"title":"複製尚未啟動Docker映像檔內的檔案","url":"/2024/02/19/copy-file-not_running-docker-image/","content":"\nuser@host:~$ id=$(docker create \"映像檔ID\")\n\nuser@host:~$ docker cp $id:\"檔案的映像檔內部路徑\" - > \"檔案的外部存放路徑\"*(因為會打包成tar檔，所以副檔名要為.tar)*\n\nuser@host:~$ docker rm -v $id\n\n參考來源：[Docker - how can I copy a file from an image to a host?](https://stackoverflow.com/a/31316636/1472545 \"https://stackoverflow.com/a/31316636/1472545\")\n","tags":["docker"]},{"title":"MariaDB開放外連","url":"/2024/02/06/mariadb-allow-external-connection/","content":"\n 1.修改 /etc/mysql/mariadb.conf.d/50-server.cnf\n\n將\n\nbind-address            = 127.0.0.1\n\n改成\n\nbind-address            = 0.0.0.0\n\n2.重啟服務，輸入以下指令\n\nuser@host:~$ sudo systemctl restart mysql.service\n\n3.進入MariaDB主控台，輸入以下指令\n\nuser@host:~$ mysql -u<DB帳號> -p<DB帳號密碼>\n\n4.設定要外連的資料庫，輸入以下指令\n\nMariaDB [(none)]> use <DB名稱>\n\n5.設定要外連的帳號和IP位址，輸入以下指令\n\nMariaDB [<DB名稱>]> GRANT ALL ON <DB名稱>.\\* to '<DB帳號>'@'<外連的IP位址>' IDENTIFIED BY '<DB帳號密碼>' WITH GRANT OPTION\n\n6.重新讀取權限，輸入以下指令\n\nMariaDB [<DB名稱>]> FLUSH PRIVILEGES\n\n7.生效，輸入以下指令退出MariaDB主控台\n\nMariaDB [<DB名稱>]> EXIT\n","tags":["mariadb"]},{"title":"安裝BigBlueButton(白板系統)注意事項","url":"/2024/01/18/install-bigbluebutton-note/","content":"\n安裝\n--\n\n1. 主機OS版本需為Ubuntu 20.04。\n2. 將SSL憑證上傳到/local/certs/目錄下，並將 `STAR_<公司名稱>_com.pem`更名為 `fullchain.pem`、`private.key`更名為 `privkey.pem`。\n3. 執行安裝腳本 `wget -qO- https://raw.githubusercontent.com/bigbluebutton/bbb-install/v2.7.x-release/bbb-install.sh | bash -s -- -v focal-270 -s <主機FQDN> -g -k -d`。\n4. 執行cd greenlight-v3。\n5. 修改設定檔 `.env`### SMTP CONFIGURATION設定。\n6. 修改設定檔 `.env`### EXTERNAL AUTHENTICATION METHODS(參照[External Authentication](https://docs.bigbluebutton.org/greenlight/v3/external-authentication \"https://docs.bigbluebutton.org/greenlight/v3/external-authentication\"))。\n7. 執行 `docker-compose down && docker-compose up -d`重啟容器即可。\n\n注意\n--\n\n* 升級BigBlueButton：\n\n1. 不可直接升級套件(`apt upgrade` or `apt dist-upgrade`)會造成設定檔設定錯誤而無法正常使用。\n2. 升級需再次執行安裝腳本 `wget -qO- https://raw.githubusercontent.com/bigbluebutton/bbb-install/v2.7.x-release/bbb-install.sh | bash -s -- -v focal-270 -s <主機FQDN> -g -k -d`，將會進行套件升級及BigBlueButton升級。\n\n* 將GreenLight使用者提升為管理員：\n\n1. 執行 `docker exec -it greenlight-v3 /bin/bash`進入GreenLight容器。\n2. 在GreenLight容器執行 `rails console`進入RoR控制台。\n3. 執行 `mail=\"<使用者信箱>\"`。\n4. 執行 `user = User.find_by(email: mail, provider: \"greenlight\")`。\n5. 執行 `user.role = Role.find_by(name: \"Administrator\", provider: \"greenlight\")`。\n6. 執行 `user.save!`。\n7. 連續執行 `exit`斷開連線。\n8. 重新登入BigBlueButton+GreenLight即為管理者。\n","tags":["bigbluebutton"]},{"title":"Ruby在Alpine Linux安裝debug gem失敗","url":"/2023/11/30/ruby-install-debug-gem-error/","content":"\n 1.執行gem install debug，顯示錯誤\n\nERROR:  Error installing debug:\n\nERROR: Failed to build gem native extension.\n\n2.缺少編譯用元件，\n\nAlpine linux執行apk add make && apk add gcc && apk add libc-dev && gem install debug 即可\n\nUbuntu linux執行apt install ruby-dev && gem install debug 即可\n","tags":["debugger","alpine linux","ruby"]},{"title":"今天是[程式設計師節]!!","url":"/2023/10/23/programmers-day/","content":"\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n","tags":["happy1024!"]},{"title":"Linux無法啟動Eclipse","url":"/2023/09/20/eclipse-cannot-run-on-linux/","content":"\n命令列顯示錯誤\n\nSWT OS.java Error: Failed to load swt-pi3, loading swt-pi4 as fallback.\n\nEclipse:\n\nAn error has occurred. See the log file\n\n/mnt/d/eclipse/configuration/xxxxxxxxxxxxx.log.\n\nLog內容為\n\njava.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons:   \n no swt-pi4-gtk-4962r3 in java.library.path: /usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib  \n no swt-pi4-gtk in java.library.path: /usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib  \n no swt-pi4 in java.library.path: /usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib  \n Can't load library: /root/.swt/lib/linux/x86\\_64/libswt-pi4-gtk-4962r3.so  \n Can't load library: /root/.swt/lib/linux/x86\\_64/libswt-pi4-gtk.so  \n Can't load library: /root/.swt/lib/linux/x86\\_64/libswt-pi4.so\n\n解法：\n\n安裝libswt-gtk-4-java元件(sudo apt install libswt-gtk-4-java)\n\n參考來源：[Issue after installing openxava - can't locate gtk3-3.22.30-5.el7.x86\\_64](https://sourceforge.net/p/openxava/discussion/419690/thread/bf34a4c810/#21bf \"https://sourceforge.net/p/openxava/discussion/419690/thread/bf34a4c810/#21bf\")\n","tags":["linux","eclipse"]},{"title":"JVMS - Java version manager for Windows","url":"/2023/09/19/jvms-java-version_manager-windows/","content":"\n[JVMS](https://github.com/ystyle/jvms \"https://github.com/ystyle/jvms\")作用與Linux平台的SDKMan!相同，可安裝管理不同版本的Java JDK。\n\n※另外一套[Jabba](https://github.com/shyiko/jabba \"https://github.com/shyiko/jabba\")雖然⭐數有2.7k，但在Windows 10切換版本根本沒有作用。\n\n安裝執行如下：\n\n0.移除本機已安裝的所有Java版本。\n\n1.下載[最新版](https://github.com/ystyle/jvms/releases \"https://github.com/ystyle/jvms/releases\")JVMS。\n\n2.解壓縮放到%USERPROFILE%\\.jvms目錄下。\n\n3.執行jvms init初始化。\n\n4.JVMS會建立全域系統變數JAVA\\_HOME=C:\\Program Files\\jdk，實際指向%USERPROFILE%\\.jvms\\store\\<所安裝的Java版本>，並在Path變數新增C:\\Program Files\\jdk\\bin項目。\n\n5.查看遠端指定Java版本可執行如：jvms rls -a | find \"1.6\"。\n\n6.執行jvms install <Java版本>，如：jvms install 1.6.0\\_43，可安裝1個或多個Java版本。\n\n7.執行jvms switch <Java版本>，如：jvms switch 1.6.0\\_43，切換到想要的Java版本。\n\n8.執行java -version驗證切換結果。\n","tags":["windows","java"]},{"title":"Linux修改登入時的目錄位置","url":"/2023/09/14/chang-login-directory-in-linux/","content":"目標為修改所有使用者登入目錄位置預設為根目錄；\n\n在/etc/profile.d 目錄下新增change-directory-to-root.sh，內容為\n\n```\neval \"$( bash -c 'echo \"cd /\"' )\"\n```\n\n(如果是用\n\n```\ncd / && bash\n```\n\n，會再產生一個子進程，退出要執行2次exit。)\n\n參考來源：[shell script - changing current directory from child process - Unix & Linux Stack Exchange](https://unix.stackexchange.com/a/367078 \"https://unix.stackexchange.com/a/367078\")\n","tags":["linux"]},{"title":"使用JBang產生原生平台程式","url":"/2023/08/14/jbang-generate-native-platform-application/","content":"1.使用SDKMAN!安裝JBang，\n\n命令列執行\n\n```\nsdk install jbang\n```\n\n2.安裝VSCode擴展套件JBang(增加引用語法//DEPS自動補完功能)\n\n[https://marketplace.visualstudio.com/items?itemName=jbangdev.jbang-vscode](https://marketplace.visualstudio.com/items?itemName=jbangdev.jbang-vscode \"https://marketplace.visualstudio.com/items?itemName=jbangdev.jbang-vscode\")\n\n3.初始化，\n\n命令列執行\n\n```\njbang init helloworld.java\n```\n\n4.撰寫Java程式\n\n5.偵錯與運行時參數\n\n在.vscode/launch.json\n修改如下\n\n```\n{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"type\": \"java\",\n            \"name\": \"helloworld\",\n            \"request\": \"launch\",\n            \"mainClass\": \"helloworld\",\n            \"projectName\": \"helloworld.java\",\n            \"args\": [\n                \"args1\",\n                \"args2\",\n                \"args3\"\n            ]\n        }\n    ]\n}\n```\n\n5.產生原生平台程式，\n\n命令列執行\n\n```\njbang --native helloworld.java\n```\n\n※進度輸出在編譯log，可用指令去追蹤，\n\n命令列執行\n\n```\ntail -f /tmp/jbang[亂數]native-image\n```\n\n6.如果編譯時有問題可清除快取，\n\n命令列執行\n\n```\njbang cache clear\n```\n","tags":["java","jbang"]},{"title":"試用大模型ChatGLM2-6B、Google Colab","url":"/2023/07/19/try-llm-chatglm2_6b-colab/","content":"\n1.在Google Colab執行\n\n```\nfrom google.colab import drive  \ndrive.mount('/content/drive')\n```\n\n2.詢問\"要允許這個筆記本存取你的 Google 雲端硬碟檔案嗎？\"，點選[連線至 Google 雲端硬碟]按鈕→選擇連線帳戶→點選[Allow]按鈕\n\n[![](image_20230719_155725.png)](image_20230719_155725.png )\n\n  \n\n3.在Google Drive新增GitHub資料夾以存放ChatGLM2-6B專案\n\n```\n%mkdir /content/drive/MyDrive/GitHub  \n%cd /content/drive/MyDrive/GitHub\n```\n\n※每行Linux指令開頭需加上%符號\n\n4.依[專案說明](https://github.com/THUDM/ChatGLM2-6B#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F \"https://github.com/THUDM/ChatGLM2-6B#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F\")執行\n\n複製ChatGLM2-6B專案、安裝專案依賴、代碼調用\n\n※每行Linux指令開頭需加上%符號\n\n5.效果如下：\n\n[![](image_20230719_153906.png)](image_20230719_153906.png )\n\n  \n\n","tags":["llm","google colab"]},{"title":"限制Docker log大小","url":"/2023/07/18/limit-docker-log-size/","content":"\n1.編輯/etc/docker/daemon.json。(不存在則新增。)\n\n2.編輯內容：\n\n```\n```\n```\n{\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"10m\",\n    \"max-file\": \"3\"\n  }\n}\n```\n```\n```\n\n3.執行docker-compose down關閉container。\n\n4.執行docker network prune清除docker網路設定。\n\n5.執行sudo systemctl restart docker重啟docker服務。\n\n6.執行docker-compose up -d啟動container。\n\n參考來源：[JSON File logging driver](https://docs.docker.com/config/containers/logging/json-file/ \"https://docs.docker.com/config/containers/logging/json-file/\")\n","tags":["docker"]},{"title":"試用本地小模型ChatRWKV、WSL2、4GB顯卡NVIDIA Quadro P1000","url":"/2023/07/11/try-local-llm-chatrwkv-wsl2/","content":"\n1.在Windows安裝/更新NVIDIA Windows版[顯卡驅動](https://www.nvidia.com/Download/index.aspx \"https://www.nvidia.com/Download/index.aspx\")(重要！WSL2內勿安裝Linux版顯卡驅動)\n\n2.在WSL2安裝Linux x86 CUDA Toolkit using WSL-Ubuntu Package([連結](https://docs.nvidia.com/cuda/wsl-user-guide/index.html#cuda-support-for-wsl-2 \"https://docs.nvidia.com/cuda/wsl-user-guide/index.html#cuda-support-for-wsl-2\"))\n\n3.複製ChatRWKV程式碼，執行git clone https://github.com/BlinkDL/ChatRWKV.git\n\n4.變更現在路徑到ChatRWKV，執行pip install -r requirements.txt(預安裝Python必要套件)\n\n5.下載本地小模型[RWKV-4-Pile-1B5-EngChn-test4-20230115.pth](https://huggingface.co/BlinkDL/rwkv-4-pile-1b5/blob/main/RWKV-4-Pile-1B5-EngChn-test4-20230115.pth \"https://huggingface.co/BlinkDL/rwkv-4-pile-1b5/blob/main/RWKV-4-Pile-1B5-EngChn-test4-20230115.pth\")到ChatRWKV\n\n6.修改chat.py，\n\n第40行改為 CHAT\\_LANG = 'Chinese'\n\n第48及58行改為args.MODEL\\_NAME = '<實際路徑>/ChatRWKV/RWKV-4-Pile-1B5-EngChn-test4-20230115'(不須.pth副檔名)\n\n7.執行python chat.py\n\n8.效果如下：\n\n[![](2023-07-11 10 43 05.png)](2023-07-11 10 43 05.png )\n\n  \n\n......😅 😂 🤣\n\n","tags":["chatrwkv","llm"]},{"title":"每日排程刪除資源回收筒(保留一段時間)","url":"/2023/06/26/delete-recyclebin-daily/","content":"1.安裝最新PowerShell  \n2.建立PowerShell script檔，內容為\n\n```\n[cmdletbinding()]\nparam(\n    [parameter(Mandatory)]\n    [ValidateNotNullorEmpty()]\n    $RetentionDays\n)\n\n# 目前時間-保留天數=最早保留時間\n$RetentionTime = (Get-Date).AddDays(-1 * $RetentionDays)\n\n$Shell = New-Object -ComObject Shell.Application\n$RecyclerBin = $Shell.NameSpace(10)\n\nif ($RecyclerBin)\n{\n    $RecyclerBinFiles = $RecyclerBin.Items()\n\n    foreach ($RecyclerBinFile in $RecyclerBinFiles)\n    {\n        # 檔案刪除時間\n        $DeleteTime = Get-Date ($RecyclerBin.GetDetailsOf($RecyclerBinFile, 2) -replace \"\\u200f|\\u200e\", \"\")\n\n        # 當檔案刪除時間早於最早保留時間時則刪除\n        if ($DeleteTime -lt $RetentionTime)\n        {\n            Remove-Item -Path $RecyclerBinFile.Path -Confirm:$false -Force -Recurse\n        }\n    }\n}\n```\n\n3.建立工作排程器工作，  \n程式或指令碼：\"C:\\Program Files\\PowerShell\\7\\pwsh.exe\"  \n新增引數 (可省略)：-NoProfile -ExecutionPolicy Bypass -File \"{script檔路徑}\" -RetentionDays {保留天數}  \n  \n參考來源：[Delete old files in recycle bin with powershell - Stack Overflow](https://stackoverflow.com/a/22816296 \"https://stackoverflow.com/a/22816296\")\n","tags":["windows","powershell"]},{"title":"如何除錯時在空區塊或方法最後1個陳述式設定中斷點不被跳過","url":"/2023/06/21/set-special-breakpoint-java/","content":"在空區塊內或方法最後1個陳述式之後，新增陳述式\"\".isBlank();並在其設定中斷點(作用類似JavaScript的debugger)，如下：\n\n```\npublic void test() {\n    List variables = new ArrayList<>(List.of(\"A\", \"B\", \"C\"));\n\n    for (String variable: variables) {\n      // 這是一個空區塊\n      \"\".isBlank(); // 在這裡設定IDE中斷點，以查看變數variable的內容\n    }\n\n    // 這是方法最後1個陳述式\n    String variable2 = \"D\";\n    \"\".isBlank(); // 在這裡設定IDE中斷點，以查看變數variable2的內容\n}\n```\n\n參考來源：[python - Java do nothing - Stack Overflow](https://stackoverflow.com/a/60399943 \"https://stackoverflow.com/a/60399943\")\n","tags":["java"]},{"title":"用AutoHotKey針對應用程式自訂快捷鍵","url":"/2023/05/12/autohotkey-customize-shortcut-by-application/","content":"\n想在某些無法自訂快捷鍵的應用程式，如：Mozilla ThunderBird，達到按Esc=Ctrl+W，即關閉Tab的~~(偷懶)~~目的，\n\n本例使用AutoHotKey v2.0：\n\n1.開啟AutoHotKey Window Spy，移到ThunderBird視窗，複製整行ahk\\_exe thunderbird.exe\n\n2.撰寫AHK script，建立檔案myhotkey.ahk，內容為\n\n```\n#Requires AutoHotkey v2.0\n\n\n\nHotIfWinActive \"ahk_exe thunderbird.exe\"\n\n\n\nHotkey \"Esc\", CloseTab\n\n\n\nCloseTab(Thiskey)\n\n\n\n{\n\n\n\n    Send \"{Ctrl down}w{Ctrl up}\"\n\n\n\nReturn\n\n\n\n}\n```\n\n3.雙點script即執行，亦可用Ahk2Exe轉成執行檔，建立捷徑放在**啟動**資料夾。\n\n參考來源：[HotIf / HotIfWin](https://www.autohotkey.com/docs/v2/lib/HotIf.htm \"https://www.autohotkey.com/docs/v2/lib/HotIf.htm\")\n","tags":["autohotkey"]},{"title":"Maven 3.8.1+阻擋HTTP repositories(Blocked mirror for repositories)","url":"/2023/05/12/maven3_8_1-blocked-mirror-repositories/","content":"\n問題：\n\nMaven無法下載私服套件，錯誤訊息如下：\n\n[**ERROR**] Failed to execute goal on project xxx: **Could not resolve dependencies for project\nxxx:jar:1.5: Failed to collect dependencies at xxx:jar:1.0**: Failed to read artifact descriptor\nfor xxx:jar:1.0: Could not transfer artifact xxx:pom:1.0 from/to maven-default-http-blocker (http://0.0.0.0/):\nBlocked mirror for repositories: [ooo (http://maven.ooo.org/nexus/content/repositories/ooo, default, releases)]\n-> **[Help 1]**\n\n因為3.8.1+預設阻擋非HTTPS的倉庫。([來源](https://maven.apache.org/docs/3.8.1/release-notes.html \"https://maven.apache.org/docs/3.8.1/release-notes.html\"))\n\n解法：\n\n在${user.home}/.m2/settings.xml新增以下內容\n\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n\n\n<settings xmlns=\"http://maven.apache.org/SETTINGS/1.2.0\"\n\n\n\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\n\n\n  xsi:schemaLocation=\"http://maven.apache.org/SETTINGS/1.2.0\n    https://maven.apache.org/xsd/settings-1.2.0.xsd\">\n\n\n\n  <mirrors>\n\n\n\n    <mirror>\n\n\n\n      <id>maven-default-http-blocker</id>\n\n\n\n      <mirrorOf>dummy</mirrorOf>\n\n\n\n      <name>Pseudo repository to mirror external repositories initially using HTTP.</name>\n\n\n\n      <url>http://0.0.0.0/</url>\n\n\n\n      <blocked>false</blocked>\n\n\n\n    </mirror>\n\n\n\n  </mirrors>\n\n\n\n</settings>\n```\n\n參考來源：[How to disable maven blocking\nexternal HTTP repositories?](https://stackoverflow.com/a/68394404 \"https://stackoverflow.com/a/68394404\")\n","tags":["java","maven"]},{"title":"Clink使用Tab鍵自動補完指令","url":"/2023/05/08/clink-use-tab-autocomplete/","content":"1.新增設定檔，檔案路徑為\n\n%USERPROFILE%\\.inputrc\n\n2.修改設定檔，內容為\n\n\"\\t\": clink-insert-suggested-line\n\n參考來源：\n\n[https://github.com/chrisant996/clink/issues/332#issuecomment-1214454590](https://github.com/chrisant996/clink/issues/332#issuecomment-1214454590 \"https://github.com/chrisant996/clink/issues/332#issuecomment-1214454590\")\n","tags":["dos command","clink"]},{"title":"使用Apache Flink SQL+SQL Server CDC connector同步MSSQL資料表","url":"/2023/04/27/synchronize-mssql-to-apache-flink/","content":"1.開啟來源SQL Server資料庫CDC(Change data capture)功能，\n\n在SQL客戶端執行\n\n```\nEXEC sys.sp_cdc_enable_db\n```\n\n2.開啟來源資料表CDC功能，\n\n在SQL客戶端執行\n\n```\nEXEC sys.sp_cdc_enable_table\n```\n\n@source\\_schema = N'dbo',\n\n@source\\_name   = N'[來源資料表名稱]',\n\n@role\\_name     = N'db\\_cdcadmin',\n\n@supports\\_net\\_changes = 0\n\n3.驗證設定是否正確，\n\n在SQL客戶端執行\n\n```\nEXEC sys.sp_cdc_help_change_data_capture\n```\n\n4.複製\n\n[flink-sql-connector-sqlserver-cdc-2.3.0.jar](http://flink-sql-connector-sqlserver-cdc-2.3.0.jar \"http://flink-sql-connector-sqlserver-cdc-2.3.0.jar\")(擷取來源SQL Server資料表CDC紀錄用)\n\nflink-connector-jdbc-3.1-SNAPSHOT.jar(寫入目的SQL Server資料表用)\n\n[mssql-jdbc-12.2.0.jre11.jar](https://repo1.maven.org/maven2/com/microsoft/sqlserver/mssql-jdbc/12.2.0.jre11/mssql-jdbc-12.2.0.jre11.jar \"https://repo1.maven.org/maven2/com/microsoft/sqlserver/mssql-jdbc/12.2.0.jre11/mssql-jdbc-12.2.0.jre11.jar\")(SQL Server JDBC驅動程式)\n\n以上3個jar檔到Apache Flink主機的$FLINK\\_HOME/lib目錄。\n\n※TaskManager和JobManager都要放置。\n\n※由於目前Maven Central Repository的flink-connector-jdbc-3.0還不支援SQL Server，\n\n所以需先到官方GitHub下載[source code](https://github.com/apache/flink-connector-jdbc/releases/tag/v3.1.0-rc1 \"https://github.com/apache/flink-connector-jdbc/releases/tag/v3.1.0-rc1\")依照[說明](https://github.com/apache/flink-connector-jdbc/blob/main/README.md \"https://github.com/apache/flink-connector-jdbc/blob/main/README.md\")自行編譯。\n\n5.開啟Flink SQL CLI，\n\n在JobManager的shell執行\n\n```\n$FLINK_HOME/bin/sql-client.sh\n```\n\n6.建立來源資料表，\n\n參照[Flink-CDC-connector官方文件](https://ververica.github.io/flink-cdc-connectors/master/content/connectors/sqlserver-cdc.html \"https://ververica.github.io/flink-cdc-connectors/master/content/connectors/sqlserver-cdc.html\")在Flink SQL CLI執行Flink SQL即可。\n\n語法類似SQL，但欄位型態需參照文件最下面的**Data Type Mapping**進行修正。\n\n7.驗證是否正常連接，\n\n在Flink SQL CLI執行\n\n```\nSELECT * FROM [來源資料表];\n```\n\n8.建立目的資料表，\n\n參照[Flink-JDBC-connector官方文件](https://github.com/apache/flink-connector-jdbc/blob/main/docs/content/docs/connectors/table/jdbc.md \"https://github.com/apache/flink-connector-jdbc/blob/main/docs/content/docs/connectors/table/jdbc.md\")在Flink SQL CLI執行Flink SQL即可。\n\n9.驗證是否正常連接，\n\n在Flink SQL CLI執行\n\n```\nSELECT * FROM [目的資料表];\n```\n\n10.建立同步作業，\n\n在Flink SQL CLI執行\n\n```\nINSERT INTO [目的資料表] SELECT * FROM [來源資料表];\n```\n\n11.在Flink管理介面(http://[Flink主機位址]:8081/#/job/running)\n\n可看到該同步作業執行中。\n\n※在Flink SQL CLI會顯示新增作業的Job ID，比照Flink管理介面可看到該同步作業執行中。\n\n12.針對[來源資料表]進行CRUD作業，[目的資料表]資料也會(近乎)即時同步。\n","tags":["sql server","apache flink","change data capture"]},{"title":"VSCode在LimeSurvey進行開發除錯","url":"/2023/04/21/vscode-debug-limesurvey/","content":"情境：\n\nLimeSurvey用Bitnami打包，部署在實體主機；\n\n使用VSCode透過Remote Development在LimeSurvey開發自訂功能。\n\n手順：\n\n1.安裝必要元件，在命令列執行：\n\n```\nsudo apt install autoconf gcc libc6-dev make && sudo pecl install xdebug\n```\n\n2.編輯/opt/bitnami/php/lib/php.ini，在最後面加上\n\n```\n[XDebug]\n\n\n\nzend_extension = \"/opt/bitnami/php/lib/php/extensions/xdebug.so\"\n\n\n\nxdebug.mode = debug,develop,trace\n\n\n\nxdebug.start_with_request = yes\n```\n\n3.重啟LimeSurvey服務，在命令列執行：\n\n```\nsudo /opt/bitnami/ctlscript.sh restart\n```\n\n4.測試xdebug，在/opt/bitnami/limesurvey目錄新增test.php，內容為\n\n```\n<?php\n\n\n\nphpinfo();\n\n\n\n?>\n```\n\n5.瀏覽器連至<LimeSurvey主機網址>/test.php，會顯示PHP設定資訊，如果有xdebug項目代表主機端開啟除錯功能成功。\n\n6.開發端的VSCode安裝PHP除錯[PHP Debug](https://marketplace.visualstudio.com/items?itemName=xdebug.php-debug \"https://marketplace.visualstudio.com/items?itemName=xdebug.php-debug\")。\n\n7.再用VSCode Remote Development連至該台主機，開啟/opt/bitnami/limesurvey目錄。\n\n8.新增launch.json，會自動增加除錯設定\"Listen for Xdebug\"，  \n此時可以在PHP源碼上打中斷點，再按F5監聽即可。\n","tags":["visual studio code","php"]},{"title":"Ubuntu 20.04連Oracle資料庫","url":"/2023/04/13/ubuntu20_04-connect-oracle/","content":"\n1.下載Oracle Instant Client的壓縮包 [Instant Client for Linux x86-64 (64-bit) (oracle.com)](https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html#ic_x64_inst \"https://www.oracle.com/database/technologies/instant-client/linux-x86-64-downloads.html#ic_x64_inst\")，本例為instantclient-basiclite-linux.x64-21.9.0.0.0dbru.zip。\n\n2.解壓縮，移至/opt/oracle目錄下，本例為/opt/oracle/instantclient\\_21\\_9。\n\n3.設定環境變數，在/etc/profile.d目錄下，新增set-ld\\_library\\_path.sh，內容為：\n\n```\n#!/bin/bash\n\n\n\nexport LD_LIBRARY_PATH=\"/opt/oracle/instantclient_21_9\"\n```\n\n4.執行sudo apt install libaio1安裝APT套件。\n\n5.執行pip install cx\\_oracle安裝Python套件。\n\n6.完成。\n","tags":["python","linux","oracle"]},{"title":"VSCode 遠端開發無法儲存檔案","url":"/2023/04/12/vscode-remote-development-cannot-save/","content":"情境：\nVSCode遠端開發透過SSH連至Linux主機，連線帳號為一般帳號(已加入sudo群組)，編輯檔案後無法存檔，會顯示錯誤訊息\n\nFailed to save '[檔案名稱]': Unable to write file 'vscode-remote://ssh-remote+[帳號]@[主機][檔案路徑]' (NoPermissions (FileSystemError): Error: EACCES: permission denied, open '[檔案路徑]')\n\n(如下圖)。  \n![](2023-04-12 13 30 54.png)\n\n原因：\n\n微軟表示[VSCode不支援遠端開發儲存檔案時改用sudo權限](https://github.com/microsoft/vscode-remote-release/issues/8269 \"https://github.com/microsoft/vscode-remote-release/issues/8269\")，\n\n目前能找到的替代方案為【安裝擴展套件[Save as Root in Remote - SSH](https://marketplace.visualstudio.com/items?itemName=yy0931.save-as-root \"https://marketplace.visualstudio.com/items?itemName=yy0931.save-as-root\")並設定快捷鍵】，\n\n這樣在按下快捷鍵時就會先自動切換到sudo、詢問帳號密碼並儲存成功。\n\n","tags":["visual studio code","linux","remote development"]},{"title":"用Docker在樹莓派建立Anki同步伺服器","url":"/2023/04/10/anki-server-docker-raspberrypi4/","content":"情境：  \n客戶端為AnkiDroid，伺服器端為自建Anki同步主機，  \n架在樹莓派，使用ISP派發的固定IP，但不使用DNS。  \n  \n手順：  \n1.樹莓派需安裝docker及docker compose。  \n2.建立/opt/anki目錄，在其下建立資料夾app、cert、conf.d、log。  \n3.在其下建立docker-compose.yml，以啟動Anki同步主機及前端Nginx服務，  \n內容為：\n\n```\nversion: \"3\"\n\nservices:\n    anki:\n        image: ankicommunity/anki-sync-server-rs:latest\n        container_name: anki\n        working_dir: \"/app\"\n        restart: always #開機即自動重新啟動\n        ports:\n          - \"27701:27701\"\n        volumes:\n          - ./app:/app\n    nginx:\n        image:\n        container_name: nginx:latest\n        restart: always #開機即自動重新啟動\n        ports:\n          - \"8443:8443\"\n        volumes:\n          - ./cert:/etc/nginx/cert\n          - ./conf.d:/etc/nginx/conf.d\n          - ./log:/var/log/nginx\n```\n\n4.在app資料夾建立Anki同步主機設定檔(ankisyncd.toml)，  \n內容為：\n\n```\n[listen]\nhost = \"0.0.0.0\"\nport = 27701\n\n[paths]\nroot_dir = \".\"\n\n[encryption]\nssl_enable = false\ncert_file = \"\"\nkey_file = \"\"\n```\n\n5.建立自簽章憑證(AnkiDroid只能透過https與主機同步，但雙方只要有CA憑證即可)  \n5-1.執行wget https://github.com/FiloSottile/mkcert/releases/download/v1.4.4/mkcert-v1.4.4-linux-arm64  \n5-2.執行sudo mv mkcert-v1.4.4-linux-arm64 /usr/bin/mkcert  \n5-3.執行chmod +x /usr/bin/mkcert，設定為'可執行'權限。  \n5-4.執行mkcert -install，以產生Root CA憑證。  \n5-5.執行mkcert my-cert <ISP派發的固定IP> localhost 127.0.0.1 ::1  \n5-6.將產生的憑證移到cert資料夾。  \n  \n6.設定前端Nginx https站台，在conf.d資料夾建立設定檔(Anki.conf)，  \n內容為：\n\n```\nserver {\n    listen <自訂https port> ssl;\n    listen [::]:<自訂https port> ssl;\n\n    server_name <ISP派發的固定IP>;\n\n    ssl_certificate cert/<mkcert生成的CA憑證>;\n    ssl_certificate_key cert/<mkcert生成的CA憑證Key>;\n\n    location / {\n        client_max_body_size 0;\n\n        proxy_pass http://172.17.0.1:27701; # 宿主機\n    }\n```\n\n7.建立Anki使用者帳號密碼(AnkiDroid與主機同步用)  \n執行docker-compose run anki ankisyncd user -a <使用者帳號> <使用者密碼>  \n  \n8.執行docker compose up -d  \n9.執行mkcert -CAROOT，顯示Root CA憑證路徑，將該路徑的rootCA.pem安裝到Android手機。  \n  \n10.設定AnkiDroid客戶端，  \n設定→AnkiDroid→AnkiWeb 帳號輸入<使用者帳號>及<使用者密碼>→  \n進階設定→自訂同步伺服器→選取'使用自訂同步伺服器'→  \n同步地址輸入\"https://<ISP派發的固定IP>:<自訂https port>\"→  \n媒體檔案同步地址輸入\"https://<ISP派發的固定IP>:<自訂https port>/msync\"  \n  \n11.完成。\n  \n  \n參考：  \n[anki自定义同步服务器，附自建教程和福利](https://zhuanlan.zhihu.com/p/414484355 \"https://zhuanlan.zhihu.com/p/414484355\")  \n[使用 anki-sync-server-rs 部署自己的 anki 同步服务](https://www.bilibili.com/read/cv15441748 \"https://www.bilibili.com/read/cv15441748\")  \n[How to Create Locally Trusted SSL Certificates with mkcert on Ubuntu 20.04](https://www.howtoforge.com/how-to-create-locally-trusted-ssl-certificates-with-mkcert-on-ubuntu/#install-mkcert \"https://www.howtoforge.com/how-to-create-locally-trusted-ssl-certificates-with-mkcert-on-ubuntu/#install-mkcert\")\n","tags":["raspberry pi 4","docker","anki"]},{"title":"用docker-compose啟動docker有時佔用內網網段造成連線異常","url":"/2023/03/29/docker_compose-sometimes-block-connection/","content":"\n用指令docker network inspect container\\_default查詢，\n\n可發現該內網網段被佔用。\n\n1.編輯/etc/docker/daemon.json。(不存在則新增。)\n\n2.編輯內容：\n\n```\n{\n\n  \"default-address-pools\": [\n\n\n\n    {\n\n\n\n      \"base\": \"172.17.1.0/16\",\n\n\n\n      \"size\": 24\n\n\n\n    }\n\n\n\n  ]\n\n}\n```\n\n3.執行docker-compose down關閉container。\n\n4.執行docker network prune清除docker網路設定。\n\n5.執行sudo systemctl restart docker重啟docker服務。\n\n6.執行docker-compose up -d啟動container。\n","tags":["docker"]},{"title":"開發端在不同OS的git換行符號設定","url":"/2023/03/15/git-newline-setting-note/","content":"\n先前將git repository push到版控主機，  \n使用VSCode remote development在另一台server(Ubuntu 20.04)開發，\n\n在重新pull git repository後，\n\n執行shellscript顯示錯誤訊息xxxx.sh:\n/bin/sh^M: bad interpreter: No such file or directory  \n詢問New Bing後應該是跟git的換行符號設定有關。\n\n先用Notepad++開啟該檔並開啟View→Show\nSymbol→Show All Characters，  \n發現換行符號不是Linux的[LF]而是Windows的[CR][LF]。\n\n再查該台Ubuntu的git轉換換行符號的設定，  \nuser@host:path$ git config --global\ncore.autocrlf  \n居然顯示為true\n\n這代表雖然push到repository時是[LF]，但在該台Ubuntu執行pull時，  \n卻又被轉換成[CR][LF]而造成執行錯誤。\n\n所以在該台Linux主機執行\n\nuser@host:path$ sudo git config --**global**core.autocrlf **input**  \n(--**global**代表該帳號的全局設定；而**input**代表push時轉成[LF]，pull時不變動。)\n\n另外再執行\n\nuser@host:path$ sudo git config --**system**core.autocrlf **input**  \n(--**system**代表整個系統所有帳號都適用這個規則。)\n\n而在Windows主機則是執行\n\nC:\\Users\\user> git config --**system** core.autocrlf **true**\n\nC:\\Users\\user> git config --**global** core.autocrlf **true**\n\n(**true**代表push時轉成[LF]，但在pull時要自動轉成[CR][LF]。)\n","tags":["windows","linux","git"]},{"title":"Kettle用Nginx作為反向代理的注意事項","url":"/2023/03/13/kettle-with-nginx-note/","content":"\n場景：\n\n統一用Nginx作為反向代理，而Kettle及Nginx皆為Docker容器。\n\nNginx:\n\n在Kettle的設定檔，需新增sub\\_filter修正WebUI連結，避免找不到網頁錯誤。\n\n{\n\nsub\\_filter\\_once off;\n\nsub\\_filter /kettle/status /kettle/status/;\n\nsub\\_filter /kettle/jobStatus /kettle/jobStatus/;\n\n}\n\nKettle:\n\n需修改<Kettle目錄>/pwd/carte-config-master-8080.xml，\n\n<hostname>localhost</hostname>改為\n\n<hostname>0.0.0.0</hostname>\n","tags":["docker","nginx","kettle"]},{"title":"EasyFlow改用https連線(以Nginx作為反向proxy)","url":"/2023/02/08/easyflow_gp5_6-switch-https-with-nginx/","content":"\n[使用者]→https→[Nginx]→[EasyFlow]\n\n1.EasyFlow位址 http://<EasyFlow FQDN>:<EasyFlow port>/\n\n2.安裝SS憑證後EasyFlow位址 https://<EasyFlow FQDN>/\n\n3.Nginx設定檔\n\n```\nhttp {\n    # 設定請求內容大小無限制\n    client_max_body_size 0;\n}\n\n\nserver {\n    listen       443 default_server ssl;\n    server_name  <EasyFlow FQDN>;\n\n    ssl_certificate      SSL憑證路徑;\n    ssl_certificate_key  PrivateKey路徑;\n    ssl_prefer_server_ciphers  on;\n\n    # https://<EasyFlow FQDN>/ -> https://<EasyFlow FQDN>/NaNaWeb/*\n    location = / {\n        rewrite ^/(.*)$ /NaNaWeb/$1 last;\n    }\n\n    # favicon.ico圖示\n    location ~* ^/favicon.ico$ {\n        proxy_pass http://<EasyFlow FQDN>:<EasyFlow port>;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n\n    location ~* ^/NaNaWeb/.*$ {\n        proxy_pass http://<EasyFlow FQDN>:<EasyFlow port>;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        sub_filter_once off;\n        sub_filter http://<EasyFlow FQDN> https://<EasyFlow FQDN>;\n    }\n}\n```\n\n```\n```\n\n```\n\n\n\n```\n再reload Nginx即可\n```\n```\n","tags":["easyflow gp","nginx","ssl"]},{"title":"Windows右鍵選單的新增(W)項目增加檔案類型","url":"/2023/01/04/windows-context_menu-add-file-type/","content":"\n新增文字檔，內容如下\n\nWindows Registry Editor Version 5.00\n\n```\n[HKEY_CLASSES_ROOT\\.<副檔名>]\n@=\"<檔案類型>\"\n```\n\n```\n[HKEY_CLASSES_ROOT\\.<副檔名>\\ShellNew]  \n\"NullFile\"=\"\"\n\n[HKEY_CLASSES_ROOT\\<檔案類型>]  \n@=\"<右鍵新增(W)要顯示的檔案類型文字>\"\n```\n\n```\n\n```\n\n```\n修改副檔名為.reg並合併到登錄檔即可。\n```\n\n```\n參考來源：Can't add new items to Windows 7 \"new\" context menu\n```\n","tags":["windows"]},{"title":"Modified JavaScript value在Transformation的第1個Step無任何輸出","url":"/2022/12/27/modified-javascript-value-output-no_value/","content":"\n 狀況：\n\nTransformation內含2個Step，第1個Step產生SSH指令供第2個Stepg執行\n\n(Step1)[Modified JavaScript value]→(Step2)[Run SSH commands]\n\n[![](image-small.png)](image.png )\n\n但並未產生任何可供SSH執行的指令。\n\n(視窗下方Execution Results區域→Preview data頁籤→Fields欄位無任何內容)\n\n修正：\n\n在[Modified JavaScript value]前面加一個空的[Get variables]即可。\n\n(Step1)[Get variables]→(Step2)[Modified JavaScript value]→(Step3)[Run SSH commands]\n\n[![](image2-small.png)](image2.png )\n\n","tags":["kettle"]},{"title":"PDI Kettle異常使用Arthas偵錯排除","url":"/2022/12/20/kettle-debug-with-arthas/","content":"\n1.Kettle Spoon的[Run SSH commands]連線異常\n\n[![](image-small.png)](image.png )\n\n  \n  \n\n2.下載[Arthas](https://arthas.aliyun.com/doc/ \"https://arthas.aliyun.com/doc/\")並執行，附加到/<Kettle目錄>/launcher/launcher.jar\n\n3.在GitHub搜尋[source code](https://github.com/jenkinsci/trilead-ssh2/blob/main/src/com/trilead/ssh2/Connection.java \"https://github.com/jenkinsci/trilead-ssh2/blob/main/src/com/trilead/ssh2/Connection.java\")，得知進行SSH連線的元件是com.trilead.ssh2，方法是connect\n\n4.輸入tt -t com.trilead.ssh2.Connection connect監控connect方法\n\n5.回到Spoon，點擊[Test connection]按鈕重現錯誤，記下INDEX數字(本例為1000)\n\n6.輸入tt -i 1000 -w 'target.connect'觸發錯誤\n\n7.查看~/logs/arthas/arthas.log，發現\"Caused by: java.io.IOException: Cannot negotiate, proposals do not match\"的異常\n\n8.查詢此[錯誤](https://www.dell.com/support/kbdoc/zh-tw/000196454/srm-4-7-%E5%B7%B2%E6%8E%92%E5%AE%9A-%E5%A0%B1%E5%91%8A-%E9%81%A0%E7%AB%AF-%E4%BD%8D%E7%BD%AE-ssh-%E5%82%B3%E8%BC%B8-%E5%A4%B1%E6%95%97-%E5%87%BA%E7%8F%BE-cannot-negotiate-proposals-do-not-match-%E9%8C%AF%E8%AA%A4 \"https://www.dell.com/support/kbdoc/zh-tw/000196454/srm-4-7-%E5%B7%B2%E6%8E%92%E5%AE%9A-%E5%A0%B1%E5%91%8A-%E9%81%A0%E7%AB%AF-%E4%BD%8D%E7%BD%AE-ssh-%E5%82%B3%E8%BC%B8-%E5%A4%B1%E6%95%97-%E5%87%BA%E7%8F%BE-cannot-negotiate-proposals-do-not-match-%E9%8C%AF%E8%AA%A4\")為SSH演算法不相容，修改伺服端主機的/etc/ssh/sshd\\_config，  \nMACS區段加入hmac-sha1-96，Kexalgorithms區段加入diffie-hellman-group-exchange-sha1  \n※Windows主機為%programdata%\\ssh\\sshd\\_config\n\n新增內容如下\n\nMatch Group administrators\n\n       AuthorizedKeysFile \\_\\_PROGRAMDATA\\_\\_/ssh/administrators\\_authorized\\_keys\n\nMatch all<--如果有Match Group要加這行關閉Match block\n\n# Pentaho Kettle [Run SSH commands]\n\nKexalgorithms +diffie-hellman-group-exchange-sha1\n\nMACS +hmac-sha1-96\n\nHostKeyAlgorithms +ssh-rsa,ssh-dss<--Windows主機再加這行\n\n9.重啟SSH服務\n\n10.Kettle Spoon的[Run SSH commands]連線即正常\n\nPS:Arthas誠為神器也\n\nPS:sshd[啟用log紀錄](https://github.com/PowerShell/Win32-OpenSSH/wiki/Logging-Facilities \"https://github.com/PowerShell/Win32-OpenSSH/wiki/Logging-Facilities\")會很有幫助\n\n","tags":["kettle","java","arthas"]},{"title":"Java程式整合Kettle(未完成)","url":"/2022/12/20/java-program-integration-kettle-unfinished/","content":"\nKettle除了獨立運行的Carte Server，透過呼叫Rest API方式啟動Job及Transformer之外，\n\n還有Java API可整合到系統內部。\n\nOracle資料庫驅動程式因為[Oracle許可證不允許](https://stackoverflow.com/a/1074971 \"https://stackoverflow.com/a/1074971\")發布在公共Maven倉庫，所以必須手動下載到自建的內部Maven倉庫。\n\nKettle核心庫也必須手動下載到自建的內部Maven倉庫。\n\nmvn install:install-file -Dfile=jtds-1.3.1.jar -DgroupId=net.sourceforge.jtds -DartifactId=jtds -Dversion=1.3.1 -Dpackaging=jar #舊版(2008以前)MSSQL支援\n\nmvn install:install-file -Dfile=ojdbc7.jar -DgroupId=com.oracle -DartifactId=ojdbc7 -Dversion=12.1.0.2 -Dpackaging=jar #舊版(10g)Oracle支援\n\nmvn install:install-file -Dfile=orai18n.jar -DgroupId=com.oracle.ojdbc -DartifactId=orai18n -Dversion=19.3.0.0 -Dpackaging=jar #Oracle多語系支援\n\nmvn install:install-file -Dfile=metastore-9.3.0.0-428.jar -DgroupId=org.pentaho -DartifactId=libformula -Dversion=9.3.0.0-428 -Dpackaging=jar\n\nmvn install:install-file -Dfile=libformula-9.3.0.0-428.jar -DgroupId=org.pentaho.reporting.library -DartifactId=libformula -Dversion=9.3.0.0-428 -Dpackaging=jar\n\nmvn install:install-file -Dfile=kettle-core-9.3.0.0-428.jar -DgroupId=pentaho-kettle -DartifactId=kettle-core -Dversion=9.3.0.0-428 -Dpackaging=jar\n\nmvn install:install-file -Dfile=kettle-engine-9.3.0.0-428.jar -DgroupId=pentaho-kettle -DartifactId=kettle-engine -Dversion=9.3.0.0-428 -Dpackaging=jar\n\nmvn install:install-file -Dfile=pentaho-encryption-support-9.3.0.0-428.jar -DgroupId=org.pentaho -DartifactId=pentaho-encryption-support -Dversion=9.3.0.0-428 -Dpackaging=jar\n\nmvn install:install-file -Dfile=js-1.7R3.jar -DgroupId=org.mozilla -DartifactId=javascript -Dversion=1.7R3 -Dpackaging=jar\n\n※目前進度卡在載入plugin失敗，仍無法克服。\n\n※而且考量此整合方式如同再造一台Kettle AP主機，並且需自行開發與Carte Server的API查詢Job狀態相同的功能，故就此打住不再繼續研究。\n\n※成功經驗的先進網友xuanbo的[代碼倉庫](https://github.com/xuanbo/kettle-web \"https://github.com/xuanbo/kettle-web\")\n","tags":["kettle","java"]},{"title":"讓Tabby一啟動WSL就進入Linux使用者目錄","url":"/2022/12/20/tabby-start-home-directory-wsl2/","content":"\n新增以下參數\n\nC:\\\\Windows\\\\system32\\\\wsl.exe ~ -d Ubuntu\n\n參考來源：[https://github.com/Eugeny/tabby/issues/271#issuecomment-450564808](https://github.com/Eugeny/tabby/issues/271#issuecomment-450564808 \"https://github.com/Eugeny/tabby/issues/271#issuecomment-450564808\")\n","tags":["wsl2","tabby"]},{"title":"VSCode新增JShell插件指令(Maven限定)","url":"/2022/12/15/vscode-add-jshell-plug-instruction/","content":"\n在VSCode的設定檔 C:\\Users\\<使用者帳號>\\AppData\\Roaming\\Code\\User\\settings.json\n\n新增\n\n```\n\"maven.terminal.favorites\":\n[\n{\n\"alias\": \"jshell\",\n\"command\": \"com.github.johnpoth:jshell-maven-plugin:1.3:run -Dmaven.test.skip=true\"\n}\n]\n```\n\n效果如下：\n\n[![](image-small.png)](image.png )\n\n  \n  \n  \n  \n\n","tags":["visual studio code","java","jshell"]},{"title":"Kettle Spoon在Linux主機執行相關設定","url":"/2022/11/16/kettle-spoon-run-on-linux/","content":"\n因為Kettle目前仍不能像VSCode或Intellij等軟體使用WSL2執行並除錯，  \n為彌平開發環境(Windows)與部署環境(Linux)的差異，  \n決定將開發區移至另一台與部署環境設定相同的Linux主機。\n\n1.安裝Java(推薦使用SDKMAN)\n\n2.安裝Kettle([注意事項](https://tzengshinfu.blogspot.com/2022/06/kettle.html \"https://tzengshinfu.blogspot.com/2022/06/kettle.html\"))\n\n3.安裝Fcitx中文輸入法\n\n4.Linux安裝Xfce桌面([教程](https://www.linuxmi.com/ubuntu-20-04-xfce.html \"https://www.linuxmi.com/ubuntu-20-04-xfce.html\"))\n\n5.安裝遠端桌面Xrdp([教程](https://learn.microsoft.com/zh-tw/azure/virtual-machines/linux/use-remote-desktop?tabs=azure-cli \"https://learn.microsoft.com/zh-tw/azure/virtual-machines/linux/use-remote-desktop?tabs=azure-cli\"))\n\n效果圖：\n\n[![](img-20221116-171316.png)](img-20221116-171316.png )\n\n  \n  \n\n※2023/03/14更新，Windows 10組建 19044+已可執行Kettle GUI程式，\n\n建立程式捷徑如下：\n\n```\n> <wslg.exe路徑> (--user <使用者帳號>) -- <spoon.sh路徑>\n```\n\n※2023/04/25更新，WSLg程式中文字型顯示亂碼，可安裝Windows字型\n\n在WSL2命令列執行指令如下：\n\n```\n$ sudo ln -s /mnt/c/Windows/Fonts /usr/share/fonts/truetype/windows  \n$ fc-cache -fv\n```\n\n```\n\n```\n\n參考來源：[https://github.com/microsoft/wslg/issues/9#issuecomment-835320480](https://github.com/microsoft/wslg/issues/9#issuecomment-835320480 \"https://github.com/microsoft/wslg/issues/9#issuecomment-835320480\")\n\n※2024/05/22更新，WSLg安裝中文輸入法\n\n在WSL2命令列執行指令如下：  \n\n```\n$ sudo apt install fcitx # 中文輸入法  \n$ sudo apt install fcitx-table-cangjie3 # 倉頡第3代  \n$ sudo apt install fcitx-chewing # 新酷音\n```\n\n編輯/etc/locale.gen  \n  \n取消註解 zh\\_TW.UTF-8 UTF-8  \n  \n編輯~/.profile\n\n新增以下設定  \n\n```\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=@im=fcitx\nexport DefaultIMModule=fcitx\nfcitx-autostart &>/dev/null\n```\n\n套用設定  \n$ source ~/.profile  \n  \n參考來源：[https://www.80shihua.com/archives/2994](https://github.com/microsoft/wslg/issues/9#issuecomment-835320480 \"https://github.com/microsoft/wslg/issues/9#issuecomment-835320480\")\n\n","tags":["linux","kettle","wsl2","spoon"]},{"title":"VSCode使用JUnit對Java程式除錯並以Fiddler Classic擷取封包內容","url":"/2022/11/14/vscode-junit-debug-java/","content":"\n 1.VSCode該Workspace的settings.json加上\n\n```\n\"java.debug.settings.vmArgs\": \"-Dhttp.proxyHost=<Fiddler所在主機位址> -Dhttp.proxyPort=<Fiddler開啟Port號> -Dhttps.proxyHost=<Fiddler所在主機位址> -Dhttps.proxyPort=<Fiddler開啟Port號>\",\n\"java.test.config\": [{\n\t\"name\": \"fiddler\", // 測試時啟用Fiddler擷取封包的Profile名稱\n\t\"vmArgs\": [\n\t\t\"-Dhttp.proxyHost=<Fiddler所在主機位址>\",\n\t\t\"-Dhttp.proxyPort=<Fiddler開啟Port號>\",\n\t\t\"-Dhttps.proxyHost=<Fiddler所在主機位址>\",\n\t\t\"-Dhttps.proxyPort=<Fiddler開啟Port號>\"\n\t]\n},{\n\t\"name\":\"direct\" // 測試時不啟用Fiddler擷取封包的Profile名稱\n}\n],\n\"java.test.defaultConfig\": \"fiddler\", // 測試時啟用Fiddler擷取封包的Profile名稱\n\"testing.defaultGutterClickAction\": \"debug\", //測試按鈕行為改成debug\n```\n\n 2.Fiddler Classic>Tools>Options>HTTPS\n\n[![](img-20221114-201247.png)](img-20221114-201247.png )\n\n[![](img-20221114-165229.png)](img-20221114-165229.png )\n\n 3.Fiddler Classic>Tools>Options>Connections\n\n[![](img-20221114-201301.png)](img-20221114-201301.png )\n\n4.擷取成功畫面如下\n\n[![](img-20221114-201430.png)](img-20221114-201430.png )\n\n  \n\n","tags":["visual studio code","java","fiddler classic"]},{"title":"SDKMAN在登入時無法使用","url":"/2022/11/14/sdkman-not_loaded-when-login/","content":"因SDKMAN設定指令預設是寫入.bashrc，  \n但.bashrc是非登入的操作命令(登入後再另開terminal視窗時)才會生效，  \n為了可以在登入時直接使用SDKMAN指令，  \n可在.bash\\_profile加上  \n\n```\nif [ -f ~/.bashrc ]; then\n   source ~/.bashrc\nfi\n```\n\n參考來源：[https://joshstaiger.org/archives/2005/07/bash\\_profile\\_vs.html](https://joshstaiger.org/archives/2005/07/bash_profile_vs.html \"https://joshstaiger.org/archives/2005/07/bash_profile_vs.html\")\n","tags":["sdkman"]},{"title":"Tabby的SFTP目前目錄跟著終端機cd指令而變動","url":"/2022/11/14/tabby-sftp-follow-current-directory/","content":"\n 在遠端主機的使用者目錄下的Shell設定檔，\n\nBash:\n\n編輯~/.bash\\_profile(不存在請自建)\n\n加上\n\n```\nexport PS1=\"$PS1\\[\\e]1337;CurrentDir=\"'$(pwd)\\a\\]'\n```\n\n重新登入即可\n\nZSH:\n\n編輯~/.zshrc(不存在請自建)\n\n加上\n\n```\nprecmd () { echo -n \"\\x1b]1337;CurrentDir=$(pwd)\\x07\" }\n```\n\n重新登入即可\n","tags":["linux","tabby"]},{"title":"SDKMAN無法切換Java版本","url":"/2022/11/14/sdkman-cannot-switch-java-version/","content":"\n情況：\n\n1.之前已手動安裝Java 11\n\n2.在安裝SDKMAN後，用以下指令其安裝Java 17\n\n```\nme@server:~$ sdk install java 17.0.4.1-ms\n```\n\n```\n\n```\n\n3.設定Java當前版本\n\n```\nme@server:~$ sdk default java 17.0.4.1-ms\n```\n\n```\n\n```\n\n4.確認Java當前版本\n\n```\nme@server:~$ sdk current java\n  \n\nNot using any version of java\n```\n\n解法：\n\n1.執行\n\n```\nme@server:~$ sdk selfupdate force\n```\n\n2.再執行即可\n\n```\nme@server:~$ source \"$HOME/.sdkman/bin/sdkman-init.sh\"\n```\n\n參考來源：\n[https://stackoverflow.com/a/67084548](https://stackoverflow.com/a/67084548 \"https://stackoverflow.com/a/67084548\")\n","tags":["sdkman"]},{"title":"今天是[程式設計師節]!!","url":"/2022/10/23/programmers-day/","content":"\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n","tags":["happy1024!"]},{"title":"Linux無法連接MSSQL(provider: SSL Provider, error: 31 - Encryption(ssl/tls) handshake failed)的暫時解法","url":"/2022/09/29/linux-mssql-provider-ssl-error/","content":"在/etc/ssl/openssl.cnf加入一段\n\n```\n#region 連接到USUN-SQL需降低TLS版本\nopenssl_conf = default_conf\n\n[default_conf]\nssl_conf = ssl_sect\n\n[ssl_sect]\nsystem_default = system_default_sect\n\n[system_default_sect]\nMinProtocol = TLSv1\nCipherString = DEFAULT@SECLEVEL=1\n#endregion\n```\n\nJava程式需移除所指向版本目錄的conf/security/java.security\n\n※VSCode + Remote developement + JUnit時，需修改~/.vscode-server/extensions/redhat.java-<插件版本>-linux-x64/jre/<Java版本>-linux-x86\\_64/conf/security\n\n找到  \njdk.tls.disabledAlgorithms=SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, \\  \n移除TLSv1, TLSv1.1  \n變成  \njdk.tls.disabledAlgorithms=SSLv3, RC4, DES, MD5withRSA, \\  \n存檔  \n  \n連線字串需新增  \ntrustServerCertificate=true\n\n重啟Java程式\n\n但盡速升級MSSQL的SSL版本才是正道。\n\n參考來源：  \n[LINUX 下连接 SQL SERVER 数据库遇到了错误](http://www.zhishibo.com/articles/57511.html \"http://www.zhishibo.com/articles/57511.html\")\n","tags":["visual studio code","sql server","linux","java","remote development","wsl2"]},{"title":"將Notepad++設為開啟未知副檔名檔案的預設程式","url":"/2022/09/27/set-notepad-unknown-file-editor/","content":"將以下文字另存為登錄檔(副檔名為.reg)，並將{Notepad++執行檔路徑}取代為實際路徑(\\需改成\\\\)，再雙擊檔案執行即可。\n\n```\nWindows Registry Editor Version 5.00\n\n; 所有檔案的右鍵選單新增\"Edit with Notepad++\"\n[HKEY_CLASSES_ROOT\\*\\shell\\Edit with Notepad++]\n@=\"Edit with Notepad++\"\n\"Icon\"=\"{Notepad++執行檔路徑},0\"\n\n[HKEY_CLASSES_ROOT\\*\\shell\\Edit with Notepad++\\command]\n@=\"\\\"{Notepad++執行檔路徑}\\\" \\\"%1\\\"\"\n\n; 所有未知副檔名檔案都以Notepad++開啟\n[HKEY_CLASSES_ROOT\\Unknown\\shell\\Notepad++]\n@=\"Open with Notepad++\"\n\n[HKEY_CLASSES_ROOT\\Unknown\\shell\\Notepad++\\command]\n@=\"\\\"{Notepad++執行檔路徑}\\\" \\\"%1\\\"\"\n```\n\n```\n參考來源：\n```\n\n[Can I set default program for unknown/not registered extensions in Windows 10?](https://superuser.com/a/1613337 \"https://superuser.com/a/1613337\")  \n","tags":["windows"]},{"title":"DOS指令不顯示錯誤訊息且同時ERRORLEVEL設為0(正常結束)","url":"/2022/08/30/dos-command-normal-end-error/","content":"場景：\n\n遠端執行DOS指令搬移檔案，當檔案不存在時ERRORLEVEL變數會被設為1導致後續判斷異常。\n\n解法：\n\n在指令後加上**2>nul | cmd /c \"\"**\n\n例如：\n\nC:\\>move \\*.txt D:\\ **2>nul | cmd /c \"\"**\n\n**(2>nul不顯示找不到檔案的錯誤訊息，| cmd /c \"\"則將ERRORLEVEL設為0)**\n\nC:\\>echo %errorlevel%\n\n0\n","tags":["dos command"]},{"title":"Kettle注意事項","url":"/2022/06/22/kettle-note/","content":"1.Spoon編輯器的啟動script(Spoon.bat/spoon.sh)下面這行最後面要加上UTF-8(\"-Dfile.encoding=UTF-8\")，不然當ETL排程工作名稱含有中文字將無法開啟。\n\n```\nif \"%PENTAHO_DI_JAVA_OPTIONS%\"==\"\" set PENTAHO_DI_JAVA_OPTIONS=\"-Xms1024m\" \"-Xmx2048m\" \"-XX:MaxPermSize=256m\" \"-Dfile.encoding=UTF-8\"\n```\n\n  \n2.寫入資料庫發現如果文字型態欄位設非NULL時，當寫入空字串時，會被Kettle轉換成NULL而造成異常。\n\n需在.kettle\\kettle.properties 增加一行 KETTLE\\_EMPTY\\_STRING\\_DIFFERS\\_FROM\\_NULL=Y\n讓空字串保持原狀寫入。\n\n※位置預設在~/.kettle/kettle.properties或在$KETTLE\\_HOME/.kettle/kettle.properties\n\n  \n3.舊版(2008以前)MSSQL支援，需在lib目錄新增jtds-1.3.1.jar，Database Connection的Connection type需選MS SQL Server\n\n載點 [https://sourceforge.net/projects/jtds/](https://sourceforge.net/projects/jtds/ \"https://sourceforge.net/projects/jtds/\")\n\n  \n4.如果MSSQL Server只支援舊版TLS，需在Database Connection的Options新增trustServerCertificate=true。\n  \n  \n5.Kettle Carte Server支援SSL，修改pwd/carte-config-master-8080.xml\n\n```\n<slaveserver>  \n\n    <name>master1</name>  \n\n    <hostname>127.0.0.1</hostname>  \n\n    <port>8080</port>  \n\n    <hostname>(主機位址)</hostname>  \n\n    <port>(主機Port)</port>  \n\n    <username>(帳號)</username>  \n\n    <password>(密碼)</password>  \n\n    <master>Y</master>  \n\n    <sslConfig>  \n\n        <keyStore>(JKS憑證)</keyStore>  \n\n        <keyStorePassword>(keyStorePassword)</keyStorePassword>  \n\n        <keyPassword>(keyPassword)</keyPassword>  \n\n    </sslConfig>  \n\n</slaveserver>\n```\n\n  \n6.停止紀錄Kettle log，修改classes/log4j2.xml，註解以下節點即可。\n\n```\n<!--\n<RollingFile name=\"pdi-execution-appender\" fileName=\"logs/pdi.log\" filePattern=\"logs/pdi.%d{yyyy-MM-dd}.log\">\n    <PatternLayout>\n        <Pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} %-5p &lt;%t&gt; %m%n</Pattern>\n    </PatternLayout>\n    <Policies>\n        <TimeBasedTriggeringPolicy />\n    </Policies>\n    <DefaultRolloverStrategy/>\n</RollingFile>\n-->\n```\n\n7.在/etc/profile.d新增一個<設定檔名>.sh檔用來設定Kettle相關系統變數\n\n```\nexport LD_LIBRARY_PATH=\"\" #Kettle連接Oracle客戶端\nexport NLS_LANG=\"\" #Kettle連接Oracle資料庫字符集\nexport TNS_ADMIN=\"\" #Oracle客戶端配置文件目錄(如果有的話)\nexport PENTAHO_JAVA_HOME=\"\" #Kettle用Java JRE/JDK(目前Kettle需要Java 11)\nexport CLASSPATH=\"./:$PENTAHO_JAVA_HOME/lib:$LD_LIBRARY_PATH/orai18n.jar\" #Kettle引用的JDBC Jar檔\nexport KETTLE_HOME=\"\" #Kettle路徑\nexport PATH=\"$PATH:$LD_LIBRARY_PATH\"\n```\n\n變更<設定檔名>.sh檔的權限並生效\n\n```\n$ chmod +x <設定檔名>.sh\n$ source <設定檔名>.sh\n```\n\n8.啟動時提示缺少libwebkitgtk-1.0時，需自行安裝\n\n```\nsudo sh -c \"echo 'deb http://cz.archive.ubuntu.com/ubuntu bionic main universe' >> /etc/apt/sources.list\" && \\\nsudo apt update -y && apt install -y libwebkitgtk-1.0-0\n```\n\n參考來源：\n\n【[Ubuntu環境變數設定位置](https://help.ubuntu.com/community/EnvironmentVariables \"https://help.ubuntu.com/community/EnvironmentVariables\")】\n\n【[環境變數 - Oracle客戶端](https://docs.oracle.com/en/database/oracle/oracle-database/21/lacli/environment-variables-instant-client.html#GUID-BA8FB14E-1463-4F6A-9926-4F9F696E52D0 \"https://docs.oracle.com/en/database/oracle/oracle-database/21/lacli/environment-variables-instant-client.html#GUID-BA8FB14E-1463-4F6A-9926-4F9F696E52D0\")】\n\n【[查看Oracle資料庫字符集](https://docs.oracle.com/cd/E12102_01/books/AnyInstAdm784/AnyInstAdmPreInstall18.html \"https://docs.oracle.com/cd/E12102_01/books/AnyInstAdm784/AnyInstAdmPreInstall18.html\")】\n\n【[環境變數 - Kettle](https://help.hitachivantara.com/Documentation/Pentaho/5.4/0F0/0G0/020#da089c89-c26f-4443-8613-5ae9fd6e1360__set_environment_variables \"https://help.hitachivantara.com/Documentation/Pentaho/5.4/0F0/0G0/020#da089c89-c26f-4443-8613-5ae9fd6e1360__set_environment_variables\")】\n","tags":["kettle"]},{"title":"EFCore Scaffold-DbContext語法(PMC)","url":"/2022/06/21/efcore-scaffold-dbcontext-syntax/","content":"\n```\nScaffold-DbContext \"連線字串\" Microsoft.EntityFrameworkCore.SqlServer(Database Provider名稱) -ContextDir Models\\Database(Database class[DbContext]路徑) -OutputDir Models\\Database\\Tables(Table classes[DbSet]路徑) -ContextNamespace Models.Database(Database class[DbContext]命名空間) -Namespace Models.Database.Tables(Table classes[DbSet]命名空間) -Force -UseDatabaseNames -DataAnnotations -NoPluralize(不要複數化) -StartupProject \"專案名稱\"\n```\n","tags":["entity framework"]},{"title":"IIS資料夾搬移至其他主機注意事項","url":"/2022/06/20/iis-folder-to-another-host-note/","content":"\n1.資料夾內容搬移至另一台檔案主機。\n\n2.原本資料夾刪除，使用MKLINK指令建立連結如下：\n\n```\nMKLINK /D \"原本資料夾名稱\" \"另一台檔案主機路徑\"\n```\n\n3.IIS→原本資料夾(現在是MKLINK捷徑)→驗證→匿名驗證→編輯...\n\n啟用[特定使用者]，輸入有權限存取另一台檔案主機的帳號。\n\n[![](Image_20220620092639.png)](Image_20220620092639.png )\n\n  \n\n4.如果其他AP主機有存取此資料夾的需求，需在該AP主機執行：\n\n```\nfsutil behavior set SymlinkEvaluation R2R:1\n```\n\n","tags":["internet information server"]},{"title":"Linux各資料庫JDBC連線字串","url":"/2022/05/30/linux-database-jdbc-connection_string/","content":"\n MSSQL 2014\n\njdbc:sqlserver://**<資料庫位址>**:1433;databaseName=**<資料庫名稱>**\n\n※如果資料庫主機因未更新而只能用TLS v1.0連線，連線字串需加上 trustServerCertificate=true\n\n要另外修改java.security內容，開放TLS v1.0\n\n路徑 $JAVA\\_HOME/conf/security/java.security\n\n找到 jdk.tls.disabledAlgorithms=SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA\n\n將TLSv1, TLSv1.1刪除並存檔\n\nOracle 10g\n\njdbc:oracle:thin:@**<資料庫位址>**:1521:**<資料庫名稱>**\n\nMariaDB 10\n\njdbc:mariadb://**<資料庫位址>**:3306/**<資料庫名稱>**\n","tags":["jdbc"]},{"title":"Linux 各資料庫 ODBC 設定","url":"/2022/04/13/linux-database-odbc-setting/","content":"\n1.安裝UnixODBC(ODBC驅動程式管理員)(請參照網路教程)\n\n2.安裝各資料庫的ODBC驅動程式(請參照網路教程)\n\n3.把~/.odbc.ini(使用者ODBC)內容清空，統一修改/etc/odbc.ini(全域ODBC)(視狀況)\n\n編輯odbc.ini如下：\n\n```\n    #region MySQL\n    [<資料庫別名>]\n    Description=<資料庫敘述>\n    Driver=<驅動程式名稱，需與odbcinst.ini設定相同>\n    SERVER=<資料庫位址>\n    DATABASE=<資料庫名稱>\n    PORT=<資料庫埠號，通常是3306>\n    #endregion\n    \n    #region MSSQL\n    [<資料庫別名>]\n    Description=<資料庫敘述>\n    Driver=<驅動程式名稱，需與odbcinst.ini設定相同>\n    Server=tcp:<資料庫位址>,<資料庫埠號，通常是1433>\n    Database=<資料庫名稱>\n    #endregion\n    \n    #region Oracle\n    [<資料庫別名>]\n    Application Attributes = T\n    Attributes = W\n    BatchAutocommitMode = IfAllSuccessful\n    BindAsFLOAT = F\n    CloseCursor = F\n    DisableDPM = F\n    DisableMTS = T\n    Driver = <驅動程式名稱，需與odbcinst.ini設定相同>\n    DSN =\n    EXECSchemaOpt =\n    EXECSyntax = T\n    Failover = T\n    FailoverDelay = 10\n    FailoverRetryCount = 10\n    FetchBufferSize = 64000\n    ForceWCHAR = F\n    Lobs = T\n    Longs = T\n    MaxLargeData = 0\n    MetadataIdDefault = F\n    QueryTimeout = T\n    ResultSets = T\n    ServerName = <資料庫位址>:<資料庫埠號，通常是1521>/<資料庫名稱>\n    SQLGetData extensions = F\n    Translation DLL =\n    Translation Option = 0\n    DisableRULEHint = T\n    StatementCache=F\n    CacheBufferSize=20\n    UseOCIDescribeAny=F\n    SQLTranslateErrors=F\n    MaxTokenSize=8192\n    AggregateSQLType=FLOAT\n    #endregion\n```\n\n4.另外Oracle資料庫需在/etc/environment設定系統變數內容，  \nPATH(將Instant Client路徑附加到最後，以冒號分隔)  \nLD\\_LIBRARY\\_PATH(即Instant Client路徑)  \nNLS\\_LANG(與Oracle資料庫相同，可用此SQL語法查詢：\n\n```\nSELECT * FROM V$NLS_PARAMETERS WHERE PARAMETER IN ('NLS_LANGUAGE', 'NLS_TERRITORY', 'NLS_CHARACTERSET')\n```\n\n)  \n※不需TNS\\_ADMIN\n\n5.MSSQL如遇到SSL連線問題，\n可編輯/etc/ssl/openssl.cnf降低TLS版本暫時繞過  \n(參考來源：[[Microsoft][ODBC Driver 17 for SQL Server]SSL Provider: [error:1425F102:SSL routines:ssl\\_choose\\_client\\_version:unsupported protocol]\n#1112](https://github.com/microsoft/msphpsql/issues/1112#issuecomment-643522139 \"https://github.com/microsoft/msphpsql/issues/1112#issuecomment-643522139\"))\n\n```\n    #region 因SQL SERVER TLS版本較低，故先降低TLS版本\n    openssl_conf = default_conf\n    \n    [default_conf]\n    ssl_conf = ssl_sect\n    \n    [ssl_sect]\n    system_default = system_default_sect\n    \n    [system_default_sect]\n    MinProtocol = TLSv1\n    CipherString = DEFAULT@SECLEVEL=1\n    #endregion\n```\n","tags":["linux","odbc"]},{"title":"將CRT憑證轉換成PFX格式供IIS使用","url":"/2022/03/17/convert-crt-credential-pfx-format/","content":"\n```\n#cat intermediate.crt                                            intermediate.crt      root.crt                    > ca_bundle.crt\ncat  <證書頒發機構名稱>RSAOrganizationValidationSecureServerCA.crt USERTrustRSAAAACA.crt AAACertificateServices.crt > ca_bundle.crt\n#產生PFX格式憑證\nopenssl pkcs12 -export -in STAR_<公司名稱>_com.crt -inkey private.key -certfile ca_bundle.crt -out STAR_<公司名稱>_com.pfx\n```\n\n1.安裝步驟可參照網友John Wu心得：[IIS - 安裝SSL憑證](https://blog.johnwu.cc/article/iis-install-ssl-certificate.html \"https://blog.johnwu.cc/article/iis-install-ssl-certificate.html\")  \n2.如果出現【憑證鏈結中缺少一或多個中繼憑證】的錯誤訊息，\n\n[![](image-small.png)](image.png )\n\n則再另外安裝缺少的中繼憑證即可。\n\n步驟可參照：[在執行伺服器驗證的 IIS 電腦上設定中繼憑證](https://docs.microsoft.com/zh-tw/troubleshoot/developer/webapps/iis/www-authentication-authorization/configure-intermediate-certificates \"https://docs.microsoft.com/zh-tw/troubleshoot/developer/webapps/iis/www-authentication-authorization/configure-intermediate-certificates\")\n\n下圖為現在安裝的所有中繼憑證，缺什麼就裝什麼。\n\n[![](image2-small.png)](image2.png )\n\n3.若需將現有http連線導向至https，\n\n可參考Will保哥心得：[強迫網站轉向到 HTTPS 加密安全連線 ( IIS URL Rewrite )](https://blog.miniasp.com/post/2014/06/04/Redirect-to-HTTPS-from-HTTP-using-IIS-URL-Rewrite \"https://blog.miniasp.com/post/2014/06/04/Redirect-to-HTTPS-from-HTTP-using-IIS-URL-Rewrite\")\n\n","tags":["internet information server","ssl"]},{"title":"合併SSL憑證供Nginx使用","url":"/2022/03/16/combine-ssl-certificat-for-nginx/","content":"\n```\n#cat intermediate.crt                                            intermediate.crt      root.crt                    > ca_bundle.crt\ncat  <證書頒發機構名稱>RSAOrganizationValidationSecureServerCA.crt USERTrustRSAAAACA.crt AAACertificateServices.crt > ca_bundle.crt\n#cat *_company_com.crt          ca_bundle.crt > server.crt\ncat  STAR_<公司名稱>_com.crt ca_bundle.crt > server.crt\n```\n\n```\n內容由上而下會是\n```\n\n```\n[STAR_<公司名稱>_com.crt]\n```\n\n```\n[<證書頒發機構名稱>RSAOrganizationValidationSecureServerCA.crt]\n```\n\n```\n```\n[USERTrustRSAAAACA.crt]\n```\n\n\n\n```\n```\n[AAACertificateServices.crt]\n```\n\n\n\n```\n```\n\n```\n\n\n\n```\n可對比以下2個指令的輸出\n```\n\n\n\n```\nopenssl x509 -noout -modulus -in server.crt | openssl md5\n```\n\n\n\n```\nopenssl rsa -noout -modulus -in server.key | openssl md5\n```\n\n\n\n```\n如果相同代表組合無誤，不然就是順序錯誤或內容有誤(空格造成位移等)\n```\n\n\n\n```\n\n```\n\n\n\n```\n另可執行以下指令檢查憑證到期日\n```\n\n\n\n```\nopenssl x509 -enddate -noout -in server.crt\n```\n\n\n\n輸出如下\n\n\n\nnotAfter=Apr  6 23:59:59 2026 GMT\n\n\n\n```\n\n```\n```\n```\n```\n\n在Nginx設定檔填入\n\n```\nserver {\n    listen 80;\n\n    server_name #網域名稱;\n\n    return 302 https://$host$request_uri; #將http要求導向到https\n}\nserver {\n        listen 443 ssl;\n\n        server_name #網域名稱;\n        \n        ssl_certificate /etc/nginx/cert/server.crt;\n        ssl_certificate_key /etc/nginx/cert/server.key;\n        ssl_prefer_server_ciphers on;\n\n        location / {\n            #既有設定\n        }\n}\n```\n\n```\n\n```\n\n```\n再reload Nginx即可\n```\n","tags":["nginx","ssl"]},{"title":"C# 非同步方法鏈式呼叫","url":"/2022/03/11/csharp-asynchronous-method-chain-call/","content":"原本是巢式呼叫\n\n```\nvar asyncCalculator= new AsyncCalculator(0);\n\n\n\nvar asyncCalculateResult =\n\n\n\n(\n\n\n\nawait (\n\n\n\nawait (\n\n\n\nawait (\n\n\n\nawait asyncCalculator.PlusAsync(1)\n\n\n\n).MinusAsync(2)\n\n\n\n).MultiplyAsync(3)\n\n\n\n).DivideAsync(4)\n\n\n\n).CalculateResult;\n```\n\n改寫成鏈式呼叫，一目瞭然\n\n```\nvar asyncCalculator= new AsyncCalculator(0);\n\n\n\nvar asyncCalculateResult = await asyncCalculator.PlusAsync(1)\n\n\n\n.ContinueWith(t => t.GetAwaiter().GetResult().MinusAsync(2)).Unwrap()\n\n\n\n.ContinueWith(t => t.GetAwaiter().GetResult().MultiplyAsync(3)).Unwrap()\n\n\n\n.ContinueWith(t => t.GetAwaiter().GetResult().DivideAsync(4)).Unwrap()\n\n\n\n.ContinueWith(t => t.GetAwaiter().GetResult().CalculateResult);\n\n\n\n//因為t.Result的異常會被包裝在AggregateException異常裡，所以改成呼叫t.GetAwaiter().GetResult()方法。\n\n\n\n//與JavaScript不同，會再多包一層Task回傳，所以要用Unwrap()方法剝掉。\n```\n","tags":["c#"]},{"title":"JavaScript 非同步方法鏈式呼叫","url":"/2022/03/11/javascript-asynchronous-method-chain-call/","content":"原本是巢式呼叫\n\n```\nlet asyncCalculator = new AsyncCalculator(0);\n\n\n\nlet asyncCalculateResult =\n\n\n\n(\n\n\n\nawait (\n\n\n\nawait (\n\n\n\nawait (\n\n\n\nawait asyncCalculator.plusAsync(1)\n\n\n\n).minusAsync(2)\n\n\n\n).multiplyAsync(3)\n\n\n\n).divideAsync(4)\n\n\n\n).calculateResult\n```\n\n改寫成鏈式呼叫，一目瞭然\n\n```\nlet asyncCalculator = new AsyncCalculator(0);\n\n\n\nlet asyncCalculateResult = await asyncCalculator.plusAsync(1)\n\n\n\n.then(c => c.minusAsync(2))\n\n\n\n.then(c => c.multiplyAsync(3))\n\n\n\n.then(c => c.divideAsync(4))\n\n\n\n.then(c => c.calculateResult)\n```\n\n參考來源：[https://es.discourse.group/t/await-postfix-operator/1244/4](https://es.discourse.group/t/await-postfix-operator/1244/4 \"https://es.discourse.group/t/await-postfix-operator/1244/4\")\n\n(分享此用法的該名網友是位JS大師，真的學到了。)\n","tags":["javascript"]},{"title":"今天是[程式設計師節]!!","url":"/2021/10/23/programmers-day/","content":"\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n","tags":["happy1024!"]},{"title":"C# FileSystemWatcher Changed會偵測2次的解決方式","url":"/2021/09/15/csharp-filesystem_watcher-changed-detect-twice/","content":"\nnamespace FileSystemWatcherTest {\n\nclass Program {\n\nprivate static ConcurrentDictionary<string, DateTime> dic = new ConcurrentDictionary<string, DateTime>();\n\nstatic void Main(string[] args) {\n\nvar watcher = new FileSystemWatcher {\n\n// 設定要監看的資料夾\n\nPath = @\"監看路徑\",\n\n// 設定要監看的變更類型(修改=LastWrite/新增&刪除=FileName/更名=Attributes)\n\nNotifyFilter = NotifyFilters.LastWrite | NotifyFilters.FileName | NotifyFilters.Attributes,\n\n// 設定要監看的檔案類型\n\nFilter = \"\\*.txt\",\n\n// 設定是否監看子資料夾\n\nIncludeSubdirectories = true,\n\n// 設定是否啟動元件，必須要設定為 true，否則監看事件是不會被觸發\n\nEnableRaisingEvents = true\n\n};\n\n  \n\n// 設定監看事件對應的處理邏輯\n\nwatcher.Changed += new FileSystemEventHandler(OnChanged);\n\nwatcher.Created += new FileSystemEventHandler(OnCreated);\n\nwatcher.Deleted += new FileSystemEventHandler(OnDeleted);\n\n  \n\nConsole.ReadLine();\n\n}\n\n  \n\nprivate static void OnDeleted(object sender, FileSystemEventArgs e) {\n\n//只會偵測1次\n\nConsole.WriteLine(\"檔案變更: \" + e.FullPath + \" \" + e.ChangeType);\n\n}\n\n  \n\nprivate static void OnCreated(object sender, FileSystemEventArgs e) {\n\n//只會偵測1次\n\nConsole.WriteLine(\"檔案變更: \" + e.FullPath + \" \" + e.ChangeType);\n\n}\n\n  \n\nprivate static void OnChanged(object source, FileSystemEventArgs e) {\n\n//會偵測2次\n\n#region 以最後更新時間判斷是否重複偵測變更(參考來源 https://www.cnblogs.com/jzywh/archive/2008/07/23/filesystemwatcher.html)\n\nvar currentModifyTime = File.GetLastWriteTime(e.FullPath);\n\nvar previousModifyTime = new Func<DateTime>(() => {\n\nDateTime funcResult = DateTime.MinValue;\n\n  \n\ndic.TryGetValue(e.FullPath, out funcResult);\n\nreturn funcResult;\n\n})();\n\nif (currentModifyTime == previousModifyTime) {\n\nreturn;\n\n}\n\n  \n\ndic.TryRemove(e.FullPath, out previousModifyTime);\n\ndic.TryAdd(e.FullPath, currentModifyTime);\n\n#endregion\n\n  \n\nConsole.WriteLine(\"檔案變更: \" + e.FullPath + \" \" + e.ChangeType);\n\n}\n\n}\n\n}\n","tags":["c#"]},{"title":"C#背景操作Excel不會殘留執行緒的方式","url":"/2021/09/10/csharp-excel-interop-background/","content":"\nMicrosoft.Office.Interop.Excel.Application application = null;\nMicrosoft.Office.Interop.Excel.Workbooks workbooks = null;\nMicrosoft.Office.Interop.Excel.Workbook workbook = null;\n\ntry {\n\napplication = new Microsoft.Office.Interop.Excel.Application();\n\nworkbooks = application.Workbooks;\n\nworkbook = workbooks.Open(@\"Excel檔案路徑\", Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n\n  \n\n//workbook相關操作\n\n}\n\ncatch (System.Exception ex) {\n\n//異常處理動作\n\n}\n\nfinally {\n\nif (workbook != null) {\n\nworkbook.Close(false, Type.Missing, Type.Missing);\n\nMarshal.ReleaseComObject(workbook);\n\n}\n\n  \n\nif (workbooks != null) {\n\nworkbooks.Close();\n\nMarshal.ReleaseComObject(workbooks);\n\n}\n\n  \n\nif (application != null) {\n\napplication.Quit();\n\nMarshal.ReleaseComObject(application);\n\n}\n\n}\n\n參考來源：[https://stackoverflow.com/a/158752](https://stackoverflow.com/a/158752 \"https://stackoverflow.com/a/158752\")\n","tags":["excel","c#"]},{"title":"VS Code對Blazor應用程式偵錯時顯示[遠端憑證無效]的異常","url":"/2021/07/28/vscode-debug-blazor-error/","content":"\n 狀況：\n\n[![](image_20210728082150-1.png)](image_20210728082150-1.png )\n\n  \n\n解法：\n\n在終端視窗輸入\n\n```\ndotnet dev-certs https --clean\ndotnet dev-certs https --trust\n```\n\n會顯示憑證安裝視窗\n\n[![](Image_20210728082117.png)](Image_20210728082117.png )\n\n按是(Y)安裝後即可正常偵錯。\n\n","tags":["visual studio code"]},{"title":"VS Code使用EditorConfig設定","url":"/2021/07/27/vscode-editor_config-setting/","content":"\n[![](Image_20210727105733.png)](Image_20210727105733.png )\n\n  \n\n1.新增.editorconfig及omnisharp.json 2個檔案。\n\n2.omnisharp.json內容如下：\n\n```\n{\n    \"RoslynExtensionsOptions\": {\n        \"enableAnalyzersSupport\": true,\n        \"enableMsBuildLoadProjectsOnDemand\": true\n    },\n    \"FormattingOptions\": {\n        \"enableEditorConfigSupport\": true\n    }\n}\n```\n\n```\n3..editorconfig內容如下：\n```\n\n```\n\n```\n\n```\n#### C# Formatting Rules ####\n\n  \n\n\n# New line preferences\n\n\n\ncsharp_new_line_before_catch = true\n\n\n\ncsharp_new_line_before_else = true\n\n\n\ncsharp_new_line_before_finally = true\n\n\n\ncsharp_new_line_before_members_in_anonymous_types = true\n\n\n\ncsharp_new_line_before_members_in_object_initializers = true\n\n\n\ncsharp_new_line_before_open_brace = none\n\n\n\ncsharp_new_line_between_query_expression_clauses = true\n```\n\n","tags":["visual studio code"]},{"title":"PowerShell刪除啟動已逾期的特定執行緒","url":"/2021/07/22/powershell-remov-specific-timeout-thread/","content":"\n```\nparam([Int32]$second=10<# 逾期秒數 #>)\n\nGet-Process | ForEach-Object {\n    if ($_.ProcessName -eq \"EXCEL\"<# 要尋找的執行序名稱 #>) {\n        $commandline = Get-CimInstance Win32_Process -Filter \"ProcessId = '$($_.Id)'\" | Select Commandline\n\n        if ($commandline -like '*automation*'<# 當命令列包含特定文字 #>) {\n            if ((NEW-TIMESPAN -Start $_.StartTime -End (Get-Date)).TotalSeconds -ge $second) {\n                Stop-Process -Id $_.Id\n            }\n        }    \n    }\n}\n```\n","tags":["powershell"]},{"title":"Outlook從遠端主機拉信回本機","url":"/2021/07/20/outlook-pull-messag-remote-host/","content":"在Module1新增\n\n```\nSub MoveItemsFromRemoteToLocal()\n    On Error Resume Next\n    \n    Set myNameSpace = Application.GetNamespace(\"MAPI\")\n    Set myLocalInbox = myNameSpace.Stores.Item(\"本機信箱顯示名稱\").GetDefaultFolder(olFolderInbox)\n    Set myRemoteInbox = myNameSpace.Stores.Item(\"遠端主機信箱顯示名稱\").GetDefaultFolder(olFolderInbox)  \n    Set myRemoteItems = myRemoteInbox.Items\n\n    For Each myRemoteItem In myRemoteItems\n        DoEvents\n        myRemoteItem.Move myLocalInbox '拉信回本機\n    Next\n\n    Set myRules = myRemoteInbox.Store.GetRules()\n\n    For Each myRule In myRules\n        myRule.Execute False, myLocalInbox, False, 2 '背景執行規則\n    Next\nEnd Sub\n```\n\n再執行此副函式即可。\n","tags":["vba"]},{"title":"Outlook每隔特定時間區間自動執行特定動作","url":"/2021/07/20/outlook-run-specific-action-interval/","content":"在ThisOutlookSession新增\n\n[![](Image_20210720141952.png)](Image_20210720141952.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\n```\nPrivate Sub Application_Quit()\n\n    If TimerID <> 0 Then Call DeactivateTimer '關閉定時器\n\nEnd Sub\n\n\n\nPrivate Sub Application_Startup()    \n\n    Call ActivateTimer(10) '設定定時器(10秒啟動1次)\n\nEnd Sub\n```\n\n在Module1新增\n\n```\nDeclare PtrSafe Function SetTimer Lib \"user32\" (ByVal hwnd As LongLong, ByVal nIDEvent As LongLong, ByVal uElapse As LongLong, ByVal lpTimerfunc As LongLong) As LongLong\nDeclare PtrSafe Function KillTimer Lib \"user32\" (ByVal hwnd As LongLong, ByVal nIDEvent As LongLong) As LongLong\n\nPublic TimerID As LongLong\n\nPublic Sub TriggerTimer(ByVal hwnd As Long, ByVal uMsg As Long, ByVal idevent As Long, ByVal Systime As Long)\n  <要執行的特定動作>\nEnd Sub\n\n\nPublic Sub DeactivateTimer()\n  lSuccess = KillTimer(0, TimerID)\n  \n  If lSuccess = 0 Then\n    MsgBox \"定時器無法停止\"\n  Else\n    TimerID = 0\n  End If\nEnd Sub\n\nPublic Sub ActivateTimer(ByVal nSeconds As Long)\n  nSeconds = nSeconds * 1000\n  \n  If TimerID <> 0 Then Call DeactivateTimer\n  \n  TimerID = SetTimer(0, 0, nSeconds, AddressOf TriggerTimer)\n  \n  If TimerID = 0 Then\n    MsgBox \"定時器無法啟動\"\n  End If\nEnd Sub\n```\n\n參考來源：[https://stackoverflow.com/a/30064953](https://stackoverflow.com/a/30064953 \"https://stackoverflow.com/a/30064953\")\n\n","tags":["vba"]},{"title":"Nuget無法取得套件清單，顯示\"無法建立 SSL/TLS 的安全通道\"的錯誤","url":"/2021/07/19/nuget-cannot-get-package-list/","content":"\n[![](Image_20210719113923.png)](Image_20210719113923.png )\n\n原因：Nuget於2020/04移除對TLS 1.0/1.1的支援。\n\n對策：執行以下指令即可。\n\n```\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client\" /v DisabledByDefault /t REG_DWORD /d 0 /f /reg:32\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client\" /v DisabledByDefault /t REG_DWORD /d 0 /f /reg:64\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client\" /v Enabled /t REG_DWORD /d 1 /f /reg:32\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client\" /v Enabled /t REG_DWORD /d 1 /f /reg:64\n```\n\n參考：[Deprecating TLS 1.0 and 1.1 on NuGet.org](https://devblogs.microsoft.com/nuget/deprecating-tls-1-0-and-1-1-on-nuget-org/ \"https://devblogs.microsoft.com/nuget/deprecating-tls-1-0-and-1-1-on-nuget-org/\")\n\n","tags":["dos command",".net framework",".net core"]},{"title":"找出部門主管在全部所屬單位的身份SQL","url":"/2021/07/07/find-department-director-all-function/","content":"\n```\nSELECT\n    OrganizationUnit.id AS organizationUnitID, OrganizationUnit.organizationUnitName, Users.id AS userID, Users.userName,\n    CASE WHEN OrganizationUnit.managerOID = Users.OID THEN 'Y' ELSE 'N' END AS isManager,\n    CASE WHEN Functions.isMain = 1 THEN 'Y' ELSE 'N' END AS isMainUnit\nFROM Users\nINNER JOIN Functions\nON Functions.occupantOID = Users.OID\nINNER JOIN OrganizationUnit\nON OrganizationUnit.OID = Functions.organizationUnitOID AND OrganizationUnit.validType = 1\nINNER JOIN (SELECT DISTINCT managerOID FROM OrganizationUnit WHERE validType = 1) AS Managers ON Managers.managerOID = Users.OID\nWHERE Users.leaveDate IS NULL\nORDER BY Users.id, OrganizationUnit.id;\n```\n","tags":["sql","easyflow gp"]},{"title":"Oracle Developer Tools for Visual Studio 2019安裝注意事項","url":"/2021/06/16/oracle-developer-tool-visual_studio/","content":"\n1.最新版(19.3.2版)改成Visual Studio擴充功能(VSIX)形式，安裝更方便。\n\n2.本機不需安裝Oracle Data Access Components(ODAC)。\n\n3.Visual Studio 2019需升級至16.4.2版以上。\n\n4.專案Oracle.ManagedDataAccess及Oracle.ManagedDataAccess.EntityFramework套件  \n需升級至19.3.0版以上。\n\n5.Visual Studio 2019→工具→選項→Oracle Developer Tools→連線組態→TNS管理位置 及 公事包檔案位置 需指向已存在tnsnames.ora的實體路徑，修改後並重啟Visual Studio。\n","tags":["visual studio"]},{"title":"輸入法快速鍵被重置的解決方法","url":"/2021/03/05/input-method-shortcut-reset-solution/","content":"\nWindows 10\n\n→ 🗔開始功能表\n\n→⚙️設定\n\n→🕒時間與語言\n\n→🅰️語言\n\n→右手邊的[系統管理語言設定]\n\n→[系統管理]頁籤\n\n→[複製設定]按鈕\n\n如下圖設定完成，就不會被重置。\n\n[![](a.png)](a.png )\n\n  \n\n參考來源：[Custom hotkeys to change input language disappear frequently - Microsoft Community](https://answers.microsoft.com/en-us/windows/forum/windows_8-desktop/custom-hotkeys-to-change-input-language-disappear/66d1d89d-e5dc-41e1-a8b3-48d596ab8e11?page=5 \"https://answers.microsoft.com/en-us/windows/forum/windows_8-desktop/custom-hotkeys-to-change-input-language-disappear/66d1d89d-e5dc-41e1-a8b3-48d596ab8e11?page=5\")\n\n","tags":["windows"]},{"title":"今天是[程式設計師節]!!","url":"/2020/10/24/programmers-day/","content":"\n```\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n```\n","tags":["happy1024!"]},{"title":"(筆記)部署.Net Core 3.1到IIS 8.5在Windows 2012 R2","url":"/2020/09/10/netcore3_1-deploy_iis8_5-windows2012_r2/","content":"\n**1.安裝.Net Core Runtime**A.ASP.NET Core 3.1 Runtime (v3.1.8) - Windows Hosting Bundle Installer(dotnet-hosting-3.1.8-win.exe)  \n↓相依元件↓  \nB.Microsoft Visual C++ Redistributable for Visual Studio 2015-2019(VC\\_redist.x64.exe)  \n↓相依hotfix↓  \nC.Windows8.1-KB2999226-x64.msu  \n↓相依hotfix↓  \nD.Windows8.1-KB2919355-x64.msu(很大,快700MB,要等)  \n↓相依hotfix↓  \nE.Windows8.1-KB2975061-x64.msu + 1.Windows8.1-KB2939087-x64.msu  \n(所以安裝順序為E→D→C→B→A)\n\n參考:[https://dotblogs.com.tw/dog0416/2016/09/05/152344](https://dotblogs.com.tw/dog0416/2016/09/05/152344 \"https://dotblogs.com.tw/dog0416/2016/09/05/152344\")\n\n**2.重啟IIS服務**在命令列輸入  \nnet stop was /y  \nnet start w3svc\n\n**3.新增站台**應用程式集區將CLR版本改成【沒有 Managed 程式碼】  \n網站資料夾的安全性需新增【IIS\\_IUSRS】群組,並賦予\"完全控制\"權限\n\n參考:[https://blog.johnwu.cc/article/iis-run-asp-net-core.html](https://blog.johnwu.cc/article/iis-run-asp-net-core.html \"https://blog.johnwu.cc/article/iis-run-asp-net-core.html\")\n\n**4.發行(透過Web Deploy)**Visual Studio 2019→建置→發佈  \n目標→網頁伺服器(IIS)→Web Deploy→輸入伺服器連線資訊→完成→發佈  \n※在發佈前,下方的摘要LastUsedBuildConfiguartion右邊有編輯圖示(一支筆)  \n點下去會出現傳統的Web Deploy設定畫面,記得點最下方的【驗證連線】,  \n等下發行才不會有驗證問題。(錯誤如下)\n\nWeb deployment task failed. (已連線到使用指定之處理程序 (\"Web Management Service\") 的遠端電腦 (\"192.168.100.102\")，但是無法驗證伺服器的憑證。如果您信任該伺服器，請再次連線，並允許未受信任的憑證。\n\n參考:[https://stackoverflow.com/questions/33088371/msdeploy-getting-error-certificate-validation-failed-allowuntrusted-being-ignor](https://stackoverflow.com/questions/33088371/msdeploy-getting-error-certificate-validation-failed-allowuntrusted-being-ignor \"https://stackoverflow.com/questions/33088371/msdeploy-getting-error-certificate-validation-failed-allowuntrusted-being-ignor\")\n","tags":[".net core"]},{"title":"解決:server.log每次重開機都被覆蓋","url":"/2020/09/04/server-log-overwritten-solution/","content":"路徑:<EasyFlow系統路徑>\\jboss-4.2.3.GA\\server\\default\\conf  \n修改log4j.xml的節點\nparam name=\"Append\" value=\"(改成true)\"\n位置如下\n\n```\n<log4j:configuration xmlns:log4j=\"http://jakarta.apache.org/log4j/\" debug=\"false\">\n\n  <!-- ================================= -->\n  <!-- Preserve messages in a local file -->\n  <!-- ================================= -->\n\n  <!-- A time/date based rolling appender -->\n  <appender name=\"FILE\" class=\"org.jboss.logging.appender.DailyRollingFileAppender\">\n    <errorHandler class=\"org.jboss.logging.util.OnlyOnceErrorHandler\"/>\n    <param name=\"File\" value=\"${jboss.server.log.dir}/server.log\"/>\n    <param name=\"Append\" value=\"false\"/><!--改成true-->\n```\n","tags":["easyflow gp"]},{"title":"設定流程變數注意事項","url":"/2020/08/24/process-variable-note/","content":"1.流程字串型態變數無法從表單Js程式設定為空字串,若設定會拋出異常(【''=空字串】被用在流程初始值)。  \n2.如果在formCreate/formOpen/formSave/formClose事件已設定變數內容,在控制項事件設定變數內容則無效。  \n3.如果未在formCreate/formOpen/formSave/formClose事件設定變數內容,則以控制項事件設定變數內容為主。  \n4.最好在formSave事件判斷並設定變數內容,可以如下設定:\n\n```\nfunction formOpen() {\n    //設定流程變數預設內容\n}\n\nfunction formSave(){  \n    if (符合條件) {\n      //設定符合條件的流程變數內容(覆蓋預設值)\n    }  \n\n    return true;\n}\n```\n\n5.流程設計師-流程變數雖然有字串/整數/浮點數/布林值/日期/XML型態,  \n建議只使用字串/整數/浮點數/布林值型態。  \n  \n字串內容以單引號或雙引號包覆皆可,  \n整數不可包含小數點,相反地浮點數可接受整數(無小數點),  \n布林值在比較時不寫true/false,而是1/0。\n\n(需符合Jython語法)  \n\n[![](Image+006.png)](Image+006.png )\n\n","tags":["easyflow gp"]},{"title":"工作排程器自訂觸發條件","url":"/2020/07/21/task_scheduler-custom-trigger-condition/","content":"如果工作排程器各種條件都不符合,則可以自訂條件。  \n(本例是每天早上第1次登入,如果昨天有遠端登入過系統,就會被當成是\"本機\"的遠端登入。)  \n  \n1.觸發程序選擇\"事件發生時\"→\"自訂\"→\"新事件篩選器\"。  \n\n[![](1.png)](1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.設定已有條件,再按\"XML\"頁籤新增自訂條件。  \n\n[![](2.png)](2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.點選\"手動編輯查詢\"。  \n\n[![](3.png)](3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n4.警告視窗按\"是\"。  \n\n[![](4.png)](4.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n5.開啟事件檢視器,點\"詳細資料\"→\"XML檢視\",得知自訂條件。  \n\n[![](5.png)](5.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n6.修改XML內容後儲存即可。  \n(查詢功能使用XPath語法,可參考[Wiki](https://en.wikipedia.org/wiki/XPath \"https://en.wikipedia.org/wiki/XPath\")。)  \n\n[![](6.jpg)](6.jpg )\n\n  \n\n","tags":["windows"]},{"title":"Outlook存檔時自動格式化圖片(加上邊框及超過規定大小則自動縮小)","url":"/2020/07/17/outlook-format-picture-automatically/","content":"在ThisOutlookSession新增  \n\n[![](Image+016.png)](Image+016.png )\n\n```\nPublic WithEvents outlookInspectors As Outlook.Inspectors\nPublic WithEvents outlookMailItem As Outlook.mailItem\n\nPrivate Sub Application_Startup()\n    Set outlookInspectors = Application.Inspectors\nEnd Sub\n\nPrivate Sub outlookInspectors_NewInspector(ByVal Inspector As Inspector)\n    Set currentOutlookMailItem = Inspector.CurrentItem\n    \n    If TypeName(currentOutlookMailItem) = \"MailItem\" Then\n        Set outlookMailItem = currentOutlookMailItem\n    End If\nEnd Sub\n\n'發現outlookMailItem_Write事件並不會每次都觸發,所以改在BeforeCheckNames事件(檢查名稱前)\nPrivate Sub outlookMailItem_BeforeCheckNames(Cancel As Boolean)\n    On Error Resume Next\n    \n    If Not Application.ActiveInspector Is Nothing Then\n        Set editor = Application.ActiveInspector.WordEditor\n        \n        For Each Picture In editor.InlineShapes\n            '不處理簽名檔圖片(替代文字=簽名檔圖片匯入時的檔名)\n            If Picture.AlternativeText <> \"signature\" Then\n                If Picture.Width > 750 Then\n                    Picture.Width = 750\n                End If\n                \n                '樣式=實線(wdLineStyleSingle)\n                '寬度=1pt(wdLineWidth100pt)\n                With Picture.Borders\n                    .OutsideLineStyle = 1\n                    .OutsideLineWidth = 8\n                    .OutsideColor = RGB(85, 142, 213)\n                End With\n            End If\n        Next\n    End If\nEnd Sub\n```\n\n","tags":["vba"]},{"title":"SSMS如PLSQL Developer一般從SELECT結果直接編輯資料列","url":"/2020/07/14/ssms-edit-column-data/","content":"1.編輯資料列  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.發現只想編輯id等於'a'的資料,在頁籤顯示區域內按右鍵→窗格→SQL  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.編輯SQL語法,加上過濾條件後,在語法區域內按右鍵→執行SQL  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n4.下方結果編輯區域即只顯示id等於'a'的結果,並可編輯欄位內容  \n\n[![](step4.png)](step4.png )\n\n  \n\n","tags":["ssms"]},{"title":"核決權限關卡 - 單位主管核定","url":"/2020/06/17/easyflow_gp5_6-approval-authority-level-note/","content":"狀況:  \n發現核決權限關卡設定最高層級為【事業群】,實際簽核應該到【總部】卻跳到【集團】。\n  \n\n[![](att.png)](att.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n原因:  \n原因是因為【總部】主管為非主管職(代理),而該關卡因為啟用\"單位主管核定\",所以會再向上尋找單位主管。  \n※建議可將此選項取消,避免主管代理人簽核完成又再次向上簽核,造成不必要的誤會。  \n\n[![](att2.png)](att2.png )\n\n  \n\n","tags":["easyflow gp"]},{"title":"樹莓派安裝Docker","url":"/2020/06/15/install-docker-on-raspberrypi4/","content":"# 裝https相關  \n$ sudo apt install apt-transport-https ca-certificates curl gnupg2 software-properties-common\n\n# 取得Docker金鑰  \n$ curl -fsSL https://download.docker.com/linux/$(. /etc/os-release; echo \"$ID\")/gpg | sudo apt-key add -\n\n# 編輯Docker來源  \n$ echo \"deb [arch=armhf] https://download.docker.com/linux/$(. /etc/os-release; echo \"$ID\") \\ $(lsb\\_release -cs) stable\" | \\ sudo tee /etc/apt/sources.list.d/docker.list\n\n# 安裝Docker  \n$ sudo apt install -y --no-install-recommends \\ docker-ce \\ cgroupfs-mount  \n  \n# 加入pi到docker組  \n$ sudo addgroup --system docker $ sudo adduser pi docker $ newgrp docker\n\n# 設為啟動服務\n\n$ sudo systemctl restart docker  \n$ sudo systemctl enable docker\n\n# 測試Docker是否正常  \n$ docker run hello-world  \n  \n# 清理殘留軟體包\n\n$ sudo apt autoremove --purge  \n$ sudo apt clean  \n  \n參考來源:  \n[yes-you-can-run-docker-on-raspbian](https://www.blogger.com/# \"https://www.blogger.com/#\")\n","tags":["raspberry pi 4","docker"]},{"title":"開放一般使用者模擬身份以利公測","url":"/2020/03/30/allow-simulation-mode-common-user/","content":"把[流程測試模式]設定為一般使用者亦可使用即可。  \n [![](%E9%99%84%E4%BB%B62.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n","tags":["easyflow gp"]},{"title":"Chrome快取資料夾位置(可搬到Ram disk或SSD以增進顯示速度)","url":"/2020/03/05/chrome-cache-folder/","content":"在C:\\Users\\{使用者帳號}\\AppData\\Local\\Google\\Chrome\\User Data下  \n搬移以下資料夾  \n  \n\n\\{設定檔名稱}\\Application Cache\n\n\\{設定檔名稱}\\Cache\n\n\\{設定檔名稱}\\Code Cache\n\n\\{設定檔名稱}\\DawnCache\n\n\\{設定檔名稱}\\GPUCache\n\n\\{設定檔名稱}\\Service Worker\\CacheStorage\n\n\\{設定檔名稱}\\Service Worker\\ScriptCache\n\n\\component\\_crx\\_cache\n\n\\FontLookupTableCache\n\n\\GraphiteDawnCache\n\n\\GrShaderCache\n\n\\PnaclTranslationCache\n\n\\ShaderCache\n","tags":["chrome"]},{"title":"將Visual Studio快取資料夾移到Ram disk以加快編譯速度","url":"/2020/03/04/move-visual_studio-cache-folder/","content":"\n將以下資料夾移到Ram disk可增進Visual Studio編譯速度\n**1.Visual Studio**\n在C:\\Users\\{使用者帳號}\\Appdata\\Local\\Microsoft\\VisualStudio\\{版本號}下\n[組件緩存資料夾]\n\\ComponentModelCache\n[專案Assembly快取資料夾]\n\\ProjectAssemblies\n[其他快取資料夾]\n\n\\Designer\\ShadowCache\n\n\\ImageLibrary\n\n※2019新增\n\\TextMateCache\n\n**2.專案**\n[各專案編譯輸出資料夾]\n\\{專案目錄}\\bin\n\n\\{專案目錄}\\obj\n[Assembly快取資料夾]\nC:\\Users\\{使用者帳號}\\AppData\\Local\\assembly\n**3.ASP.NET**\n[編譯暫存資料夾]\n設定檔位置\nC:\\Windows\\Microsoft.NET\\Framework\\v{版本號}\\Config\\machine.config\nC:\\Windows\\Microsoft.NET\\Framework64\\v{版本號}\\Config\\machine.config\n修改區段 ＜compilation tempDirectory=\"{指向Ram disk暫存目錄}\" /＞\n[網站快取資料夾]\nC:\\Users\\{使用者帳號}\\AppData\\Local\\Microsoft\\WebsiteCache\n[IIS Express Log資料夾]\nC:\\Users\\{使用者帳號}\\Documents\\IISExpress\\Logs\nC:\\Users\\{使用者帳號}\\Documents\\IISExpress\\TraceLogFiles\n","tags":["visual studio"]},{"title":"將VS Code快取資料夾移到Ram disk以加快執行速度","url":"/2020/03/03/move-vscode-cache-folder/","content":"\n1.將所有開啟中的VS Code程式全部關閉。\n\n或執行\n\nTASKKILL /IM code.exe\n\n2.在C:\\Users\\{使用者帳號}\\AppData\\Roaming\\Code下\n\n將以下資料夾刪除\n\n\\Cache\n\n\\CachedConfigurations\n\n\\CachedData\n\n\\CachedExtensions\n\n\\CachedExtensionVSIXs\n\n\\CachedProfilesData\n\n\\Code Cache\n\n\\DawnCache\n\n\\FontLookupTableCache\n\n\\GPUCache\n\n\\logs\n\n\\webrtc\\_event\\_logs\n\n\\Service Worker\\CacheStorage\n\n\\Service Worker\\ScriptCache\n\n或執行\n\nRMDIR /S /Q \"C:\\Users\\{使用者帳號}\\AppData\\Roaming\\Code\\上述資料夾名稱\"\n\n3.\n\n在RAM DISK逐一建立資料夾\n\n或用\n\nMKDIR \"{RAM DISK磁碟代號}:\\{上述資料夾名稱}\"\n\n3.以\"系統管理員權限\"逐一執行\n\nMKLINK /J \"C:\\Users\\{使用者帳號}\\AppData\\Roaming\\Code\\上述資料夾名稱\" \"{RAM DISK磁碟代號}:\\{上述資料夾名稱}\"\n\n4.出現捷徑箭頭的上述資料夾,逐一測試點擊內容將連結到Ram disk快取路徑則完成。\n","tags":["visual studio code"]},{"title":"流程關卡選項設定注意事項","url":"/2020/02/06/process-activity-option-note/","content":"一般設定:  \n❸[允許處理者退回重辦]→選\"允許1、2。預設按流程定義送回要求退件者\"  \n　 (正常情況如果有修改內容,應該要讓中間關卡的處理者們知悉。)  \n❹[允許使用者增加前一活動]→打勾(增加流程靈活度。)  \n❺[允許使用者增加後一活動]→打勾(增加流程靈活度。)  \n  \n如果是核決權限關卡的參考關卡則要將:  \n❻[允許自動簽核]→選\"2.與前一關同簽核者，則跳過\"(可減少處理者兼任多部門主管而造成的不必要簽核動作。)  \n  \n如果參考此關卡的活動需要依轉派後最新處理者做派送判斷,則要將:  \n❶[允許手動轉由他人處理]→打勾(轉派後,後續關卡會參考現在處理者派送至其主管/代理人。)  \n❷[允許手動委託代理人處理]→取消  \n　 (後續關卡仍參考之前處理者派送至其主管/代理人,容易造成誤解及再次轉派動作。)  \n\n[![](Image_20200206162655.png)](Image_20200206162655.png )\n\n  \n\n","tags":["easyflow gp"]},{"title":"退回重辦後無法向後加簽","url":"/2020/01/31/after-reexecute-cannot-add-activity/","content":"狀況:  \n 顯示錯誤訊息如下  \n [![](at1.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n  \n原因:  \n 此為EasyFlow系統邏輯;   \n 因為退回重辦有2種方式,   \n 下圖藍色是主管退回,在修正後送出仍要重跑每一關才到主管,   \n 下圖紅色是主管退回,在修正後送出就直接回到主管,   \n [![](at2.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n如果選擇上圖紅色(=略過之前已經執行過的關卡,直接回傳給我),   \n 系統會限制重新修正後派送的下一關就是主管而無法向後加簽,   \n   \n   \n 做法:   \n 1.可先派送回主管,再請主管重新選擇上圖藍色再退回重辦則能向後加簽。   \n 或   \n 2.以SQL語法修改狀態。  \n\n```\nSELECT OID --被退回的關卡的OID\n,comeBackActivityInstOID ,definitionId ,createdTime\nFROM ParticipantActivityInstance\nWHERE contextOID = ( SELECT contextOID\n    FROM ProcessInstance\n    WHERE serialNumber = '流程序號' ) AND definitionId = '目前被退回的關卡代號'\nORDER BY createdTime DESC OFFSET 0 ROWS FETCH FIRST 1 ROWS ONLY\n\n--2.將comeBackActivityInstOID設為NULL\nUPDATE ParticipantActivityInstance SET comeBackActivityInstOID = NULL WHERE OID = '被退回的關卡的OID'\n```\n\n  \n即可向後加簽。(會變成一關一關派送。)\n\n","tags":["easyflow gp"]},{"title":"附件按鈕權限注意事項","url":"/2020/01/09/easyflow_gp5_6-attachment-button-permission-note/","content":"\n[![](z3.png)](z3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\nEnable→只有上傳者能刪除自己的檔案(不限在哪個關卡上傳)  \nFull Control→能刪除表單所有檔案(可在第一關[流程發起者]設定)\n\n","tags":["easyflow gp"]},{"title":"安裝Seafile community版","url":"/2020/01/04/install-seafile-community-raspberrypi4/","content":"\n參考來源  \n#[https://www.kancloud.cn/kancloud/seafile-manual/51505](https://www.kancloud.cn/kancloud/seafile-manual/51505 \"https://www.kancloud.cn/kancloud/seafile-manual/51505\")\n\n1.下載Seafile套件  \n   \n 2.建立資料夾並解壓縮  \n cd /home  \n sudo mkdir haiwen   \n sudo mv seafile-server\\_[版本號] haiwen   \n cd haiwen   \n sudo tar -xzf seafile-server\\_[版本號]   \n sudo mkdir installed   \n sudo mv seafile-server\\_\\* installed  \n   \n 3.安裝Python套件   \n sudo apt update   \n sudo apt install python2.7 python-setuptools python-imaging python-mysqldb   \n   \n 4.建立root密碼並解鎖(等下MySQL會用到)   \n sudo passwd root   \n sudo passwd --unlock root\n\n5.安裝MariaDB  \n sudo apt install mariadb-server  \n sudo mysql\\_secure\\_installation   \n   \n 6.修改Linux 文件最大打開數   \n ulimit -n 30000   \n   \n 7.開始安裝  \n sudo ./setup-seafile-mysql.sh  \n   \n 8.設定seafile-data資料夾掛到其他如:NAS設備  \n sudo nano /etc/fstab  \n   \n 9.修改設定,不限IP可登入管理界面  \n編輯/home/haiwen/conf/gunicorn.conf  \n 將原本bind = \"127.0.0.1:8000\"  \n 改成bind = \"0.0.0.0:8000\"\n\n#[https://forum.seafile.com/t/seafile-7-only-listens-to-127-0-0-1/9544/6](https://forum.seafile.com/t/seafile-7-only-listens-to-127-0-0-1/9544/6 \"https://forum.seafile.com/t/seafile-7-only-listens-to-127-0-0-1/9544/6\")\n\n10.啟動Seafile服務   \n sudo ./seafile.sh start   \n sudo ./seahub.sh start  \n  \n 11.設定開機啟動\n\n可參考#[https://www.kancloud.cn/kancloud/seafile-manual/51496](https://www.kancloud.cn/kancloud/seafile-manual/51496 \"https://www.kancloud.cn/kancloud/seafile-manual/51496\")\n\n@刪除自動啟動腳本的-u ${user},直接以root帳號執行\n\n12.如果Seafile服務有對外需修改設定(改成對外IP)\n\n[![](Image_20200210115117.png)](Image_20200210115117.png )\n\n13.安裝client端並登入,設定同步\n\n","tags":["raspberry pi 4"]},{"title":"修改代理人時段注意事項","url":"/2020/01/02/modify-substitute-period-note/","content":"指派代理優先順序  \n*※代理機制指已設定工作處理方式為\"允許系統改派代理人處理\"及目前時間在\"代理期間起迄內\"。*  \n  \n❶流程關卡 - 允許系統改派他人→需啟用。  \n\n❷流程代理人 - 永久代理→只要是該流程一律轉派,不論是否啟動代理機制。  \n❸流程代理人 - 代理期間→符合該流程並在代理期間內並啟動代理機制才會轉派。  \n　(同一流程的代理期間與永久代理只能擇一設定。)  \n❹預設代理人 - 代理期間→不符合❷及❸設定時,在代理期間內並啟動代理機制才會轉派。\n\n❺預設代理人 - 預設代理人→不符合❷、❸及❹設定時,在代理期間內並啟動代理機制才會轉派。\n\n處理者本身→當上述所有代理人都無法處理時,最後才會停置。  \n  \n代理人有設定多個連續時段時,  \n需注意時段起迄需重疊。  \n\n[![](att1.png)](att1.png )\n\n  \n  \n  \n  \n  \n  \n因為時間都是為00秒開始計算,  \n如果時段1結束時間設23:59(=23:59:00),時段2開始時間設00:00(=00:00:00),  \n則23:59這1分鐘將會找不到代理人,  \n  \n如果有預設代理人,會跑到預設代理人,  \n如果沒有設預設代理人則回到請假人身上。\n\n如果代理人只有一位而且也啟用代理機制時則直接回到請假人身上。\n\n(不支援鏈式代理)\n\n","tags":["easyflow gp","踩坑"]},{"title":"在SSRS使用DECLARE陳述式的SQL無法預覽錯誤","url":"/2019/12/25/cannot-preview-declare-sql_syntax/","content":"原因:  \n在SSRS的查詢SQL中,  \n如果有自行宣告的變數跟查詢參數同時存在,  \n如\n\n```\nDECLARE @processDefinitionId NVARCHAR(100) = @processDefId;\nDECLARE @formSerialNumber NVARCHAR(50) = @formSN;\n```\n\n因為兩者都是@開頭,  \n在解析時會把查詢參數當成自行宣告的變數,  \n才會顯示以下異常  \n\n[![](Image_20191225152343.png)](Image_20191225152343.png )\n\n  \n  \n\n[![](Image_20191225152633.png)](Image_20191225152633.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n解法:  \n按[當成文字編輯]即可正確解析預覽結果。  \n\n[![](Image_20191226150225.png)](Image_20191226150225.png )\n\n","tags":["ssrs"]},{"title":"EasyFlow簽核履歷完整版SQL","url":"/2019/12/25/easyflow_gp5_6-sign_off-history-sql_syntax/","content":"1.包括轉派歷程  \n 2.整合表單上方的履歷跟下方的意見  \n\n```\nDECLARE @processDefinitionId nvarchar(100) = N'[要搜尋的流程定義代號]';\nDECLARE @formSerialNumber nvarchar(50) = N'[要搜尋的表單編號]';\nDECLARE @rsrcType nvarchar(10) = N'zh_TW';\nDECLARE @processNotStartedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.processInstance.state.notStarted' AND rsrcType = @rsrcType);\nDECLARE @processRunningText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.processInstance.state.running' AND rsrcType = @rsrcType);\nDECLARE @processSuspendedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.processInstance.state.suspended' AND rsrcType = @rsrcType);\nDECLARE @processCompletedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.processInstance.state.completed' AND rsrcType = @rsrcType);\nDECLARE @processAbortedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.processInstance.state.aborted' AND rsrcType = @rsrcType);\nDECLARE @processTerminatedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.processInstance.state.terminated' AND rsrcType = @rsrcType);\nDECLARE @notStartedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.notStarted' AND rsrcType = @rsrcType);\nDECLARE @runningText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.running' AND rsrcType = @rsrcType);\nDECLARE @suspendedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.suspended' AND rsrcType = @rsrcType);\nDECLARE @completedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.completed' AND rsrcType = @rsrcType);\nDECLARE @abortedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.aborted' AND rsrcType = @rsrcType);\nDECLARE @terminatedText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.terminated' AND rsrcType = @rsrcType);\nDECLARE @reexecuteText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.reexecute' AND rsrcType = @rsrcType);\nDECLARE @addCustomActText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.addCustomAct' AND rsrcType = @rsrcType);\nDECLARE @rollBackText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.rollBack' AND rsrcType = @rsrcType);\nDECLARE @noticeText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.notice' AND rsrcType = @rsrcType);\nDECLARE @executionText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.execution' AND rsrcType = @rsrcType);\nDECLARE @automaticText nvarchar(MAX) = (SELECT CAST(labelValue AS nvarchar(MAX)) AS labelValue FROM DBRsrcBundle WHERE labelKey = 'label.workStep.state.automatic' AND rsrcType = @rsrcType);\n\nSELECT CASE History.流程狀態\n        WHEN 0\n            THEN @processNotStartedText\n        WHEN 1\n            THEN @processRunningText\n        WHEN 2\n            THEN @processSuspendedText\n        WHEN 3\n            THEN @processCompletedText\n        WHEN 4\n            THEN @processAbortedText\n        WHEN 5\n            THEN @processTerminatedText\n        END AS \"流程狀態\"\n    ,History.處理者\n    ,FORMAT(History.建立時間, 'yyyy/MM/dd HH:MM:ss') AS \"建立時間\"\n    ,FORMAT(History.簽核時間, 'yyyy/MM/dd HH:MM:ss') AS \"簽核時間\"\n    ,History.簽核意見\n    ,History.關卡名稱\n    ,History.狀態\nFROM (\n    SELECT ProcessState AS \"流程狀態\"\n        ,CASE \n            WHEN newAssigneeOID IS NOT NULL\n                THEN id + '-' + userName + '(代)'\n            ELSE id + '-' + userName\n            END AS \"處理者\"\n        ,WorkItemData.createdTime AS \"建立時間\"\n        ,WorkItemData.completedTime AS \"簽核時間\"\n        ,CASE \n            WHEN WorkItemData.skipUserName <> ''\n                THEN WorkItemData.executiveComment + N'(' + WorkItemData.skipUserName + ')'\n            ELSE WorkItemData.executiveComment\n            END AS \"簽核意見\"\n        ,WorkItemData.workItemName AS \"關卡名稱\"\n        ,CASE \n            WHEN WorkItemData.bypassPerformerOID IS NOT NULL\n                THEN N'已跳過'\n            WHEN currentState = 0\n                THEN @notStartedText\n            WHEN currentState = 1\n                THEN @runningText\n            WHEN currentState = 2\n                THEN @suspendedText\n            WHEN currentState = 4\n                THEN @abortedText /**撤銷*/\n            WHEN currentState = 3\n                AND WorkItemData.performType = 'NOTICE'\n                THEN @noticeText /**通知*/\n            WHEN currentState = 3\n                AND WorkItemData.performType = 'EXECUTION'\n                THEN @executionText /**會辦*/\n            WHEN currentState = 3\n                AND WorkItemData.signoffState = 1\n                THEN @automaticText /**自動簽核*/\n            WHEN currentState = 3\n                THEN @completedText\n            WHEN currentState = 5\n                AND WorkItemData.terminateReason = 0\n                THEN @terminatedText /**終止*/\n            WHEN currentState = 5\n                AND WorkItemData.terminateReason = 1\n                THEN @reexecuteText /**退回*/\n            WHEN currentState = 5\n                AND WorkItemData.terminateReason = 2\n                THEN @addCustomActText /**向前加簽*/\n            WHEN currentState = 5\n                AND WorkItemData.terminateReason = 3\n                THEN @rollBackText /**取回*/\n            WHEN currentState = 5\n                THEN @terminatedText /**終止*/\n            END AS \"狀態\"\n    FROM (\n        SELECT ProcessInstance.currentState AS ProcessState\n            ,CASE \n                WHEN WorkItem.performerOID IS NULL\n                    AND WorkAssignment.assigneeOID IS NOT NULL\n                    THEN WorkAssignment.assigneeOID\n                ELSE WorkItem.performerOID\n                END performerOID\n            ,COALESCE(CAST(WorkItem.executiveComment AS NVARCHAR(MAX)), '') AS executiveComment\n            ,WorkItem.workItemName\n            ,WorkItem.createdTime\n            ,WorkItem.completedTime\n            ,WorkItem.currentState\n            ,ParticipantActivityInstance.performType\n            ,ReassignWorkItemAuditData.newAssigneeOID\n            ,WorkItem.skipUserName\n            ,WorkItem.signoffState\n            ,ParticipantActivityInstance.terminateReason\n        FROM WorkItem\n        LEFT JOIN WorkAssignment\n            ON WorkAssignment.workItemOID = WorkItem.OID\n        INNER JOIN ProcessContext\n            ON ProcessContext.OID = WorkItem.contextOID\n        INNER JOIN ProcessInstance\n            ON ProcessInstance.OID = ProcessContext.containerOID\n        INNER JOIN LocalRelevantData\n            ON LocalRelevantData.containerOID = ProcessInstance.contextOID\n        INNER JOIN FormInstance\n            ON FormInstance.OID = LocalRelevantData.valueOID\n        INNER JOIN ParticipantActivityInstance\n            ON ParticipantActivityInstance.OID = WorkItem.containerOID\n        LEFT JOIN ReassignWorkItemAuditData\n            ON ReassignWorkItemAuditData.currentProcessInstanceOID = ProcessInstance.OID\n                AND ReassignWorkItemAuditData.currentActivityInstanceOID = ParticipantActivityInstance.OID\n                AND ReassignWorkItemAuditData.sourceOID = WorkItem.OID\n        WHERE ProcessInstance.processDefinitionId = @processDefinitionId\n            AND FormInstance.serialNumber = @formSerialNumber\n        ) AS WorkItemData\n    INNER JOIN Users\n        ON Users.OID = WorkItemData.performerOID\n    \n    UNION\n    \n    SELECT ProcessInstance.currentState AS \"流程狀態\"\n        ,oldAssigneeId + '-' + oldAssigneeName AS \"處理者\"\n        ,ReassignWorkItemAuditData.createdTime AS \"建立時間\"\n        ,ReassignWorkItemAuditData.createdTime AS \"簽核時間\"\n        ,CASE \n            WHEN oldAssigneeName <> reassignmentRequester\n                THEN CAST(comments AS NVARCHAR(MAX)) + '(' + reassignmentRequester + ')'\n            ELSE CAST(comments AS NVARCHAR(MAX))\n            END AS \"簽核意見\"\n        ,WorkItem.workItemName AS \"關卡名稱\"\n        ,'已轉派' AS \"狀態\"\n    FROM ReassignWorkItemAuditData\n    INNER JOIN ProcessInstance\n        ON ProcessInstance.OID = ReassignWorkItemAuditData.currentProcessInstanceOID\n    INNER JOIN LocalRelevantData\n        ON LocalRelevantData.containerOID = ProcessInstance.contextOID\n    INNER JOIN FormInstance\n        ON FormInstance.OID = LocalRelevantData.valueOID\n    INNER JOIN WorkItem\n        ON WorkItem.OID = ReassignWorkItemAuditData.sourceOID\n    WHERE ProcessInstance.processDefinitionId = @processDefinitionId\n        AND FormInstance.serialNumber = @formSerialNumber\n    ) AS History\nORDER BY CASE \n        WHEN 簽核時間 IS NOT NULL\n            THEN 簽核時間\n        ELSE '9999-12-31 23:59:59.000'\n        END /**未處理因無簽核時間,以最大值時間排序才正常*/\n    ,建立時間;\n```\n","tags":["sql","easyflow gp"]},{"title":"找出WebService方法用在哪些流程中","url":"/2019/12/18/find-web_service-method-in-process/","content":"\n```\nDECLARE @METHOD_NAME NVARCHAR(100) = '[要尋找的WebService方法]';  \n  \nSELECT  \n ProcessDefinition.id,  \n RedefinableHeader.version,  \n ProcessDefinition.processDefinitionName,  \n '最新版' AS STATUS  \nFROM  \n WebApplication  \n INNER JOIN IAppDefContainer_AppDef ON WebApplication.OID = ApplicationDefinitionOID  \n INNER JOIN ProcessDefinition ON ProcessDefinition.OID = IAppDefContainer_AppDef.IAppDefContainerOID  \n INNER JOIN ProcessPackage_ProcessDef ON ProcessPackage_ProcessDef.ProcessDefinitionOID = ProcessDefinition.OID  \n INNER JOIN ProcessPackage ON ProcessPackage.OID = ProcessPackage_ProcessDef.ProcessPackageOID  \n INNER JOIN RedefinableHeader ON RedefinableHeader.OID = ProcessPackage.redefinableHeaderOID  \nWHERE  \n WebApplication.OID IN (  \n SELECT  \n OID  \n FROM  \n WebApplication  \n WHERE  \n CONCAT(id, CAST(objectVersion AS VARCHAR)) IN (  \n SELECT  \n CONCAT(id, CAST(MAX(objectVersion) AS VARCHAR))  \n FROM  \n WebApplication  \n WHERE  \n urlString LIKE '%' + @METHOD_NAME +'%'  \n GROUP BY  \n id  \n )  \n )  \nUNION  \nSELECT  \n ProcessDefinition.id,  \n RedefinableHeader.version,  \n ProcessDefinition.processDefinitionName,  \n '進行中' AS STATUS  \nFROM  \n WebApplication  \n INNER JOIN IAppDefContainer_AppDef ON WebApplication.OID = IAppDefContainer_AppDef.ApplicationDefinitionOID  \n INNER JOIN ProcessDefinition ON ProcessDefinition.OID = IAppDefContainer_AppDef.IAppDefContainerOID  \n INNER JOIN ProcessInstance ON ProcessInstance.processDefinitionId = ProcessDefinition.id  \n INNER JOIN ProcessPackage_ProcessDef ON ProcessPackage_ProcessDef.ProcessDefinitionOID = ProcessDefinition.OID  \n INNER JOIN ProcessPackage ON ProcessPackage.OID = ProcessPackage_ProcessDef.ProcessPackageOID  \n INNER JOIN RedefinableHeader ON RedefinableHeader.OID = ProcessPackage.redefinableHeaderOID  \nWHERE  \n urlString LIKE '%' + @METHOD_NAME +'%'  \n AND ProcessInstance.currentState IN (0, 1, 2)  \nUNION  \nSELECT  \n ProcessDefinition.id,  \n RedefinableHeader.version,  \n ProcessDefinition.processDefinitionName,  \n '最新版' AS STATUS  \nFROM  \n WebServicesApplication  \n INNER JOIN IAppDefContainer_AppDef ON WebServicesApplication.OID = ApplicationDefinitionOID  \n INNER JOIN ProcessDefinition ON ProcessDefinition.OID = IAppDefContainer_AppDef.IAppDefContainerOID  \n INNER JOIN ProcessPackage_ProcessDef ON ProcessPackage_ProcessDef.ProcessDefinitionOID = ProcessDefinition.OID  \n INNER JOIN ProcessPackage ON ProcessPackage.OID = ProcessPackage_ProcessDef.ProcessPackageOID  \n INNER JOIN RedefinableHeader ON RedefinableHeader.OID = ProcessPackage.redefinableHeaderOID  \nWHERE  \n WebServicesApplication.OID IN (  \n SELECT  \n OID  \n FROM  \n WebServicesApplication  \n WHERE  \n CONCAT(id, CAST(objectVersion AS VARCHAR)) IN (  \n SELECT  \n CONCAT(id, CAST(MAX(objectVersion) AS VARCHAR))  \n FROM  \n WebServicesApplication  \n WHERE  \n operationName = @METHOD_NAME  \n GROUP BY  \n id  \n )  \n )  \nUNION  \nSELECT  \n ProcessDefinition.id,  \n RedefinableHeader.version,  \n ProcessDefinition.processDefinitionName,  \n '進行中' AS STATUS  \nFROM  \n WebServicesApplication  \n INNER JOIN IAppDefContainer_AppDef ON WebServicesApplication.OID = ApplicationDefinitionOID  \n INNER JOIN ProcessDefinition ON ProcessDefinition.OID = IAppDefContainer_AppDef.IAppDefContainerOID  \n INNER JOIN ProcessInstance ON ProcessInstance.processDefinitionId = ProcessDefinition.id  \n INNER JOIN ProcessPackage_ProcessDef ON ProcessPackage_ProcessDef.ProcessDefinitionOID = ProcessDefinition.OID  \n INNER JOIN ProcessPackage ON ProcessPackage.OID = ProcessPackage_ProcessDef.ProcessPackageOID  \n INNER JOIN RedefinableHeader ON RedefinableHeader.OID = ProcessPackage.redefinableHeaderOID  \nWHERE  \n operationName = @METHOD_NAME  \n AND ProcessInstance.currentState IN (0, 1, 2);\n```\n","tags":["sql","easyflow gp"]},{"title":"Javascript forEach函數的break及continue方式","url":"/2019/12/12/how-javascript-foreach-break-continue/","content":"\n```\n//forEach模擬continue\nconst items = [1, 2, 3, 4, 5];\nconst no = 3;\n\nitems.forEach(function (item) {\n    if (item == no) {\n        return false;\n    }\n\n    console.log(item);\n});\n\n//some模擬break\nconst items = [1, 2, 3, 4, 5];\nconst no = 3;\n\nitems.some(function (item) {\n    if (item == no) {\n        return true;\n    }\n\n    console.log(item);\n});\n```\n\n參考來源:[Javascript Array forEach()中无法return和break，代替方法some()与every()](https://blog.csdn.net/lihefei_coder/article/details/76736296 \"https://blog.csdn.net/lihefei_coder/article/details/76736296\")\n","tags":["javascript"]},{"title":"流程發起權限設定值SQL","url":"/2019/11/11/process-invoke-permission-sql_syntax/","content":"\n```\nSELECT\n    ProcessDefinition.processDefinitionName,\n    PackageInvokeAuthority.userList,\n    PackageInvokeAuthority.organizationUnitList,\n    PackageInvokeAuthority.groupList,\n    PackageInvokeAuthority.functionDefList\nFROM\n    ProcessPackage\n    INNER JOIN ProcessPackageCmItem ON ProcessPackage.containerOID = ProcessPackageCmItem.OID\n    INNER JOIN RedefinableHeader ON ProcessPackage.redefinableHeaderOID = RedefinableHeader.OID\n    INNER JOIN ProcessPackageHeader ON ProcessPackage.headerOID = ProcessPackageHeader.OID\n    INNER JOIN ProcessPackage_ProcessDef ON ProcessPackage.OID = ProcessPackage_ProcessDef.ProcessPackageOID\n    INNER JOIN ProcessDefinition ON ProcessPackage.id = ProcessDefinition.id\n    INNER JOIN ProcessDefinitionHeader ON ProcessDefinition.headerOID = ProcessDefinitionHeader.OID\n    LEFT JOIN PackageInvokeAuthority ON ProcessPackage.packageInvokeAuthorityOID = PackageInvokeAuthority.OID\nWHERE\n    ProcessDefinition.OID = ProcessPackage_ProcessDef.ProcessDefinitionOID\n    AND ProcessPackageCmItem.lastVersion = RedefinableHeader.version\n    AND validTo >= GETDATE()\n    AND RedefinableHeader.publicationStatus = 'RELEASED'\n    AND processDefinitionName = '＜流程名稱＞'\n```\n","tags":["sql","easyflow gp"]},{"title":"C#機敏資訊放到C++ Dll以避免被直接反組譯","url":"/2019/11/08/csharp-sensitive-data-protection/","content":"說明:  \n.Net Framework因為其特性,  \n編譯的執行檔或Dll有很多工具能反組譯,  \n機敏資訊如連線字串等如果直接寫在程式碼中  \n容易被取得造成資安問題。  \n但像C++/Delphi等語言(非託管)是直接編譯成機器碼,  \n反組譯難度較高,  \n所以如果將機敏資訊放在非託管Dll中,  \n反組譯工具就看不出內容而能提升安全性。  \n  \n做法:  \n1)Visual Studio開啟專案→Visual C++→Win32主控台應用程式→應用程式類型:DLL  \n  \n2)在cpp原始檔加上以下敘述,然後編譯成Dll\n\n```\n#include \"stdafx.h\"\n#include \"COMDEF.H\"\n\nextern \"C\" __declspec(dllexport) BSTR getConnectionString(BSTR hash) {\n    if (wcscmp(hash, L\"＜驗證字串＞\") == 0) {\n        return ::SysAllocString(L\"＜連線字串＞\");     \n    }\n    else {\n        return ::SysAllocString(L\"error!\");\n    }\n}\n```\n\n3)引用的C#專案加上以下敘述\n\n```\nusing System;\nusing System.Runtime.InteropServices;\n\nnamespace 專案名稱 {\n    class Program {\n\n        [DllImport(@\"＜Dll完整路徑＞\", CallingConvention = CallingConvention.Cdecl)]\n        [return: MarshalAs(UnmanagedType.BStr)]\n        private static extern string getConnectionString([MarshalAs(UnmanagedType.BStr)]string hash);\n        [DllImport(@\"＜Dll完整路徑＞\", CallingConvention = CallingConvention.Cdecl)]\n        [return: MarshalAs(UnmanagedType.BStr)]\n        private static extern string getConnectionString([MarshalAs(UnmanagedType.BStr)]string hash);\n        [return: MarshalAs(UnmanagedType.BStr)]\n        private static extern string getConnectionString([MarshalAs(UnmanagedType.BStr)]string hash);\n\n        static void Main(string[] args) {\n            var connStr = getConnectionString(\"＜驗證字串＞\");\n        }\n    }\n}\n```\n\n```\n※該Dll的屬性→建置動作必須是\"內容\",不能以ILMerge等套件編譯成同一個執行檔,\n不然會找不到。\n```\n\n4)用反組譯工具來查看,看不到Dll存放的連線字串。\n但是最新的反組譯工具如dnSpy還是能執行以取得字串,\n要再提升安全性可能要使用其他工具將.Net程式編譯成機器碼。\n\n[![](Image_20191108155612.png)](Image_20191108155612.png )\n\n","tags":["c#"]},{"title":"全新樹莓派4安裝","url":"/2019/11/05/raspberrypi4-clean_install/","content":"\n# 下載映像檔(本次下載基本桌面版)\n\n[https://www.raspberrypi.org/downloads/raspbian/](https://www.raspberrypi.org/downloads/raspbian/ \"https://www.raspberrypi.org/downloads/raspbian/\")\n\n# 下載燒錄軟體並寫入SD卡\n\n[https://www.balena.io/etcher/](https://www.raspberrypi.org/downloads/raspbian/ \"https://www.raspberrypi.org/downloads/raspbian/\")\n\n# 軟體更新\n\n$ sudo apt update\n$ sudo apt full-upgrade  \n$ sudo shutdown - r now\n\n# HDMI無音效\n\n[https://www.raspberrypi.org/documentation/configuration/audio-config.md](https://www.raspberrypi.org/documentation/configuration/audio-config.md \"https://www.raspberrypi.org/documentation/configuration/audio-config.md\")\n\n修改/boot/config.txt,取消hdmi\\_drive=2的註解,重新開機  \n  \n# 修改GPU\n\n$ sudo raspi-config\n\n選擇Advanced Options→Memory Split→128  \n  \n# 修改解析度\n\n$ sudo raspi-config\n\n選擇Advanced Options→選擇Resolution→選擇適合的解析度→Ok→Finish→Reboot  \n\n# 重啟後如果畫面會自動縮小:  \n左下角選單→偏好設定→Screen Configuration→右鍵選擇適合的解析度→套用  \n  \n# 修改鍵盤佈局\n\n$ sudo raspi-config\n\n選擇Localisation Options→選擇Change Keyboard Layout→選擇一般104鍵盤→按下OK→選擇close\n\n# 修改Wifi頻段\n\n$ sudo raspi-config\n\n選擇Localisation Options→選擇Change Wi-fi Country→選擇Taiwan→按下OK→選擇close\n\n# 設定系統自動對時\n\n$ sudo timedatectl set-ntp yes  \n\n# 安裝遠端桌面\n\n$ sudo apt -y install xrdp\n\n# 中文輸入法(預設已安裝)\n\n$ sudo apt install fcitx\n\n# 中文輸入法(倉頡)  \n$ sudo apt install fcitx-table-cangjie3\n\n# 中文輸入法(新酷音,預設已安裝)  \n$ sudo apt install fcitx-chewing\n\n# 安裝完中文輸入法要重啟  \n$ sudo reboot\n\n# 修改輸入法設定  \n 選擇全域設定→顯示進階選項→外觀  \n →只有預編輯字串時不顯示輸入視窗→打勾  \n →只有一個候選詞和預編輯字串時不顯示輸入視窗→打勾  \n  \n# 安裝Samba  \n$ sudo apt install samba  \n  \n# 加入pi到sambashare組  \n$ sudo usermod -a -G sambashare pi  \n  \n# 修改pi的Samba密碼  \n$ sudo pdbedit -a -u pi  \n  \n# 修改/etc/samba/smb.conf  \n[global]  \n   follow symlinks = yes  \n   wide links = yes  \n   unix extensions = no  \n   strict locking = no  \n  \n# 加入到/etc/samba/smb.conf  \n[pi]  \n  comment = pi's home  \n  path = /home/pi  \n  read only = no  \n  guest ok = no  \n  browseable = yes  \n  create mask = 0644  \n  directory mask = 0755  \n  \n參考來源:  \n[raspberry-pi-samba-setup-tutorial](https://blog.gtwang.org/iot/raspberry-pi/raspberry-pi-samba-setup-tutorial/?source=post_page-----b6a23c06c5a---------------------- \"https://blog.gtwang.org/iot/raspberry-pi/raspberry-pi-samba-setup-tutorial/?source=post_page-----b6a23c06c5a----------------------\")\n","tags":["raspberry pi 4"]},{"title":"今天是[程式設計師節]!!","url":"/2019/10/24/programmers-day/","content":"\n```\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n```\n","tags":["happy1024!"]},{"title":"EasyFlow不斷發通知信","url":"/2019/10/23/easyflow_gp5_6-keep_sending-notification-letter/","content":"狀況:  \n 1.使用者反應一直收到通知信,但流程已完成逾5日。  \n 2.發現Table:JMS\\_MESSAGES筆數不斷增多,  \n   \n   \n 處理:  \n 因為有流程通知關卡是寄送全集團所有成員,  \n 就會容易導致此現象;  \n 先建立1位虛擬使用者,  \n 並將其信箱改成集團群組信箱,  \n 再將通知者改為此使用者即可。\n","tags":["easyflow gp","踩坑"]},{"title":"ASP.NET網站瓶頸測量","url":"/2019/10/04/aspnet-website-bottleneck-measurement/","content":"1.測量對象主機需安裝[IIS Metabase 及 IIS 6 設定相容性]功能。  \n\n[![](att2.png)](att2.png )\n\n  \n  \n2.複製Visual Studio Profiler安裝檔到測量對象主機並安裝。  \n(在Visual Studio安裝路徑\\Team Tools\\Performance Tools\\Setups)  \n\n[![](att3.png)](att3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\n3.執行VSPerfASPNetCmd,依照指示執行之。  \n(選項可參照:[https://docs.microsoft.com/zh-tw/visualstudio/profiling/vsperfaspnetcmd?view=vs-2015](https://docs.microsoft.com/zh-tw/visualstudio/profiling/vsperfaspnetcmd?view=vs-2015 \"https://docs.microsoft.com/zh-tw/visualstudio/profiling/vsperfaspnetcmd?view=vs-2015\"))  \n※發現此動作會將該台IIS全部應用程式集區'停止',最好在另外的測試區IIS執行。\n\n4.將產生的vspx檔用Visual Studio開啟即可看到分析結果。  \n\n[![](Image_20191004095920.png)](Image_20191004095920.png )\n\n\\*2019/10/07更新  \n發現Prefix更好用,可以即時監控每個連線的.Net函式及DB連線耗時。  \n參考來源:[http://kevintsengtw.blogspot.com/2016/04/profile-aspnet-application-prefix.html](http://kevintsengtw.blogspot.com/2016/04/profile-aspnet-application-prefix.html \"http://kevintsengtw.blogspot.com/2016/04/profile-aspnet-application-prefix.html\")  \n  \n另外如果發現瓶頸都在DB,亦可使用SQL Server Profiler錄製耗時較多的SQL。  \n1.一般>使用範本:TSQL\\_Duration。  \n2.事件選取範圍>資料行篩選>Duration大於等於x亳秒。\n\n","tags":["visual studio","internet information server","asp.net"]},{"title":"工作排程器在前景/背景執行","url":"/2019/10/04/task_scheduler-foreground-background-difference/","content":"[只有使用者登入時才執行]→適用於與人交互的程式如Outlook,會顯示在畫面上可操作。\n\n[不論使用者登入與否均執行]→適用於不需交互的程式如磁碟重組,會在背景執行。(建議使用NT AUTHORITY\\SYSTEM帳號才有足夠權限。)\n\n[![](Image_20191004092956.png)](Image_20191004092956.png )\n\n","tags":["windows"]},{"title":"組織異動相關語法","url":"/2019/09/19/organization-reorg-sql_syntax/","content":"\n```\nDECLARE @action nvarchar(50) = 'CREATE'; --CREATE=新部門設主部門,保留原部門(主部門代號異動或兼任)/MODIFY=主部門異動(調部門)\nDECLARE @userId nvarchar(100) = '{工號}';\nDECLARE @newMainUnitId nvarchar(100) = '{異動部門代號}';\nDECLARE @userOID char(32) = (SELECT OID FROM Users WHERE id = @userId);\nDECLARE @newMainUnitOID char(32) = (SELECT OID FROM OrganizationUnit WHERE id = @newMainUnitId);\nDECLARE @approvalLevelOID char(32) = (SELECT approvalLevelOID FROM Functions WHERE isMain = 1 AND occupantOID = (SELECT OID FROM Users WHERE id = @userId));\nDECLARE @definitionOID char(32) = (SELECT definitionOID FROM Functions WHERE isMain = 1 AND occupantOID = (SELECT OID FROM Users WHERE id = @userId));\n\n--檢查參數\nIF @userOID IS NULL\nBEGIN\n    THROW 50000, '@userId無對應OID' ,1\nEND\n\nIF @newMainUnitOID IS NULL\nBEGIN\n    THROW 50000, '@newMainUnitId無對應OID' ,1\nEND\n\nIF @action NOT IN ('CREATE', 'MODIFY')\nBEGIN\n    THROW 50000, '@action只能是(CREATE/MODIFY)其中之一' ,1\nEND\n\n--部門代號已存在則設為主部門\nDECLARE @existingUnitOID char(32) = (SELECT OID FROM OrganizationUnit WHERE OID IN (SELECT organizationUnitOID FROM Functions WHERE occupantOID = @userOID) AND id = @newMainUnitId);\nIF @existingUnitOID IS NOT NULL\nBEGIN\n    UPDATE Functions SET isMain = 0, objectVersion = objectVersion + 1 WHERE isMain = 1 AND occupantOID = @userOID;\n    UPDATE Functions SET isMain = 1, objectVersion = objectVersion + 1 WHERE occupantOID = @userOID AND organizationUnitOID = @existingUnitOID;\n    RETURN\nEND\nELSE\nBEGIN\n    IF @action = 'CREATE'\n    BEGIN\n        --主部門先改成非主部門\n        UPDATE Functions SET isMain = 0, objectVersion = objectVersion + 1 WHERE isMain = 1 AND occupantOID = @userOID;\n        --新增主部門\n        INSERT INTO Functions VALUES (REPLACE(LOWER(NEWID()),'-',''), 1, @approvalLevelOID, @definitionOID, @userOID, @newMainUnitOID, NULL, 1);\n        RETURN\n    END\n    ELSE\n    BEGIN\n        --修改主部門        \n        UPDATE Functions SET organizationUnitOID = @newMainUnitOID, objectVersion = objectVersion + 1, specifiedManagerOID = NULL WHERE isMain = 1 AND occupantOID = @userOID;\n        RETURN\n    END\nEND\n```\n","tags":["sql","easyflow gp"]},{"title":"流程定義相關語法","url":"/2019/09/18/process-definition-related-sql_syntax/","content":"\n```\n/**流程序號*/  \nDECLARE @SerialNumber nvarchar(50) = 'PKG1564733072307100000069';  \n  \n/**以序號找到流程定義OID*/  \nDECLARE @ProcessDefinitionOID char(32) = (  \n    SELECT ProcessDefinitionOID FROM ProcessPackage_ProcessDef WHERE ProcessPackageOID = (  \n        SELECT processPackageOID FROM ProcessContext WHERE containerOID = (  \n            SELECT OID FROM ProcessInstance WHERE serialNumber = @SerialNumber  \n        )  \n    )  \n);  \n  \n/**列出流程定義所有活動*/  \nSELECT * FROM ActivityDefinition WHERE containerOID = @ProcessDefinitionOID;  \n  \n  \n/**以序號找到流程序號OID*/  \nDECLARE @ProcessInstanceOID char(32) = (SELECT OID FROM ProcessInstance WHERE serialNumber = @SerialNumber);  \n  \n  \n/**列出流程設定*/  \n/*  \n活動定義(ActivityDefinition):新流程會套用  \n活動實體(ParticipantActivityInstance):進行中流程設定  \n(如果要修改則上述兩個table都要修改,不然會有異常)  \n加簽(addingActivityAuthority):1=前一活動/2=後一活動/3=前後/0=不允  \n退回(ableToAskActivityReexecute):3=1.直接送回要求退件者/2=2.按流程定義送回要求退件者/0=3.不允許退件/4=允許1、2。預設直接送回要求退件者/1=允許1、2。預設按流程定義送回要求退件者  \n轉他人處理(reassignable):1=允許/0=不允許  \n取回重辦(regainable):1=允許/0=不允許(僅ActivityDefinition有)  \n批次簽核(batchPerformable):1=允許/0=不允許  \n活動類型(performType):NORMAL/NOTICE/EXECUTION  \n參與者(performerIds):如果有多位以逗號區隔,只能寫入同一版流程定義的參與者定義ID(ParticipantDefinition),不然會異常無法派送(僅ActivityDefinition有)  \n*/  \nSELECT OID, activityDefinitionName, addingActivityAuthority, ableToAskActivityReexecute, reassignable, regainable, batchPerformable, performType, performerIds FROM ActivityDefinition WHERE containerOID = @ProcessDefinitionOID;  \nSELECT OID, addingActivityAuthority, ableToAskActivityReexecute, reassignable, batchPerformable, performType FROM ParticipantActivityInstance WHERE containerOID = @ProcessInstanceOID;  \n  \n  \n/**活動連接阜設定:joinType=合併限制條件/splitType=分流限制條件*/  \nSELECT joinType, splitType FROM TransitionRestriction where containerOID = '{特定關卡的ActivityDefinition.OID}';\n  \n  \n/**\n關卡間的每條路徑,其名稱/型別/條件運算式\n路徑定義(TransitionDefinition):即關卡間的每條路徑\n條件定義(ConditionDefinition):路徑分支的條件\n型別(conditionType):CONDITION=條件型別/OTHERWISE=否則型別/EXCEPTION=例外條件型別/DEFAULTEXCEPTION=預設例外型別\n運算式(content):當conditionType=CONDITION則有值,其他型別為空字串\n*/\nSELECT id, transitionDefinitionName, conditionOID, conditionType, content\nFROM TransitionDefinition\nLEFT JOIN ConditionDefinition\nON TransitionDefinition.conditionOID = ConditionDefinition.OID\nWHERE containerOID = @ProcessDefinitionOID;\n  \n  \n/**  \n核決權限表  \n參考活動ID(referActivityId)  \n單位主管核定(isManagerDecide)\n*/\nSELECT activityDefinitionName, referActivityId, isManagerDecide, decisionRuleListOID\nFROM ActivityDefinition\nINNER JOIN DecisionRuleList\nON ActivityDefinition.decisionRuleListOID = DecisionRuleList.OID\nWHERE containerOID = @ProcessDefinitionOID;  \n  \n  \n/**核決權限表規則  \n運算式(content)  \n判斷順序(showIndex):逐筆判斷的順位,由小到大\n*/  \nSELECT content, showIndex FROM DecisionRuleList  \nINNER JOIN DecisionCondition ON DecisionRuleList.OID = DecisionCondition.containerOID  \nWHERE DecisionRuleList.OID = '{特定核決權限關卡的ActivityDefinition.decisionRuleListOID}';\n```\n","tags":["sql","easyflow gp"]},{"title":"核決權限表設定注意事項","url":"/2019/09/18/easyflow_gp5_6-decision_list-note/","content":"1.單位主管核定  \n勾選時表示就算參與者的主管層級已超過符合條件的層級也要簽核,  \n如主管是部級,但符合條件是課級,仍會送簽。  \n\n[![](att1.png)](att1.png )\n\n  \n  \n  \n  \n  \n  \n2.核決規則  \n1)必須涵蓋所有條件,不然會派送失敗。→可以加一個1==1的預設條件避免失敗。  \n2)由上向下逐一判斷,如果有相同條件則會先進入最接近上面的第1個條件。  \n3)打✓的右邊層級不管有勾沒勾都會全部跑到不會跳過。\n  \n\n|  |\n| --- |\n|  |\n|  |\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n※如果課級部門主管是處級單位成員,會造成系統誤判,跑到課級部門主管卻會為顯示處級,  \n所以會跳過部級主管,停留在處級部門主管(如下圖)  \n有調動的行為要檢查原單位是否已調離  \n\n[![](Image_20191223095948.png)](Image_20191223095948.png )\n\n  \n\n","tags":["easyflow gp"]},{"title":"更新流程有效期間","url":"/2019/09/11/update-process-valid-period-sql_syntax/","content":"\n```\nUPDATE ProcessDefinitionHeader  \nSET validTo = '9999-12-31 23:59:59.000'  \n,objectVersion = objectVersion + 1  \nWHERE OID IN (  \n    SELECT  \n        ProcessDefinitionHeader.OID  \n    FROM ProcessDefinition  \n    INNER JOIN ProcessDefinitionHeader  \n        ON ProcessDefinition.headerOID = ProcessDefinitionHeader.OID  \n    INNER JOIN ProcessPackage_ProcessDef  \n        ON ProcessDefinition.OID = ProcessPackage_ProcessDef.ProcessDefinitionOID  \n    INNER JOIN ProcessPackage  \n        ON ProcessPackage_ProcessDef.ProcessPackageOID = ProcessPackage.OID  \n    INNER JOIN RedefinableHeader  \n        ON ProcessPackage.redefinableHeaderOID = RedefinableHeader.OID  \n    INNER JOIN ProcessPackageCmItem  \n        ON ProcessPackage.id = ProcessPackageCmItem.id  \n        AND RedefinableHeader.version = ProcessPackageCmItem.lastVersion  \n    WHERE 1 = 1  \n    AND validTo >= GETDATE() /**不更新舊流程*/  \n    AND RedefinableHeader.publicationStatus = 'RELEASED' /**只更新RELEASE的*/  \n);\n```\n\n建議也可將表單截止有效日欄位設為NULL以避免突然找不到表單的問題。\n\n```\nUPDATE FormDefinition SET validTo = NULL WHERE validTo IS NOT NULL\n```\n","tags":["sql","easyflow gp"]},{"title":"優化主機效能設定","url":"/2019/09/06/network_card-speedup-setting/","content":"網卡進階建議選項:  \nLarge Send Offload V2 (IPv4)→Disabled  \nLarge Send Offload V2 (IPv6)→Disabled  \nIPv4 TSO Offload→Disabled  \nIPv4 Checksum Offload→Disabled  \nOffload IP Options→Disabled  \nOffload tagged traffic→Disabled  \nOffload TCP Options→Disabled  \nTCP Checksum Offload (IPv4)→Disabled  \nTCP Checksum Offload (IPv6)→Disabled  \nUDP Checksum Offload (IPv4)→Disabled  \nUDP Checksum Offload (IPv6)→Disabled  \n如果有的話  \nRecv Segment Coalescing(IPV4)→Disabled  \nRecv Segment Coalescing(IPV6)→Disabled  \nLarge Receive Offload(IPV4)→Disabled  \nLarge Receive Offload(IPV6)→Disabled  \n  \n參考來源:  \n [https://support.rackspace.com/how-to/disabling-tcp-offloading-in-windows-server-2012/](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n [http://lifeofageekadmin.com/network-performance-vmxnet3-windows-server-2012-r2/](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n [http://www.peerwisdom.org/2013/04/03/large-send-offload-and-network-performance/](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n   \n  \n   \n設定電源管理:平衡→高效能  \n   \n 參考來源:  \n [https://codeday.me/bug/20181119/396266.html](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n [https://dotblogs.com.tw/jamesfu/2012/12/18/powercfg](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n [https://www.netadmin.com.tw/netadmin/zh-tw/technology/A034BD3916454F388D9F03C9F1190FF3?page=3](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n"},{"title":"dnSpy偵錯有pdb檔的dll(ASP.NET WebForm)","url":"/2019/09/05/dnspy-debug-dll-with-pdb/","content":"1.Debug=>Attach to process...=>找到w3wp.exe=>Attach  \n(IIS的執行緒,因為開發機的IIS沒連線會自己終止,如果沒有就開啟首頁讓IIS啟動)  \n\n[![](att1.png)](att1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.Debug=>Windows=>Modules=>Search=>輸入要偵錯的dll名稱,路徑會是＜暫存ASP.NET目錄＞\\＜網站名稱\\_資料夾名稱＞\\＜亂數名稱目錄...＞\\dll名稱  \n\n[![](att2.png)](att2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n3.雙點開啟該dll,設中斷點,再進行相關動作即會進入中斷點  \n\n[![](att3.png)](att3.png )\n\n  \n\n","tags":["visual studio","web form","asp.net"]},{"title":"EasyFlow取得附件實體路徑程式碼(C#/VB6=ReportingService用)","url":"/2019/08/30/easyflow_gp5_6-get-attachment-path/","content":"\nC#版\n\n```\nvar physicalName = \"42f5a298x16cddb6dd3ex6a19\";\nvar extension = \"jpg\";\nvar docServerRootPath = \"\";\nvar mod = physicalName.Length % 2;\nvar locationTempString = physicalName.Substring(2, physicalName.Length - 4 + mod);\n\nfor (var currentIndex = locationTempString.Length - 1; currentIndex >= mod; currentIndex -= 2) {\n    var folder = locationTempString.Substring(currentIndex - 1, 2);\n    folders.Add(folder);\n}\n\nvar directoryPath = string.Join(@\"\\\", folders);\nvar physicalFilePath = docServerRootPath + @\"\\\" + directoryPath + @\"\\\" + physicalName + \".\" + extension;\n```\n\nVB6版\n\n```\nDim physicalName As String\nphysicalName = \"42f5a298x16cddb6dd3ex6a19\"\n\nDim extension As String\nextension = \"jpg\"\n\nDim docServerRootPath As String\ndocServerRootPath = \"\";\n\nDim folders() As String\nReDim Preserve folders(0)\n\nDim modNumber As Integer\nmodNumber = Len(physicalName) Mod 2\n\nDim locationTempString As String\nlocationTempString = Mid(physicalName, 3, Len(physicalName) - 4 + modNumber)\n\nDim currentIndex As Integer\nDim folderIndex As Integer\nfolderIndex = 0\n\nFor currentIndex = Len(locationTempString) - 1 To currentIndex > modNumber Step -2\n    Dim folder As String\n    folder = Mid(locationTempString, currentIndex, 2)\n\n    folders(folderIndex) = folder\n    folderIndex = folderIndex + 1\n\n    ReDim Preserve folders(folderIndex)\nNext\n\nDim directoryPath As String\ndirectoryPath = Join(folders, \"\\\")\n\nDim physicalFilePath As String\nphysicalFilePath = docServerRootPath + \"\\\" + directoryPath + physicalName + \".\" + extension 'folder陣列在Join後最後會多一個\\符號,所以directoryPath最後不用再加上\\符號\n```\n\n\n\n```\n\n```\n","tags":["easyflow gp"]},{"title":"ReportingService已更新SQL但報表預覽異常","url":"/2019/08/28/ssrs-updated-but-review-error/","content":"情況:  \nSQL已修改但未反應在預覽的欄位,  \n而且有錯誤訊息(如下圖)  \n[![](Image_20190828141703.png)](Image_20190828141703.png )  \n  \n解決方法:  \n刪除<報表名稱>.rdl.data檔即可。  \n  \n參考:  \n[SQL Server Reporting Studio report showing “ERROR#” or invalid data type error](https://stackoverflow.com/a/21430840 \"https://stackoverflow.com/a/21430840\")  \n\n[![](Image_20190828143405.png)](Image_20190828143405.png )\n\n  \n\n","tags":["ssrs"]},{"title":"批次更新表單欄位SQL","url":"/2019/08/27/batch-update-form-field-sql_syntax/","content":"\n```\nDECLARE @oldValue NVARCHAR(255) = '{舊參與者工號}'; --欄位舊值\nDECLARE @newValue NVARCHAR(255) = '{新參與者工號}'; --欄位新值\nDECLARE @processDefId NVARCHAR(255) = 'PKGPROCESS_xxxxxx'; --流程定義代號\nUPDATE FormInstance\n\nSET fieldValues = REPLACE(CAST(fieldValues AS NVARCHAR(MAX)), @oldValue, @newValue)\n--,maskFieldValues = REPLACE(CAST(maskFieldValues AS NVARCHAR(MAX)), @oldValue, @newValue) --如果是Tiptop流程的話\n,objectVersion = objectVersion + 1\nWHERE OID IN ( \nSELECT FormInstance.OID\nFROM ProcessInstance\nINNER JOIN LocalRelevantData ON LocalRelevantData.containerOID = ProcessInstance.contextOID\nINNER JOIN FormInstance ON FormInstance.OID = LocalRelevantData.valueOID\nWHERE ProcessInstance.processDefinitionId = @processDefId\nAND ProcessInstance.currentState IN (1,2) --進行中\nAND FormInstance.fieldValues LIKE '%' + @oldValue + '%'\n);\n```\n","tags":["sql","easyflow gp"]},{"title":"MSSQL查詢AD群組使用者清單","url":"/2019/08/27/mssql-query-active_directory-group-user/","content":"\n```\nDECLARE @statment nvarchar(max) \n= N'select ROW_NUMBER() OVER (ORDER BY AD.SAMAccountName) AS RowNumber, AD.SAMAccountName,AD.mail, AD.name, AD.distinguishedName from openquery(ADSI,''select SAMAccountName, Name, mail, distinguishedName from ''''LDAP://OU=<公司名稱>,DC=<公司名稱>,DC=com'''' WHERE memberof=''''CN='\n + @GroupName + ',OU=群組帳號,OU=USUN,DC=<公司名稱>,DC=com'''''') AS AD ORDER BY AD.SAMAccountName'; \nEXEC sp_executesql @statment;\n```\n","tags":["sql server"]},{"title":"MSSQL Server新增連結伺服器以取得網域資訊","url":"/2019/08/08/mssql-link-to-ldap-server/","content":"1.連結的伺服器屬性  \n\n[![](att1.png)](att1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n[![](att2.png)](att2.png )  \n  \n[![](att3.png)](att3.png )  \n  \n  \n2.如果不能查詢,再進行以下步驟\n\n```\n/**預設SQL Server不允許OpenQuery,所以要先啟用系統預儲程式進階選項*/\nsp_configure 'show advanced options', 1   \nreconfigure with override   \n\n/**再啟用特定分散式查詢選項*/\nsp_configure 'Ad Hoc Distributed Queries', 1   \nreconfigure\n```\n\n","tags":["sql server"]},{"title":"在特定上級單位與下屬單位之間增加中間簽核人員(非加簽)","url":"/2019/08/06/easyflow_gp5_6-add-intermediate-activity/","content":"\n狀況:\n\n在某些上級單位(如:部)與其下屬單位(如:課)之間需增加一位中間簽核人員,\n\n因為是固定人員,主管不想每次都加簽關卡。\n\n[![](Image_20191101171955.png)](Image_20191101171955.png )\n\n  \n解法:  \n1.參與者關卡  \n  \n\n[![](Image_20191101172646.png)](Image_20191101172646.png )\n\n處理人主管副手:將中間簽核人員設成前一關卡參與者的[直屬主管]。\n\n處理人主管:將上級單位主管設成前一關卡參與者的[部門主管],\n\n並設定\"與前一關同一簽核者則跳過\"。\n\n即可適用於一般及特定單位。\n\n  \n  \n  \n2.核決權限關卡  \n  \n\n2-1.設定上級單位主管關係人為中間簽核人員。  \n(可新增相同關係多位人員,會依照新增順序由上至下簽核)\n\n[![](Image_20191101173214.png)](Image_20191101173214.png )\n\n2-2.核決權限關卡設定[前置活動關係人], 選擇剛才設定的關係名稱。  \n  \n\n[![](Image_20191101173159.png)](Image_20191101173159.png )\n\n2-3.上級單位主管前會自動新增簽核關卡。\n\n[![](att3.png)](att3.png )\n\n  \n\n","tags":["easyflow gp"]},{"title":"修改附件檔名SQL","url":"/2019/08/05/modify-attachment-file_name-sql_syntax/","content":"\n```\n/**修改附件檔名SQL*/   \n  \n/**第1步.找出表單的XML(如果是Tiptop流程,連maskFieldValues也要一併修改)*/   \n SELECT FormInstance.OID,fieldValues   \n   FROM ProcessInstance   \n   JOIN LocalRelevantData ON contextOID = containerOID   \n   JOIN FormInstance ON valueOID = FormInstance.OID   \n WHERE ProcessInstance.serialNumber = '(要修改附件檔名的流程序號)'   \n  \n/**第2步.修改XML內容*/   \n UPDATE FormInstance   \n SET fieldValues = N'(修改附件檔名後的XML)'  \n ,objectVersion = objectVersion + 1   \n WHERE OID = '(第1步的FormInstance.OID)'   \n  \n/**第3步.修改附件檔名(修改此處並不會影響附件名稱,但為了資料完整性所以一併修改)*/   \n UPDATE NoCmDocument   \n SET logicalName = '(附件修改後檔名)'  \n ,objectVersion = objectVersion + 1   \n WHERE OID = '(第2步的附件OID)'\n```\n","tags":["sql","easyflow gp"]},{"title":"取得線上全部流程序號名稱","url":"/2019/07/17/get-all-process-serial_number/","content":"\n```\nSELECT   \n     ProcessDefinition.id,   \n     ProcessDefinition.processDefinitionName   \n FROM   \n     ProcessPackage   \n     INNER JOIN ProcessPackageCmItem ON ProcessPackage.containerOID = ProcessPackageCmItem.OID   \n     INNER JOIN RedefinableHeader ON ProcessPackage.redefinableHeaderOID = RedefinableHeader.OID   \n     INNER JOIN ProcessPackageHeader ON ProcessPackage.headerOID = ProcessPackageHeader.OID   \n     INNER JOIN ProcessPackage_ProcessDef ON ProcessPackage.OID = ProcessPackage_ProcessDef.ProcessPackageOID   \n     INNER JOIN ProcessDefinition ON ProcessPackage.id = ProcessDefinition.id   \n     INNER JOIN ProcessDefinitionHeader ON ProcessDefinition.headerOID = ProcessDefinitionHeader.OID   \n WHERE   \n     ProcessDefinition.OID = ProcessPackage_ProcessDef.ProcessDefinitionOID   \n     AND ProcessPackageCmItem.lastVersion = RedefinableHeader.version   \n     AND validTo >= GETDATE()   \n     AND RedefinableHeader.publicationStatus = 'RELEASED'\n```\n","tags":["sql","easyflow gp"]},{"title":"流程設計師.條件運算式的反向邏輯","url":"/2019/06/27/process_designer-reverse-logical-conditional/","content":"只有一個條件  \nnot (Test001.TextBox1==\"\")  \n  \n多個條件  \nTest001.TextBox1==\"\" and not (Test001.TextBox2==\"\")  \n","tags":["easyflow gp"]},{"title":"以web service起新流程時內容需換行的注意事項","url":"/2019/06/24/easyflow_gp5_6-web_service-newline-notice/","content":"1.情景:  \n表單有TextArea控制項而且內容需換行,在呼叫invokeProcess起新流程時。  \n  \n2.測試:  \n如果是獨立的TexArea控制項  \n如:＜TextArea id=\"TextArea\" dataType=\"java.lang.String\" perDataProId=\"\"＞(1)TTTTT\\_換行\\_(2)EEEEE\\_換行\\_(3)XXXXX\\_換行\\_(4)TTTTT＜/TextArea＞  \n(1)**＆lt;br /＆gt;**→不會換行,直接變成純文字＜br /＞  \n(2)**＆lt;br＆gt;**→不會換行,直接變成純文字＜br＞  \n(3)**\\n**→不會換行,直接變成純文字\\n  \n(4)**＆#xA;**→會換行  \n  \n如果是Grid內的與TexArea控制項連結的欄位  \n如:＜Grid id=\"Grid\"＞  \n   ＜records＞  \n    ＜record id=\"Grid\"＞  \n     ＜item id=\"TextArea\" dataType=\"java.lang.String\" perDataProId=\"\"＞(1)TTTTT\\_換行\\_(2)EEEEE\\_換行\\_(3)XXXXX\\_換行\\_(4)TTTTT＜/item＞  \n    ＜/record＞  \n   ＜/records＞  \n  ＜/Grid＞  \n(1)**＆lt;br /＆gt;**→Grid欄位換行處會多一空白,點擊時顯示到TextArea也會換行(EasyFlow內部的標準做法)  \n\n[![](Image_20190624124933.png)](Image_20190624124933.png )\n\n(2)**＆lt;br＆gt;**→Grid欄位顯示換行,但點擊時顯示到TextArea卻是變成純文字＜br＞而不會換行  \n(3)**\\n**→Grid欄位換行處會多一空白,點擊時顯示到TextArea也會換行  \n(4)**＆#xA;**→Grid資料完全無法載入顯示  \n  \n3.結論:  \n獨立的TexArea控制項需使用**＆#xA;**換行;如果是Grid內的與TexArea控制項連結的欄位則使用**＆lt;br /＆gt;**換行。  \n(本文是全形,實際是半形)\n\n"},{"title":"關於流程設計師-invoke關卡-存入表單的一些小地方","url":"/2019/06/21/process_designer-invoke-level-notice/","content":"invoke關卡-session bean的變數名稱其實能跟流程變數的名稱一樣  \n\n[![](Image_20190621091619.png)](Image_20190621091619.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n但是如果相反地,流程變數名稱改用鼎新提供的pProcessInstanceSN/pSeparateByVerNo,  \n反而無法存入表單(暫不知原因為何)\n\n","tags":["easyflow gp"]},{"title":"修改表單設計師/設定輔助格線/格線大小的預設值","url":"/2019/06/05/modify-form_designer-default-value/","content":"檔案路徑:[EasyFlow系統目錄]\\server\\default\\deploy\\NaNaWeb.war\\WMS\\FormDesigner\\FormDesignerMain.jsp  \n  \n編輯內容如下:  \n\n```\ngVarParent.txtQueryElement.dblclick(function () {\n    this.value = \"\";\n});\n\n//產生被選取到的元件ID清單.\n$(\"#btn-selected-elements\").click(function () {\n    showSelectedElementIdsDialog();\n});\n\n//----------加上這段script----------\n//在IE直接執行無反應,必須異步執行\nsetTimeout(function () {\n    gVarParent.formBuilder.gridHeight = 10;\n    gVarParent.formBuilder.gridWidth = 10;\n    gVarParent.currContent.gVar.grid.width(1360);\n    gVarParent.currContent.gVar.grid.height(1520);\n    gVarParent.formBuilder.drawLayoutGrid(gVarParent.currContent, 2);\n}, 500);\n//----------加上這段script----------\n```\n","tags":["easyflow gp"]},{"title":"避免EasyFlow測試區跑流程會通知使用者造成不必要的誤解","url":"/2019/06/04/avoid-easyflow_gp5_6-test_mode-notice/","content":"\n```\nUPDATE [測試區DB].dbo.Users   \n SET mailAddress = '' /**或改成開發者e-mail帳號*/   \n ,objectVersion = objectVersion + 1   \n WHERE id <> 'administrator';\n```\n","tags":["sql","easyflow gp"]},{"title":"修正IE開啟EasyFlow GP的文件模式","url":"/2019/06/04/correct-internet_explorer-document-mode/","content":"【修正】   \n [EasyFlow目錄]\\jboss-4.2.3.GA\\server\\default\\deploy\\NaNaWeb.war\\WMS\\Templates\\Template.jsp   \n   \n 原設定\n\n[![](Image+002.png)](Image+002.png )\n\n  \n  \n\n修改為\n\n[![](Image+001.png)](Image+001.png )\n\n【作用】   \n 舊設定是不管用哪版IE開啟都只用IE8模擬,   \n 這樣會造成有些新版IE才有的Javascript method跟開發者工具的function無法使用。   \n而新設定是告訴IE用本身版本瀏覽, 不需模擬成IE8,   \n (參考: [https://msdn.microsoft.com/en-us/library/ff955275(v=vs.85).aspx#)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n 因為BPM可以在Chrome上執行, 所以用IE11跑反而不用被IE8綁手綁腳。\n\n","tags":["easyflow gp"]},{"title":"EasyFlow與Tiptop整合設定存放處","url":"/2019/05/31/easyflow_gp5_6-tiptop-integrated-setting-position/","content":"\n```\nUPDATE [測試區DB].dbo.TiptopModel   \n SET mappingSet = (SELECT mappingSet FROM [正式區DB].dbo.TiptopModel);   \n /**這table居然在鼎新DB文件裡沒有…*/\n```\n","tags":["sql","easyflow gp"]},{"title":"修正線上進行中的舊表單Js程式","url":"/2019/05/28/correct-running-form-script/","content":"  \n\n1.      用[程式片段]定位線上進行中所有的表單版號\n\n```\n DECLARE @CODE NVARCHAR(4000) = '[要尋找的程式片段]';   \n  \n SELECT   \n     DISTINCT FormDefinition.id,   \n     FormDefinition.version,   \n     FormDefinition.formDefinitionName,   \n     CAST(FormDefinition.script AS NVARCHAR(MAX)) AS script,   \n     '進行中' AS status   \n FROM   \n     ProcessInstance   \n     INNER JOIN LocalRelevantData ON LocalRelevantData.containerOID = ProcessInstance.contextOID   \n     INNER JOIN FormInstance ON FormInstance.OID = LocalRelevantData.valueOID   \n     INNER JOIN FormDefinition ON FormDefinition.OID = FormInstance.definitionOID   \n WHERE   \n     ProcessInstance.currentState IN (0, 1, 2)   \n     AND FormDefinition.script LIKE '%' + @CODE + '%'   \n UNION   \n SELECT   \n     id,   \n     version,   \n     formDefinitionName,   \n     CAST(FormDefinition.script AS NVARCHAR(MAX)) AS script,   \n     '最新版' AS status   \n FROM   \n     FormDefinition   \n WHERE   \n     publicationStatus = 'RELEASED'   \n     AND FormDefinition.script LIKE '%' + @CODE + '%';\n```\n\n[![](ATT.png)](ATT.png )\n\n2.     \n在表單設計師→右鍵[檢視表單發行歷程]→找到對應版號→右鍵[取出此版本]→修正Js程式→按[更新腳本]即可。  \n  \n[![](2.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n  \n\n","tags":["sql","easyflow gp"]},{"title":"SVN修改commit log訊息","url":"/2019/05/21/svn-modify-commit-log-message/","content":"將以下指令存成批次檔,路徑於SVN倉庫的hooks資料夾,檔名pre-revprop-change.bat  \n 參考來源: https://stackoverflow.com/a/468475  \n   \n\n```\n @ECHO OFF   \n :: Set all parameters. Even though most are not used, in case you want to add   \n :: changes that allow, for example, editing of the author or addition of log messages.   \n set repository=%1   \n set revision=%2   \n set userName=%3   \n set propertyName=%4   \n set action=%5   \n  \n :: Only allow the log message to be changed, but not author, etc.   \n if /I not \"%propertyName%\" == \"svn:log\" goto ERROR_PROPNAME   \n  \n :: Only allow modification of a log message, not addition or deletion.   \n if /I not \"%action%\" == \"M\" goto ERROR_ACTION   \n  \n :: Make sure that the new svn:log message is not empty.   \n set bIsEmpty=true   \n for /f \"tokens=*\" %%g in ('find /V \"\"') do (   \n set bIsEmpty=false   \n )   \n if \"%bIsEmpty%\" == \"true\" goto ERROR_EMPTY   \n  \n goto :eof   \n  \n :ERROR_EMPTY   \n echo Empty svn:log messages are not allowed. >&2   \n goto ERROR_EXIT   \n  \n :ERROR_PROPNAME   \n echo Only changes to svn:log messages are allowed. >&2   \n goto ERROR_EXIT   \n  \n :ERROR_ACTION   \n echo Only modifications to svn:log revision properties are allowed. >&2   \n goto ERROR_EXIT   \n  \n :ERROR_EXIT   \n exit /b 1\n```\n","tags":["svn"]},{"title":"TIPTOP按EasyFlow送簽出現XML parser error錯誤訊息而無法開單","url":"/2019/05/16/easyflow_gp5_6-tiptop-xml_parser-error/","content":"1.按EasyFlow送簽出現XML parser error錯誤訊息   \n [![](p11.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n  \n 2.進到[系統整合cache]  \n [![](0_0_image002.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n   \n 3.如果有相同的單號,代表被以前的表單快取卡住無法開單,刪除即可   \n [![](0_0_image003.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n\n","tags":["easyflow gp"]},{"title":"複製流程A的附件到流程B","url":"/2019/05/16/copy-attachment-between-process/","content":"\n複製流程A的XML的Attachment tag到流程B即可。\n\n[![](Image_20190516125600.png)](Image_20190516125600.png )\n\n另外在[管理流程]清單的流程B的迴紋針圖示會無法顯示,\n\n因為在table:NoDocument,該附件的流程欄位是流程A而非流程B。\n\n[![](Image_20190516130055.png)](Image_20190516130055.png )\n\n","tags":["easyflow gp"]},{"title":"修改表單欄位資料","url":"/2019/05/16/modify-form-field-value/","content":"\n```\nSELECT   \n FormInstance.OID,   \n fieldValues,   \n maskFieldValues   \n FROM   \n ProcessInstance   \n JOIN LocalRelevantData ON contextOID = containerOID   \n JOIN FormInstance ON valueOID = FormInstance.OID   \n WHERE   \n ProcessInstance.serialNumber = '[流程序號]';\n```\n\n注意事項:   \n 1.一般流程改[fieldValues]欄位的XML,   \n 如果是TIPTOP發起的流程則[maskFieldValues]及[fieldValues]欄位的XML都要修改。   \n 2.Grid控制項有其特殊規則:\n\n[![](Image_20190516123925.png)](Image_20190516123925.png )\n\n","tags":["sql","easyflow gp"]},{"title":"更新主部門,職務,核決層級,職稱","url":"/2019/05/10/update-department-function-approval/","content":"\n```\n DECLARE @userId nvarchar(100)   \n DECLARE @newOrganizationUnitId nvarchar(100)   \n DECLARE @newFunctionDefinitionName nvarchar(100)   \n DECLARE @newFunctionLevelName nvarchar(100)   \n DECLARE @occupantOID char(32)   \n DECLARE @newOrganizationOID char(32)   \n DECLARE @newOrganizationUnitOID char(32)   \n DECLARE @newFunctionsDefinitionOID char(32)   \n DECLARE @newApprovalLevelOID char(32)   \n DECLARE @newTitleDefinitionOID char(32)   \n   \n SET @userId = '[工號]'   \n SET @newOrganizationUnitId = '[部門代號]'   \n SET @newFunctionDefinitionName = '[職務名稱]'   \n SET @newFunctionLevelName = '[核決權限名稱]'   \n SET @occupantOID = (SELECT OID FROM Users WHERE id = @userId)   \n SET @newOrganizationOID = (select organizationOID FROM OrganizationUnit WHERE id = @newOrganizationUnitId)   \n SET @newOrganizationUnitOID = (SELECT OID FROM OrganizationUnit WHERE id = @newOrganizationUnitId)   \n SET @newFunctionsDefinitionOID = (SELECT OID FROM FunctionDefinition WHERE organizationOID = @newOrganizationOID AND functionDefinitionName = @newFunctionDefinitionName)   \n SET @newApprovalLevelOID = (SELECT OID FROM FunctionLevel WHERE organizationOID = @newOrganizationOID AND functionLevelName = @newFunctionLevelName)   \n SET @newTitleDefinitionOID = (SELECT OID FROM TitleDefinition WHERE organizationOID = @newOrganizationOID AND titleDefinitionName = @newFunctionDefinitionName)   \n   \n /*更新主部門*/   \n UPDATE Functions   \n SET organizationUnitOID = @newOrganizationUnitOID  \n ,objectVersion = objectVersion + 1   \n WHERE isMain = 1 AND occupantOID = @occupantOID   \n   \n /*更新職務*/   \n UPDATE Functions   \n SET definitionOID = @newFunctionsDefinitionOID  \n ,objectVersion = objectVersion + 1   \n WHERE isMain = 1 AND occupantOID = @occupantOID   \n   \n /*更新核決層級*/   \n UPDATE Functions   \n SET approvalLevelOID = @newApprovalLevelOID  \n ,objectVersion = objectVersion + 1   \n WHERE isMain = 1 AND occupantOID = @occupantOID   \n   \n /*更新職稱*/   \n UPDATE Title   \n SET definitionOID = @newTitleDefinitionOID  \n ,objectVersion = objectVersion + 1   \n WHERE organizationUnitOID = @newOrganizationUnitOID AND occupantOID = @occupantOID\n```\n","tags":["sql","easyflow gp"]},{"title":"刪除使用者帳號","url":"/2019/05/10/delete-easyflow_gp5_6-user-account/","content":"\n```\n DECLARE @userId nvarchar(100) = '[工號]'   \n DECLARE @userOID char(32) = (SELECT OID FROM Users WHERE id = @userId)   \n   \n DELETE FROM Users where id = @userId;   \n DELETE FROM Employee WHERE employeeId = @userId;   \n DELETE FROM Functions where occupantOID = @userOID;\n```\n","tags":["sql","easyflow gp"]},{"title":"SQL註冊器 SQL語法 測試區同步至正式區","url":"/2019/05/10/sql-registrar-syntax-synchronize-test/","content":"\n```\n/*SQL註冊器 SQL語法 測試區同步至正式區*/   \n INSERT INTO [正式區EFGP DB].dbo.FormSqlClause   \n     SELECT   \n         *   \n     FROM [測試區EFGP DB].dbo.FormSqlClause   \n     WHERE id IN ('[SQL代號]');   \n   \n /*SQL註冊器 表單權限 測試區同步至正式區*/   \n INSERT INTO [正式區EFGP DB].dbo.SqlAllowedForm   \n     SELECT   \n         *   \n     FROM [測試區EFGP DB].dbo.SqlAllowedForm   \n     WHERE containerOID IN (   \n         SELECT   \n             OID   \n         FROM [測試區EFGP DB].dbo.FormSqlClause   \n         WHERE id IN ('[SQL代號]')   \n     );\n```\n","tags":["sql","easyflow gp"]},{"title":"Invoke關卡呼叫.Net web service(asmx)","url":"/2019/05/08/easyflow_gp5_6-call-asmx-web_service/","content":"1-1.web service網站的web.config需新增HttpPost protocol  \n\n[![](2.png)](2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n1-2.在asmx.cs的開頭  \n將[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1\\_1)]  \n改成[WebServiceBinding(ConformsTo = WsiProfiles.None)]  \n\n[![](att0.png)](att0.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n1-3.在method開頭新增  \n[SoapRpcMethod(Use = System.Web.Services.Description.SoapBindingUse.Literal)]  \n\n[![](att2.png)](att2.png )\n\n  \n  \n  \n  \n  \n  \n注意:1-2跟1-3都要設定,不然會有參數值為null的問題;  \n另外method只支援string型態的參數跟回傳結果  \n1)如果參數其中之一不是string型態,則無法進入method(找不到method)  \n2)如果回傳結果不是string型態,則無法回傳結果  \n\n[![](Image_20190923155508.png)](Image_20190923155508.png )\n\n  \n  \n  \n  \n  \n  \n2.Invoke關卡選擇web service  \n[![](1.png)](1.png )  \n  \n  \n3.選擇HttpPost  \n\n[![](att9.png)](att9.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n4.再設定參數對應的流程變數即可。  \n\n[![](att10.png)](att10.png )\n\n  \n  \n\n","tags":["easyflow gp","web service"]},{"title":"IIS不卡頓的設定","url":"/2019/04/19/speedup-iis-performance-setting/","content":"1.應用集區初始化:  \n\n[![](1-1.jpg)](1-1.jpg )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.應用集區 - 啟動模式:  \n\n[![](333.jpg)](333.jpg )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.網站進階設定 - 預先載入:  \n\n[![](2-22.jpg)](2-22.jpg )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n4.應用集區 – 閒置逾時動作:  \n\n[![](5.png)](5.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n5.應用集區 - 回收 - 固定時間間隔:  \n[![](44444.jpg)](44444.jpg )  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n6.取消壓縮:  \n(如果頁面size都不大)  \n\n[![](6.jpg)](6.jpg )\n\n  \n\n"},{"title":"iis express允許外部連線","url":"/2019/04/17/iis-express-allow-external-connection/","content":"\n1.IIS Express工作列圖示->右鍵->顯示所有應用程式\n\n[![](image_20241230_105822.png)](image_20241230_105822.png )\n\n  \n\n2.修改applicationhost.config，位置如下圖，依序點擊即可。\n\n[![](image_20241230_110520.png)](image_20241230_110520.png )\n\n  \n\n3.編輯sites區段，新增\n\n  \n\n[![](image_20241230_110749.png)](image_20241230_110749.png )\n\n  \n\n","tags":["internet information server"]},{"title":"web deploy第1次都會失敗","url":"/2019/03/28/web_deploy-first-time-error/","content":"\n在部署時都會顯示失敗\n\n[![](Image_20190328133916.png)](Image_20190328133916.png )\n\n但第2次又正常\n\n[![](Image_20190328133929.png)](Image_20190328133929.png )\n\n原因為Microsoft.Net.Compilers,移除即可。\n\n[![](Image_20190328134241.png)](Image_20190328134241.png )\n\n參考來源:[https://stackoverflow.com/a/48583412](https://stackoverflow.com/a/48583412 \"https://stackoverflow.com/a/48583412\")\n\n","tags":["visual studio","踩坑"]},{"title":"修正線上正在執行的流程關卡的SQL語法","url":"/2019/02/01/correct_running_process-sql_syntax/","content":"\n```\n DECLARE @serialNumber nvarchar(50) = '<要修正的流程序號>';   \n DECLARE @activityDefinitionName nvarchar(100) = '<要修正的關卡ID>';   \n DECLARE @contextOID char(32) = (SELECT contextOID FROM ProcessInstance WHERE serialNumber = @serialNumber);   \n DECLARE @processPackageOID char(32) = (SELECT processPackageOID FROM ProcessContext WHERE OID = @contextOID);   \n DECLARE @ProcessDefinitionOID char(32) = (SELECT ProcessDefinitionOID FROM ProcessPackage_ProcessDef WHERE ProcessPackageOID = @processPackageOID);   \n  \n SELECT   \n     ParticipantDefinition.*   \n FROM ActivityDefinition   \n INNER JOIN ParticipantDefinition   \n ON ActivityDefinition.containerOID = ParticipantDefinition.containerOID   \n AND ParticipantDefinition.id LIKE '%' + CAST(ActivityDefinition.performerIds AS VARCHAR(MAX)) + '%'   \n AND ActivityDefinition.containerOID = @ProcessDefinitionOID   \n AND activityDefinitionName = @activityDefinitionName;   \n  \n UPDATE ParticipantDefinition   \n SET organizationUnitId = '<修正後的部門代號>'   \n ,objectVersion = objectVersion + 1   \n WHERE OID = '<為上個SQL指令查出的ParticipantDefinition.OID>';\n```\n","tags":["sql","easyflow gp"]},{"title":"查詢線上特定流程流程的待處理關卡擱置時數的SQL語法","url":"/2019/01/23/query-pending-time-sql_syntax/","content":"\n```\nSELECT \n    ProcessInstance.serialNumber AS \"流程序號\" \n    ,ProcessInstance.processInstanceName AS \"流程名稱\" \n    ,ProcessInstance.subject AS \"流程主旨\" \n    ,ProcessInstance.createdTime AS \"流程建立時間\" \n    ,WorkItem.workItemName AS \"關卡名稱\" \n    ,CASE WHEN Performers.id IS NULL THEN Assignees.id END AS \"關卡處理者工號\" \n    ,CASE WHEN Performers.userName IS NULL THEN Assignees.userName END AS \"關卡處理者姓名\" \n    ,CASE WHEN Performers.leaveDate IS NULL THEN '是' ELSE CASE WHEN Assignees.leaveDate IS NULL THEN '是' ELSE '否' END END AS \"關卡處理者在職狀態\" \n    ,WorkItem.createdTime AS \"關卡建立時間\" \n    ,DATEDIFF(HOUR, ProcessInstance.createdTime, GETDATE()) AS \"未處理時數\" \n    ,DATEDIFF(HOUR, ProcessInstance.createdTime, GETDATE()) / 24 AS \"未處理天數\" \n    ,CASE\n        WHEN WorkAssignment.assignmentType = 0 THEN '正常指派'\n        WHEN WorkAssignment.assignmentType = 1 THEN '重新指派'\n        WHEN WorkAssignment.assignmentType = 2 THEN '退件指派'\n     END AS \"指派類型\" \nFROM WorkItem\nINNER JOIN ProcessContext\n    ON ProcessContext.OID = WorkItem.contextOID\nINNER JOIN ProcessInstance\n    ON ProcessInstance.OID = ProcessContext.containerOID\nINNER JOIN ParticipantActivityInstance\n    ON ParticipantActivityInstance.OID = WorkItem.containerOID\nLEFT JOIN WorkAssignment\n    ON WorkAssignment.workItemOID = WorkItem.OID\nLEFT JOIN Users AS Performers\n    ON WorkItem.performerOID = Performers.OID\nLEFT JOIN Users AS Assignees\n    ON WorkAssignment.assigneeOID = Assignees.OID\nWHERE WorkItem.currentState IN (0, 1, 2)\nAND ProcessInstance.processDefinitionId = '特定流程定義代號'\nORDER BY WorkItem.createdTime\n```\n","tags":["sql","easyflow gp"]},{"title":"查詢線上所有流程的全部關卡參與者的SQL語法","url":"/2019/01/19/query-all-participant-sql_syntax/","content":"建議可分拆SQL避免CTE執行效率不佳  \n\n```\nWITH\n ProcessPackage_ActivityDefinations\n AS\n (\n SELECT ProcessPackage.id AS processPackage_id ,ProcessPackage.processPackageName ,ProcessPackageCategory.packageCategoryName ,ActivityDefinition.id AS activityDefinition_id ,DecisionRuleList.referActivityId ,ActivityDefinition.activityDefinitionName ,ActivityDefinition.containerOID ,ActivityDefinition.performType ,ActivityDefinition.multiUserMode ,ActivityDefinition.batchPerformable ,ActivityDefinition.reassignable ,ActivityDefinition.regainable ,ActivityDefinition.unReexecuteType ,ActivityDefinition.unReexcuteActIds ,ActivityDefinition.bypassable ,ActivityDefinition.ableToAskActivityReexecute ,ActivityDefinition.addingActivityAuthority ,ActivityDefinition.limits ,ProcessDefinitionHeader.durationUnit ,ActivityDefinition.dealOvertimeActivityType ,ActivityDefinition.autoDelivery ,CAST('' + REPLACE(CAST(ActivityDefinition.performerIds AS varchar(max)), ',', '＜/performerId＞＜performerId＞') + '＜/performerId＞' AS xml) AS performerIdXml\n FROM ProcessPackage\n INNER JOIN ProcessPackageCmItem ON ProcessPackage.containerOID = ProcessPackageCmItem.OID\n INNER JOIN RedefinableHeader ON ProcessPackage.redefinableHeaderOID = RedefinableHeader.OID\n INNER JOIN ProcessPackageHeader ON ProcessPackage.headerOID = ProcessPackageHeader.OID\n INNER JOIN ProcessPackage_ProcessDef ON ProcessPackage.OID = ProcessPackage_ProcessDef.ProcessPackageOID\n INNER JOIN ProcessDefinition ON ProcessPackage.id = ProcessDefinition.id\n INNER JOIN ProcessDefinitionHeader ON ProcessDefinition.headerOID = ProcessDefinitionHeader.OID\n INNER JOIN ProcessPackageCategory ON ProcessPackageCmItem.categoryOID = ProcessPackageCategory.OID\n INNER JOIN ActivityDefinition ON ProcessDefinition.OID = ActivityDefinition.containerOID\n LEFT JOIN DecisionRuleList ON ActivityDefinition.decisionRuleListOID = DecisionRuleList.OID\n WHERE ProcessDefinition.OID = ProcessPackage_ProcessDef.ProcessDefinitionOID AND ProcessPackageCmItem.lastVersion = RedefinableHeader.version AND validTo >= GETDATE() AND RedefinableHeader.publicationStatus = 'RELEASED'\n /**加入搜尋條件*/\n ) ,ProcessPackage_ActivityDefination_PerformerIds\n AS\n (\n SELECT processPackage_id ,processPackageName ,packageCategoryName ,activityDefinition_id ,referActivityId ,activityDefinitionName ,containerOID ,performType ,multiUserMode ,batchPerformable ,reassignable ,regainable ,unReexecuteType ,unReexcuteActIds ,bypassable ,ableToAskActivityReexecute ,addingActivityAuthority ,limits ,durationUnit ,dealOvertimeActivityType ,autoDelivery ,performerIds.value('.', 'varchar(max)') AS performerId\n FROM ProcessPackage_ActivityDefinations\n CROSS APPLY performerIdXml.nodes('/performerId') CA(performerIds)\n UNION ALL\n SELECT processPackage_id ,processPackageName ,packageCategoryName ,activityDefinition_id ,referActivityId ,activityDefinitionName ,containerOID ,performType ,multiUserMode ,batchPerformable ,reassignable ,regainable ,unReexecuteType ,unReexcuteActIds ,bypassable ,ableToAskActivityReexecute ,addingActivityAuthority ,limits ,durationUnit ,dealOvertimeActivityType ,autoDelivery ,NULL AS performerId\n FROM ProcessPackage_ActivityDefinations\n WHERE performerIdXml IS NULL\n AND activityDefinitionName <> 'Route Activity'\n ) ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition\n AS\n (\n SELECT ParticipantDefinition.activityDefinitionId ,ParticipantDefinition.participantType ,ParticipantDefinition.formFieldId ,ParticipantDefinition.organizationId ,Organization.organizationName ,ParticipantDefinition.includeSubUnit ,ParticipantDefinition.organizationUnitId ,OrganizationUnit.organizationUnitName ,ParticipantDefinition.employeeId ,Users.userName ,ParticipantDefinition.groupId ,Groups.groupName ,RoleDefinition.shortName ,ParticipantDefinition.roleDefinitionName ,ProcessPackage_ActivityDefination_PerformerIds.*\n FROM ProcessPackage_ActivityDefination_PerformerIds\n LEFT JOIN ParticipantDefinition ON ProcessPackage_ActivityDefination_PerformerIds.containerOID = ParticipantDefinition.containerOID\n AND ProcessPackage_ActivityDefination_PerformerIds.performerId = ParticipantDefinition.id\n LEFT JOIN Users ON ParticipantDefinition.employeeId = Users.id\n LEFT JOIN Organization ON ParticipantDefinition.organizationId = Organization.id\n LEFT JOIN OrganizationUnit ON ParticipantDefinition.organizationUnitId = OrganizationUnit.id\n LEFT JOIN Groups ON ParticipantDefinition.groupId = Groups.id\n LEFT JOIN RoleDefinition ON ParticipantDefinition.roleDefinitionName = RoleDefinition.roleDefinitionName\n )\nSELECT ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.processPackage_id AS \"流程序號\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.processPackageName AS \"流程名稱\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.packageCategoryName AS \"流程分類\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.activityDefinition_id AS \"關卡代碼\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.activityDefinitionName AS \"關卡名稱\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN 'INVOKE' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '核決權限' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.performType = 'NORMAL' THEN '一般' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.performType = 'EXECUTION' THEN '會辦(不可退件)' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.performType = 'NOTICE' THEN '通知' END AS \"關卡類型\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId ELSE ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.activityDefinitionId END AS \"參考關卡代碼\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.multiUserMode = 'FIREST_GET_FIRST_WIN' THEN '只需1人處理' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.multiUserMode = 'FOR_EACH' THEN '每人都需處理' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.multiUserMode = 'STRATEGY' THEN '分派策略模式' END AS \"處理模式\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.limits = 0 THEN '無' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.dealOvertimeActivityType = 'SEND_NOTIFICATION' THEN CAST( ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.limits AS varchar ) + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.durationUnit + '後寄發通知給工作受託者' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.dealOvertimeActivityType = 'JUMP_TO_NEXT' THEN CAST( ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.limits AS varchar ) + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.durationUnit + '後跳到下一個活動' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.dealOvertimeActivityType = 'PASS_TO_SUBSTITUTE' THEN CAST( ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.limits AS varchar ) + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.durationUnit + '後給合適的代理人' END AS \"逾時處理\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.batchPerformable = 1 THEN '是' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.batchPerformable = 0 THEN '否' END AS \"批次簽核\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 0 THEN '無法轉派' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 1 THEN '只可轉派代理人' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 2 THEN '只可系統轉派' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 3 THEN '可轉派代理人及系統轉派' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 4 THEN '只可轉派他人' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 5 THEN '可轉派代理人及轉派他人' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 6 THEN '可轉派他人及系統轉派' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.reassignable = 7 THEN '可轉派代理人、轉派他人及系統轉派' END AS \"轉派權限\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.regainable = 1 THEN '可' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.regainable = 0 THEN '不可' END AS \"取回重辦\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.bypassable = 1 THEN '是' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.bypassable = 0 THEN '否' END AS \"可跳過\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.autoDelivery = 1 THEN '不可自動派送' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.autoDelivery = 2 THEN '與前一關同簽核者,則自動派送' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.autoDelivery = 3 THEN '流程中有相同簽核者,則自動派送(含發起者)' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.autoDelivery = 4 THEN '流程中有相同簽核者,則自動派送(不含發起者)' END AS \"自動派送\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.ableToAskActivityReexecute = 0 THEN '不可退件' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.ableToAskActivityReexecute = 1 THEN '可退件,預設按流程定義送回要求退件者' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.ableToAskActivityReexecute = 2 THEN '按流程定義送回要求退件者' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.ableToAskActivityReexecute = 3 THEN '直接送回要求退件者' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.ableToAskActivityReexecute = 4 THEN '可退件,預設直接送回要求退件者' END AS \"可退件\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '參照' + ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId + '設定' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.addingActivityAuthority = 1 THEN '可向前加簽' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.addingActivityAuthority = 2 THEN '可向後加簽' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.addingActivityAuthority = 3 THEN '可向前後加簽' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.addingActivityAuthority = 0 THEN '不可加簽' END AS \"加簽\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.referActivityId IS NOT NULL THEN '人員或關係人之部門主管' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'RESOURCE_SET' THEN '設備資源集合' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'RESOURCE' THEN '設備資源' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'GROUP' THEN '群組' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'ROLEDEFINITION' THEN '角色' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'ORGANIZATION_UNIT' THEN '部門' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'HUMAN' THEN '人員' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'SYSTEM' THEN '系統(INVOKE關卡)' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'MANAGER' THEN '人員或關係人之直屬主管' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'UNIT_MANAGER' THEN '人員或關係人之部門主管' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'FUNCTIONDEFINITION' THEN '職務' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'FORM_FIELD_DATA' THEN '表單欄位' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'MANAGER_OF_ORGANIZATION_UNIT' THEN '部門主管' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'ACTIVITY_SIGNER' THEN '關卡簽核者' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'PROCESS_REQUESTER' THEN '流程發起人' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'PROCESS_RELATIONAL' THEN '流程關係人' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType = 'STRATEGY_ASSIGN' THEN '策略分配' ELSE ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType END AS \"參與者類型\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.formFieldId AS \"表單欄位代碼\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.organizationId AS \"組織代碼\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.organizationName AS \"組織名稱\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.organizationUnitId AS \"部門代碼\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.organizationUnitName AS \"部門名稱\" ,CASE WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.participantType <> 'ORGANIZATION_UNIT' THEN NULL WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.includeSubUnit = 1 THEN '是' WHEN ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.includeSubUnit = 0 THEN '否' END AS \"是否包含子單位\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.employeeId AS \"參與者工號\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.userName AS \"參與者姓名\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.groupId AS \"群組代碼\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.groupName AS \"群組名稱\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.shortName AS \"角色簡稱\" ,ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.roleDefinitionName AS \"角色名稱\"\nFROM ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition\nORDER BY ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.packageCategoryName, ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.processPackage_id, TRY_PARSE(REPLACE(REPLACE(ProcessPackage_ActivityDefination_PerformerId_ParticipantDefinition.activityDefinition_id, 'ACT', ''), '_', '.') AS float)\n```\n","tags":["sql","easyflow gp"]},{"title":"本機LocalDB降版","url":"/2019/01/08/native-localdb-version-downgrade/","content":"場景:  \n本機已安裝LocalDB 2016,想降版到2014。  \n  \n作法:  \n1.移除LocalDB 2016。  \n2.安裝LocalDB 2014。  \n3.如果在新增/連線到LocalDB顯示異常如下圖:  \n\n[![](Image_20190108115342.png)](Image_20190108115342.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n4.進到事件檢視簿,如果發現錯誤訊息如下圖:  \n\n[![](111.png)](111.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n5.編輯登錄檔如下圖:  \n路徑:HKEY\\_CURRENT\\_USER\\Software\\Microsoft\\Microsoft SQL Server\\UserInstances  \n刪除錯誤版本即可。  \n\n[![](Image_20190108132124.png)](Image_20190108132124.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n參考來源:[LocalDB parent instance version invalid: MSSQL13E.LOCALDB](https://stackoverflow.com/a/43693155 \"https://stackoverflow.com/a/43693155\")\n\n","tags":["visual studio","localdb"]},{"title":"修正進行中的表單欄位權限","url":"/2019/01/07/fix_running_form-field-permission/","content":"場景:  \n   \n流程的某一關(本例為ACT2)的控件(本例為附件按鈕Attachment)忘了設成Enable,導致在這關都無法上傳附件。   \n [![](Image_20190107083620.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 動作:   \n (1)找出目前在使用的流程定義。  \nSQL語法:  \n\n```\nSELECT *   \nFROM ProcessDefinition   \nINNER JOIN ProcessDefinitionHeader   \nON ProcessDefinition.headerOID = ProcessDefinitionHeader.OID   \nAND ProcessDefinitionHeader.validTo >= GETDATE()   \nINNER JOIN RedefinableHeader   \nON ProcessDefinition.redefinableHeaderOID = RedefinableHeader.OID   \nAND RedefinableHeader.publicationStatus = 'RELEASED'   \nWHERE id = 'test00011';\n```\n\n  \n [![](Image_20190107091413.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n  \n(2)以(1)的OID查詢這個流程定義底下所用的所有活動關卡定義。   \n SQL語法:\n\n```\nSELECT id, formFieldAccessDefinitionOID   \n FROM ActivityDefinition   \n WHERE containerOID = '4beabe6fe40510048797ab8fbcef89eb';\n```\n\n  \n [![](Image_20190107091636.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n   \n (3)以(2)的formFieldAccessDefinitionOID查詢該活動關卡的存取權限。  \n SQL語法:  \n\n```\nSELECT *  \n FROM FormFieldAccessDefinition  \n WHERE OID = '4beb4023e40510048797ab8fbcef89eb';\n```\n\n  \n [![](Image_20190107091844.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n  \n (4)把ACT2錯誤的內容跟正確內容(如ACT1)相比,可發現差異如下。  \n [![](Image_20190107084423.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n (5)更正ACT2的formFieldAccessControl內容,補上ENABLED。  \n SQL語法:  \n [![](pro.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n (6)ACT2即可上傳附件。  \n [![](Image_20190107084918.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n","tags":["easyflow gp"]},{"title":"批次修改流程代理人啟用結束時間","url":"/2018/12/28/batch-modify-process-substitute-period/","content":"\n```\nUPDATE ProcessSubstituteDefinition\nSET startSubstituteTime = '<開始代理 年年年年-月月-日日 時時:分分:秒秒.000>'\n,endSubstituteTime = '<結束代理 年年年年-月月-日日 時時:分分:秒秒.000>'\n,substituteOID = (SELECT OID FROM Users WHERE id = '<代理者工號>')\n,objectVersion = objectVersion + 1\nWHERE ownerOID = (SELECT OID FROM Users WHERE id = '<被代理者工號>');![](pro1.png)\n```\n\n","tags":["easyflow gp"]},{"title":"發單時選錯部門導致跑到錯誤的直屬主管之解決方法","url":"/2018/12/28/select-wrong-department-director-solution/","content":"場景:   \n 發單者有主(=TCM0131)部門及其他(=TCG0123)部門, 兩個部門直屬主管為不同人。   \n 流程其中有關卡為發單者直屬主管。   \n [![](0_0_image002.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n[![](0_0_image003.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n  \n 發單時選錯部門。   \n  \n   \n 被退回重辦, 但發單者再次派送, 系統卻不會再詢問要用哪個單位進行派送導致又送錯主管。   \n此時可以   \n 1. 請User終止原流程, 重新發單。   \n 或   \n 2. 修正EasyFlow參考及發單部門欄位。   \n   \n 動作:   \n (1) 先退回發單者關卡。   \n (2) 修改DB:EFGP的Table:ProcessInstance流程資料, 把發單部門及參考部門都改為正確的部門。   \n  \n SQL語法:   \n\n```\n     DECLARE @UNIT_OID char(32) = (SELECT OID FROM OrganizationUnit WHERE id = '<正確部門代號>');   \n   \n       UPDATE ProcessInstance   \n       SET referOrganizationUnitOID = @UNIT_OID, /**改這個欄位, 流程引擎在派送到下一關卡時會依照這個欄位判斷流向。*/   \n       invokeOrganizationUnitOID = @UNIT_OID  \n ,objectVersion = objectVersion + 1   \n       WHERE serialNumber = <流程序號>;\n```\n\n  \n   \n (3) 重新派送, 發現已可到正確的直屬主管。   \n [![](0_0_image004.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n\n","tags":["easyflow gp"]},{"title":"Chrome偵錯鼎新EasyFlow GP顯示空白","url":"/2018/12/26/chrome-debug-easyflow_gp5_6-form-blank/","content":"狀況:  \n開單後開啟[開發者工具], 發現source頁籤是空白, 無法debug。  \n\n[![](p1.png)](p1.png )\n\n  \n  \n  \n解法:  \n(1)[開發者工具]在開啟的狀態下, 重新[發起流程]。  \n或  \n(2)在表單上按右鍵, 點[重新載入頁框]。  \n\n[![](p2.png)](p2.png )\n\n  \n\n","tags":["easyflow gp","chrome"]},{"title":"Visual Studio 2017新增Xamarin專案異常","url":"/2018/12/10/vs2017-xamarin-project-error/","content":"參照此[連結](https://forums.xamarin.com/discussion/90309/the-resolvelibraryprojectimports-task-failed-unexpectedly \"https://forums.xamarin.com/discussion/90309/the-resolvelibraryprojectimports-task-failed-unexpectedly\")的解決方案, 都無效。  \n但將所有相關元件都更新完成後, 就已無異常。  \n  \n新增專案(Cross-platform→行動應用程式→.NET standard)會顯示以下錯誤訊息。  \n\n[![](pro1.png)](pro1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n1.更新Android專案的NuGet套件, Xamarin相關都要更新。  \n\n[![](pro5.png)](pro5.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.Android→Android SDK管理員, 更新Android SDK。  \n(先確認好要安裝到哪些版本的Android, 下載對應的SDK。)  \n\n[![](pro4.png)](pro4.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\n","tags":["visual studio","踩坑","xamarin"]},{"title":"Eclipse偵錯鼎新EasyFlow組織設計師","url":"/2018/12/06/eclipse-debug-easyflow_gp5_6-organization_designer/","content":"1.用文字編輯器開啟jnlp檔, 到server將＜resources＞ tag內所有用到的jar檔下載到本地端。   \n [![](Image_20181206144148.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n   \n 2.下載Java Decompiler Eclipse[套件](https://www.blogger.com/# \"https://www.blogger.com/#\")。   \n   \n   \n 3.開啟Eclipse, 安裝之, 開啟class檔可顯示原始碼。   \n [![](Image_20181206140252.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n  \n 新增套件順序如下。   \n [![](Image_20181206140300.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n   \n [![](Image_20181206140324.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n [![](Image_20181206140332.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n   \n 4.新增專案。   \n [![](Image_20181206140441.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 5.新增引用, 加入之前下載的jar檔。   \n [![](Image_20181206140455.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n   \n [![](Image_20181206140814.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 6.偵錯組態新增遠端偵錯。   \n [![](Image_20181206143921.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 7.開啟source code, 找到要偵錯的段落, 加上中斷點。   \n [![](Image_20181206142740.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 8.以命令列執行jnlp檔, 程式不會顯示, 因為要等Eclipse連接上。   \n javaws.exe -J-agentlib:jdwp=transport=dt\\_socket,server=y,suspend=y,address=5005 nana-organization-designer.jnlp   \n   \n   \n 9.Eclipse執行偵錯, 組織設計師顯示畫面, 且執行到中斷點則會暫停。   \n [![](Image_20181206144031.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n\n","tags":["easyflow gp","debugger"]},{"title":"工作排程器提升優先順序","url":"/2018/11/21/task_scheduler-priority-promote/","content":"1.匯出工作存成XML檔。  \n [![](no1.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 2.編輯XML檔, 將7改為4。  \n [![](no2.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 3.刪除原有工作。  \n [![](no3.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 4.匯入編輯後的XML檔即可。  \n [![](no4.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n  \n 參考來源:[https://stackoverflow.com/questions/2427142/is-there-any-way-for-a-win2k8-scheduled-task-to-have-normal-priority-io](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n","tags":["windows"]},{"title":"EasyFlow GP 5.6使用jQuery插件","url":"/2018/11/15/easyflow_gp5_6-jquery-plugin/","content":"在EFGP的架構下有些地方要注意:  \n   \n 發現只要引用其他來源的jQuery,   \n 如document.write(''); 雖然起單時無任何問題, 但在第2關會有派送履歷無法顯示的異常。  \n [![](error1.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n而且就算想用jQuery的noConflict()方法也不可行, 因為:   \n 1.jQuery物件在EFGP被改名, 根本找不到。   \n [![](problem2.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 2.$別名在EFGP已有別的用途。   \n [![](problem1.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 解決方案:   \n 查看EFGP的source code, 其本身也有jQuery library, 別名為【\\_\\_jQuery】,   \n 所以只要撰寫當var textBox1 = $(“#TextBox1”);時  \n 改為var textBox1 = \\_\\_jQuery(“#TextBox1”);即可正常使用。   \n   \n 而jQuery插件也要配合修改(以[jQuery Soap](https://www.blogger.com/# \"https://www.blogger.com/#\")為例),   \n [![](before.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\njQuery改為\\_\\_jQuery即可。   \n [![](after.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n","tags":["easyflow gp","jquery"]},{"title":"Visual Studio Code插件Debugger for Chrome偵錯本機檔案","url":"/2018/11/09/vscode-extension-debugger_for_chrome/","content":"1.Visual Studio Code→開啟要偵錯的檔案的【所在資料夾】。  \n  \n2.編輯偵錯組態檔launch.json如下:\n\n```\n{   \n /**使用 IntelliSense 以得知可用的屬性。*/   \n /**暫留以檢視現有屬性的描述。*/   \n /**如需詳細資訊，請瀏覽: https://go.microsoft.com/fwlink/?linkid=830387*/   \n \"version\": \"0.2.0\",   \n \"configurations\": [   \n {   \n \"type\": \"chrome\",   \n \"request\": \"launch\",   \n \"name\": \"本機檔案偵錯\",   \n /**\"file\": \"${workspaceFolder}/<指定檔案名稱>\",*/ /**-->每次都偵錯此檔案*/   \n \"file\": \"${file}\", /**-->或偵錯目前所編輯的檔案*/   \n \"sourceMaps\": true,   \n \"userDataDir\": \"${workspaceFolder}/profile\"   \n }   \n ]   \n }\n```\n","tags":["visual studio code","chrome","debugger"]},{"title":"jQuery soap插件(jQuery呼叫.Net web service用)的使用方法","url":"/2018/11/06/jquery-soap-plugin-usage/","content":"\\*\\*IE瀏覽器\\*\\*  \n 網際網路選項→安全性→所對應的區域→自訂等級→存取跨網域的資料來源→啟用  \n [![](ie.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 引用如下:  \n <!--IE8只能用jQuery 1.x版本-->  \n\n```\n <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"></script>   \n <script src=\"http://cdn.zoanmgtinc.com/j_query/plugin/soap/jquery.soap.js\"></script>\n```\n\n  \n   \n   \n 方法如下:  \n\n```\n $.support.cors = true; /**修正\"no transport\"問題(for IE8, http://bugs.jquery.com/ticket/10660)*/  \n $.soap({   \n url: \"http://xxx.xxx.xxx.xxx/WebSite1_T/Service.asmx\",   \n method: \"<方法名稱>\",   \n SOAPAction: \"http://tempuri.org/<方法名稱>\",   \n envAttributes: {   \n \"xmlns\": \"http://tempuri.org/\"   \n },   \n data: {   \n Code: \"\", /**參數1*/   \n Display: true /**參數2*/   \n },   \n appendMethodToURL: false,   \n async: false,   \n success: function (soapResponse) {   \n /**成功時解析soapResponse的內容*/  \n /**建議用$(soapResponse.toString())轉成jQuery的xml物件以利操作*/   \n },   \n error: function (soapResponse) {   \n /**失敗時soapResponse會顯示伺服器回傳錯誤訊息*/   \n }   \n });\n```\n\n  \n   \n   \n 在web service伺服器的web.config的<configuration>節點底下加上\n\n```\n <system.webServer>   \n <httpProtocol>   \n <customHeaders>   \n <add name=\"Access-Control-Allow-Origin\" value=\"*\" />   \n <add name=\"Access-Control-Allow-Headers\" value=\"content-type, soapaction\" />   \n <add name=\"Access-Control-Allow-Methods\" value=\"*\" />   \n </customHeaders>   \n </httpProtocol>   \n </system.webServer>\n```\n\n","tags":["asp.net","web service","jquery"]},{"title":"SOAPUI模擬request payload形式的POST請求","url":"/2018/10/26/soapui-simulate-post-request/","content":"1.SOAPUI→REST Project 1→Request 1  \n  \n2.Method:POST→Endpoint:主機名稱→Resource:web api url  \n3.Media Type:application/json→貼上Request payload的json  \n\n[![](rest_request_body_os.png)](rest_request_body_os.png )\n\n  \n\n","tags":["testing","soapui"]},{"title":"今天是[程式設計師節]!!","url":"/2018/10/24/programmers-day/","content":"\n```\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n```\n","tags":["happy1024!"]},{"title":"Excel叫用Web service","url":"/2018/07/13/excel-call-web_service/","content":"1.VBA編輯器→工具→設定引用項目  \n\n[![](Image_20180713093944.png)](Image_20180713093944.png )\n\n2.增加Microsoft Office Soap Type Library v3.0\n\n(路徑:C:\\Program Files (x86)\\Common Files\\microsoft shared\\OFFICE14\\MSSOAP30.DLL)\n\n  \n\n及Microsoft XML, v6.0\n\n[![](Image_20180713094108.png)](Image_20180713094108.png )\n\n3.以下代碼叫用即可\n\n```\n Dim service As SoapClient30   \n   \n Dim result As MSXML2.IXMLDOMSelection '回傳結果   \n Dim isOk As MSXML2.IXMLDOMElement '回傳結果屬性(執行結果OK/NG)   \n Dim message As MSXML2.IXMLDOMElement '回傳結果屬性(返回訊息)   \n Dim value As MSXML2.IXMLDOMElement '回傳結果屬性(返回值)   \n   \n   \n Set service = New SoapClient30   \n Call service.MSSoapInit(\"WSDL的URL\")   \n      \n Set result = service.方法名稱(\"參數\")   \n Set isOk = result.Item(0)   \n Set message = result.Item(1)   \n Set value = result.Item(2)\n```\n\n","tags":["web service","excel","vba"]},{"title":"C# Roslyn Scripting API(程式靈活性上升, 但穩健性卻會大幅下降, 需配合大量[單元測試]服用!)","url":"/2018/06/26/csharp-roslyn-scripting-api/","content":"以呼叫轉換月份縮碼的方法為例:  \n  \n該dll內容如下圖:  \n[![](Image_20180626173803.png)](Image_20180626173803.png )  \n  \n1.專案需加入該dll作為參考。  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.重點是  \nType.GetType(<該類別的AssemblyQualifiedName>).Assembly  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.執行結果如下圖:  \n\n[![](Image_20180626174236.png)](Image_20180626174236.png )\n\n  \n\n","tags":["c#","roslyn scripting api"]},{"title":"clickonce執行script(Client端)","url":"/2018/06/25/clickonce-execute-script-client-side/","content":"\n```\n @ECHO OFF  \n SET APP=%1  \n ::此script檔執行需帶參數=%APP%  \n   \n ::建置ClickOnce專案  \n \"MSBuild.exe\" \"<專案名稱>.csproj\" /target:publish /property:Configuration=Debug;PublishUrl=\\\\<主機名稱>\\%APP%;AssemblyName=%APP%;PublisherName=<公司名稱>;ProductName=%APP%;ApplicationRevision=1;MinimumRequiredVersion=1.0.0.1  \n   \n ::建立Deploy資料夾  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create 'cmd.exe /c mkdir C:\\%APP%'  \n   \n ::Deploy資料夾權限:everyone, 執行  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create 'cmd.exe /c icacls C:\\%APP% /grant \"everyone:RX\"'  \n   \n ::複製專案到資料夾  \n robocopy <專案名稱>\\bin\\Debug\\app.publish \\\\<主機名稱>\\C$\\%APP% /MIR /Z /ZB /TBD /NP /R:5 /W:0 /MT:32\n```\n","tags":["visual studio","windows form","dos command","clickonce"]},{"title":"備份文件/清理電腦暫存檔的batch script","url":"/2018/06/25/backup-file-clean-computer-script/","content":"\n```\n::備份我的文件夾  \n\nrobocopy \"<我的文件夾位置>\" \"<遠端備份主機位置>\" /MIR /Z /ZB /TBD /NP /R:5 /W:0 /MT:32  \n\n  \n\n::磁碟清理  \n\n%windir%\\System32\\cleanmgr.exe /SAGERUN:99  \n\n  \n\n::清除暫存資料夾  \n\n%windir%\\System32\\cmd.exe /C DEL /F /S /Q %TEMP%\\*  \n\n%windir%\\System32\\cmd.exe /C FOR /D %d IN (%TEMP%\\\"*\") DO RMDIR \"%d\" /S /Q  \n\n  \n\n::清理登錄檔null值  \n\n\"C:\\Program Files\\RegDelNull\\RegDelNull64.exe\" -s hkcr  \n\n\"C:\\Program Files\\RegDelNull\\RegDelNull64.exe\" -s hkcu  \n\n\"C:\\Program Files\\RegDelNull\\RegDelNull64.exe\" -s hklm  \n\n\"C:\\Program Files\\RegDelNull\\RegDelNull64.exe\" -s hku  \n\n\"C:\\Program Files\\RegDelNull\\RegDelNull64.exe\" -s hkcc\n```\n","tags":["windows","dos command"]},{"title":"單元測試需注意事項","url":"/2018/06/23/unit_testing-note/","content":"  \n 狀況:  \n 當使用TransactionScope將之前寫入資料庫動作撤銷,  \n 專案有使用到EntityFramework及Dapper會遇到以下錯誤;  \n   \n (1)顯示\"No Entity Framework provider found for the ADO.NET provider with invariant name ‘System.Data.SqlClient'\"錯誤  \n 解法:EntityFramework的DbContext需新加建構式如下:  \n   \n\n```\n public partial class xxxEntities {  \n         public static xxxEntities Create() {  \n             return new xxxEntities(\"name=xxxEntities\");  \n         }  \n   \n         private xxxEntities(string contextName) : base(contextName) {  \n             var ensureDLLIsCopied = System.Data.Entity.SqlServer.SqlProviderServices.Instance;  \n         }  \n     }\n```\n\n  \n   \n 參考:  \n [1][https://stackoverflow.com/questions/15088426/overriding-code-generated-dbcontext-constructor/15088572#15088572](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n [2][http://robsneuron.blogspot.com/2013/11/entity-framework-upgrade-to-6.html](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n (2)Dapper使用SqlConnection  \n 會顯示\"已停用分散式交易管理員 (MSDTC) 的網路存取。請使用元件服務系統管理工具啟用 DTC，以使用 MSDTC 安全性設定中的網路存取\"  \n 解法:在連線字串增加enlist=False, 避免觸發MSTDC\n","tags":["visual studio","testing",".net framework","踩坑","dapper","entity framework"]},{"title":"鎖定工作站語法(作成捷徑圖示可實現一鍵鎖定電腦)","url":"/2018/06/23/lock-workstation-command/","content":"\n```\nC:\\Windows\\System32\\rundll32.exe user32.dll,LockWorkStation\n```\n","tags":["windows"]},{"title":"msdeploy執行script(Server端)","url":"/2018/06/23/msdeploy-execute-script-server-side/","content":"\n```\n @ECHO OFF  \n SET APP=%1  \n ::此script檔執行需帶參數=%APP%  \n   \n   \n ::置換Web.config DB連線字串  \n powershell -command \"(Get-Content <專案路徑>\\Web.config) -replace ('initial catalog=[a-zA-Z0-9]+;', 'initial catalog=%APP%;') | Out-File <專案路徑>\\Web.config\"  \n   \n   \n ::建置專案  \n \"MSBuild.exe\" \"<專案名稱>.csproj\" /p:DeployOnBuild=true /property:Configuration=Debug  \n   \n  \n ::建立資料夾在伺服器的C槽  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create 'cmd.exe /c mkdir C:\\%APP%'  \n   \n  \n ::建立應用程序在伺服器IIS  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create '%systemroot%\\system32\\inetsrv\\appcmd.exe add APPPOOL /name:%APP% /managedRuntimeVersion:\"v4.0\" /managedPipelineMode:\"Integrated\" /startMode:AlwaysRunning /recycling.periodicRestart.time:00:00:00 /failure.rapidFailProtection:False /processModel.idleTimeoutAction:Suspend'  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create '%systemroot%\\system32\\inetsrv\\appcmd.exe add APP /path:/%APP% /physicalPath:C:\\%APP% /site.name:\"Default Web Site\" /applicationPool:%APP% /preloadEnabled:True'  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create '%systemroot%\\system32\\inetsrv\\appcmd.exe set CONFIG \"Default Web Site/%APP%\" /section:urlCompression /doStaticCompression:True'  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create '%systemroot%\\system32\\inetsrv\\appcmd.exe set CONFIG \"Default Web Site/%APP%\" /section:urlCompression /doDynamicCompression:True'  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create '%systemroot%\\system32\\inetsrv\\appcmd.exe unlock CONFIG /section:anonymousAuthentication'  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create '%systemroot%\\system32\\inetsrv\\appcmd.exe set CONFIG \"Default Web Site/%APP%\" /section:anonymousAuthentication /enabled:True'  \n  \n   \n ::設定應用程序的資料夾權限  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create 'cmd.exe /c icacls C:\\%APP% /grant \"IIS AppPool\\%APP%:F\"'  \n   \n  \n ::部署專案  \n  \n \"msdeploy.exe\" -verb:sync -source:iisApp='<專案路徑>PackageTmp' -dest:iisApp='Default Web Site/%APP%',ComputerName='https://<主機名稱>:8172/msdeploy.axd',UserName='<主機名稱>\\Administrator',Password='<管理者密碼>',AuthType='Basic',includeAcls='False' -disableLink:AppPoolExtension -disableLink:ContentExtension -disableLink:CertificateExtension -allowUntrusted  \n   \n  \n ::連線字串加密  \n  \n wmic /node:'<主機名稱>' /user:<網域\\管理者名稱> /password:'<管理者密碼>' process call create 'aspnet_regiis.exe -pef connectionStrings C:\\%APP%'\n```\n\n  \n   \n  \n","tags":["visual studio","dos command"]},{"title":"msdeploy(web deploy)後顯示錯誤連線{\"初始化字串的格式和開始於索引 0 的規格不相符\"}","url":"/2018/06/23/msdeploy-connection-error/","content":"狀況:  \n 部署後在web.config的連線字串會變成$(ReplacableToken\\_連線字串名稱-Web.config Connection String\\_0)  \n   \n 解法:  \n 在專案的csproj檔,在各組態的<PropertyGroup>都加入  \n <AutoParameterizationWebConfigConnectionStrings>False</AutoParameterizationWebConfigConnectionStrings>  \n   \n 來源:  \n [https://docs.microsoft.c](https://www.blogger.com/# \"https://www.blogger.com/#\")[om/zh-tw/aspnet/web-forms/overview/deployment/visual-studio-web-deployment/troubleshooting#format-of-the-initialization-string-does-not-conform-to-specification-starting-at-index-0](https://docs.microsoft.com/zh-tw/aspnet/web-forms/overview/deployment/visual-studio-web-deployment/troubleshooting#format-of-the-initialization-string-does-not-conform-to-specification-starting-at-index-0 \"https://docs.microsoft.com/zh-tw/aspnet/web-forms/overview/deployment/visual-studio-web-deployment/troubleshooting#format-of-the-initialization-string-does-not-conform-to-specification-starting-at-index-0\")\n","tags":["asp.net"]},{"title":"xlwings錯誤:module 'xlwings' has no attribute 'Book'","url":"/2018/05/30/xlwings-module-has-no-attribute/","content":"狀況:  \n Debug時會顯示錯誤,  \n 訊息為module 'xlwings' has no attribute 'Book'  \n [![](Image_20180530101816.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n   \n 解法:  \n 此錯誤是因為文件名稱(xlwings.py)跟module:xlwings相同所致,  \n 將文件名稱改成其他名稱即可。\n\n","tags":["python"]},{"title":"點擊Delphi專案檔時會顯示[傳送命令給程式時發生錯誤]而無法直接開啟","url":"/2018/05/24/open-delphi-project-file-error/","content":"【狀況】  \n 雙點dpr檔圖示(Delphi專案檔), 在開啟Delphi 時IDE卻顯示錯誤訊息,  \n 而直接開啟一個空的作業環境。  \n [![](Image_20180524173330.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n 【解法】  \n 開啟{登錄編輯程式}。  \n 搜尋{DelphiProject}，展開並刪除{ddeexec}這個機碼。  \n [![](Image_20180524173733.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n 將同階的{command}機碼的內容由  \n C:\\Delphi6\\Bin\\Delphi32.exe /np  \n 改為  \n C:\\Delphi6\\Bin\\Delphi32.exe \"%1\"  \n 即可。  \n [![](Image_20180524173753.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n   \n   \n   \n   \n   \n   \n   \n\n","tags":["delphi"]},{"title":"執行遠端主機的DOS指令","url":"/2018/05/22/execute-dos-command-remote-host/","content":"用單引號將各參數內容包起來以避免特殊符號造成錯誤(Invalid Global Switch)  \n\n```\n%windir%\\System32\\wbem\\wmic.exe /node:'{遠端主機名稱}' /user:'{網域\\使用者帳號}' /password:'{密碼}' process call create '{DOS指令}'\n```\n","tags":["dos command"]},{"title":"Web Deploy成功後執行指令","url":"/2018/05/22/execute-command-after-web_deploy/","content":"1.卸載專案  \n [![](step1.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n  \n   \n 2.編輯專案組態檔  \n [![](step2.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n3.在最下面加上\n\n```\n<Target Name=\"{自訂Task名稱}\" AfterTargets=\"MSDeployPublish\" Condition=\"{在哪種組態下執行}\">  \n     <Exec Command=\"{自訂命令}\" />  \n   </Target>\n```\n\n[![](step4.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n","tags":["visual studio"]},{"title":"開啟Delphi專案卻是其他專案路徑","url":"/2018/05/16/open-delphi-project-wrong-path/","content":"狀況:  \n開啟A專案，一開始卻帶出B專案的檔案  \n  \n原因:  \n在<專案名稱>.dsk會記錄關閉Delphi IDE前所開啟的檔案清單,  \n以利下次開啟時重新開啟加快使用者開發作業;  \n  \n先關閉該檔,再重新開啟該專案即可。\n","tags":["delphi"]},{"title":"增進開發效率的桌機設定","url":"/2018/05/15/improve-development-efficiency-windows-setting/","content":"\n1. 使用Ramdisk，並設定Windows/IE/Chrome/IIS暫存目錄路徑\n2. 優化記憶體設定，取消分頁檔及不需要開啟的服務等等\n3. Virtual Win設定2個虛擬桌面：桌面1為開發區，桌面2為除錯區\n4. 專案/我的文件夾/桌面路徑改設D槽，並設定自動備份排程\n5. 定期使用cleanmgr清除磁碟無效檔案\n6. 定期使用RegDelNull清除無效登錄檔\n7. 建立郵件分類規則\n","tags":["visual studio","windows","asp.net"]},{"title":"繼承的表單在設計工具檢視模式顯示錯誤訊息","url":"/2018/05/07/inherited-form-error-in-designer/","content":"父表單如下  \n[![](Image_20180504161919.png)](Image_20180504161919.png )  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n子表單使用父表單的物件  \n\n[![](Image_20180504161844.png)](Image_20180504161844.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n在設計工具檢視模式下會顯示錯誤訊息如下  \n(1)*並未將物件參考設定為物件的執行個體。*  \n\n[![](Image_20180504153342.png)](Image_20180504153342.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n或(2)類似如 *服務 System.Windows.Forms.Design.IEventHandlerService 已經存在於服務容器中。參數名稱: serviceType*  \n\n[![](Image_20180504135851.png)](Image_20180504135851.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n加上是否為DesignMode判斷式，編譯並重新打開設計工具檢視模式即可  \n\n[![](Image_20180504152049.png)](Image_20180504152049.png )\n\n  \n\n","tags":["visual studio","windows form"]},{"title":"檢查某目錄下檔案數量決定進行後續作業","url":"/2018/05/02/determine-action-by-file-count/","content":"\n```\n @ECHO OFF  \n ::初始化變數[檔案數量]  \n SET FileCount=0  \n ::遍歷檔案,累加到[檔案數量]  \n FOR %A IN (D:\\WorkDirectory\\*) DO SET /A FileCount+=1  \n ::如果[檔案數量]大於等於100則進行後續作業  \n IF %FileCount% GEQ 100 (ECHO \"file count greater or equal to 100!\")\n```\n","tags":["dos command"]},{"title":"GNU GLOBAL安裝/使用(for Windows)","url":"/2018/04/30/gnu-global-installation-on-windows/","content":"\n1. 下載GNU GLOBAL，解壓縮到C:\\GLOBAL。\n2. 下載Python 3並安裝。\n3. 我的電腦→右鍵→內容→進階系統設定→環境變數→系統變數→Path→新增C:\\GLOBAL\\bin。\n4. 系統變數→新增變數名稱GTAGSCONF，變數值C:\\GLOBAL\\share\\gtags\\gtags.conf。\n5. 系統變數→新增變數名稱GTAGSLABEL，變數值pygments。\n6. 使用gtags --debug驗證安裝是否正常。\n7. 使用gtags產生索引檔GTAGS,GRTAGS,GPATH\n8. 使用htags產生索引網站，命令列參數：--alphabet --other --symbol --tree-view --frame --fixed-guide --line-number --verbose --warning\n\n  \n  \n","tags":["windows","gnu global"]},{"title":"Delphi 6呼叫ASP.NET Web service","url":"/2018/04/25/delphi6-call-aspnet-web_service/","content":"\n1. 用WSDL Import將指定的 Web service 介面轉成 Delphi 的介面。\n2. 修改生成的檔案(如service.pas)  \n   [1]在RIO := THTTPRIO.Create(nil);的下一行加入  \n   RIO.HTTPWebNode.UseUTF8InHeader := True;  \n     \n   [2]在InvRegistry.RegisterDefaultSOAPAction(TypeInfo(ServiceSoap), 'http://<命名空間>/%operationName%');的下一行加入  \n   InvRegistry.RegisterInvokeOptions(TypeInfo(ServiceSoap), ioDocument);\n3. 添加參考並使用介面提供的函數呼叫即可[![](step3.png)](step3.png )\n\n  \n  \n\n","tags":["delphi"]},{"title":"選擇技術評估(=入坑前須知)","url":"/2018/04/12/technical-assessment-must-know/","content":"\n* **這項技術能解決什麼問題→要解決問題的重要程度為何(C/P值)**\n* **這項技術適用場景為何→使用者體驗？需要高度穩定性？需要跨平台？需要高效能？**\n* **這項技術的複雜度→入手難度？開發速度？維護成本？**\n* **所在地區的這項技術使用者人數→影響招人難度**\n* **這項技術的發展趨勢→很新、成熟、老技術、停止維護、已淘汰**\n* **這項技術的官方支援→解bug速度？參考文件多不多？**\n","tags":["踩坑"]},{"title":"用DUnit測試GUI介面","url":"/2018/03/29/test-gui-with-d_unit/","content":"1\\_參考要加入被測試表單的Unit。  \n\n[![](step1.png)](step1.png )\n\n2\\_在Setup方法加入初始化的動作。\n\n[![](step2.png)](step2.png )\n\n3\\_設定所要執行的動作。\n\n[![](step3.png)](step3.png )\n\n4\\_執行測試結果如下圖。\n\n[![](step4.png)](step4.png )\n\n  \n\n","tags":["testing","delphi"]},{"title":"SqlBulkCopy調整心得","url":"/2018/03/01/sqlbulkcopy-adjustment-experience/","content":"場景：  \n從MySQL同步數個Table到MSSQL，採取先清空(Truncate Table)再寫入的策略；  \n因為某些Table筆數較多(約百萬筆)，所以使用SqlBulkCopy類進行大量批次寫入。  \n  \n做法：  \n1\\_取得各Table的筆數,設定SqlBulkCopy.BatchSize屬性=該Table筆數。  \n  \n2\\_SqlBulkCopy.BulkCopyTimeout(逾時)設為0。  \n  \n3\\_設定SqlBulkCopyOptions.TableLock,可以更快完成,但寫入期間會造成Table被鎖定。  \n→個人測試加入此選項反而增加30秒的寫入時間。\n","tags":["sql",".net framework"]},{"title":"[構想]自主開發系統 - 資料儲存格式","url":"/2018/02/10/custom_development-data-format/","content":"\n資料儲存格式\n======\n\n格式如下:  \n資料1名稱:資料1型態=資料1內容;資料2名稱:資料2型態=資料2內容;資料3名稱:資料3型態=資料3內容;....\n\n1.儲存一般資料  \ncolumn1:int=23;column2:varchar(50)=\"test\";column3:datetime2(7)=2017-10-10 10:00:00.000;column4:bit=1;\n\n2.儲存二進位資料  \ncolumn5:varbinary(max)=0x3C3F786D6C2076657273696F6E3D22312E302220656E636F646...;\n\n3.儲存null  \ncolumn6:nvarchar(50)=null;\n","tags":["自主系統開發"]},{"title":"[構想]自主開發系統 - 權限設計","url":"/2018/02/10/custom_development-permission/","content":"\n權限設計\n====\n\n### (參考Apache Shiro權限功能)\n\n1.管理者\n\n| 角色 | 權限 |\n| --- | --- |\n| department1:role1 | \\* |\n\n說明:  \n在demartment1的role1可使用任何功能。\n\n2.針對各別功能設定權限\n\n| 角色 | 權限 |\n| --- | --- |\n| department2:role2 | function1:\\*;function2:add,view |\n\n說明:  \n在demartment2的role2 擁有function1的全部權限(新增/修改/刪除/觀看..等); 擁有function2的新增及觀看權限。\n\n3.針對所有功能設定權限\n\n| 角色 | 權限 |\n| --- | --- |\n| department3:role3 | \\*:view |\n\n說明:  \n在demartment3的role3在所有function都擁有觀看權限。\n\n4.針對所有角色設定權限\n\n| 角色 | 權限 |\n| --- | --- |\n| \\* | function3:view |\n\n說明: 所有role都擁有function3的觀看權限。\n","tags":["自主系統開發"]},{"title":"移除Excel保護密碼(★★★僅供還原遺留原始碼,請勿用在非法用途!!!★★★)","url":"/2018/02/09/remove-excel-protection-password/","content":"場景1:  \n前人遺留的Excel VBA專案,被密碼保護但沒人記得密碼  \n  \n解法1:  \n1\\_備份原始檔(很重要!)  \n2\\_在要解鎖的Excel VBA專案檔(以下簡稱[專案檔])按右鍵,用解壓縮軟體(本例用7-zip)開啟  \n3\\_進入 xl 目錄  \n4\\_編輯 vbaProject.bin 檔案(建議使用Notepad++)  \n5\\_尋找 DPB 這個字串  \n6\\_把它改成 DPx (或任一字串, 就是要改變它)  \n7\\_關閉編輯器後存檔  \n\n[![](step1%60.png)](step1%60.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n8\\_用Excel開啟修改後的[專案檔], 因為DPB被改成DPx,所以會顯示錯誤訊息如下,按[是]即可  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n9\\_出現錯誤訊息,按[確定]即可  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n10\\_開啟[開發人員]→[Visual Basic編輯器]  \n11\\_開啟[工具]→[VBAProject屬性]→[保護]→[檢視專案屬性的密碼]→輸入新的密碼  \n12\\_按[儲存]  \n13\\_關閉Excel  \n\n[![](step5.png)](step5.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n14\\_重新開啟修改後的專案檔,即可用新的密碼進入VBA專案。  \n  \n\\*\\*Worked in Excel 2016(64bit), Windows 10(xlsm, 啟用巨集的活頁簿)\\*\\*  \n  \n  \n場景2:  \n前人遺留純放資料的Excel,活頁簿(或工作表)被密碼保護但沒人記得密碼  \n  \n解法2:  \n1\\_備份原始檔(很重要!)  \n2\\_在要移除密碼的Excel檔按右鍵,用解壓縮軟體(本例用7-zip)開啟  \n3\\_進入 xl 目錄  \n4\\_活頁簿就編輯 workbook.xml 檔案,工作表就下一層worksheets→sheet1.xml(看第幾張表)  \n\n[![](aaaa.png)](aaaa.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\n[![](bb.png)](bb.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n5\\_活頁簿就尋找 workbookProtection 這個Tag並移除,工作表就尋找 sheetProtection 這個Tag並移除之  \n6\\_重新開啟修改後的Excel檔可發現已密碼移除  \n\n  \n參考來源:  \n(1)[Is there a way to crack the password on an Excel VBA Project? - Stack Overflow](https://stackoverflow.com/a/4107352/1472545 \"https://stackoverflow.com/a/4107352/1472545\")  \n(2)[#1 How To Remove Password From Excel | Unprotect Excel Password Remover](https://yodalearning.com/tutorials/remove-password-from-excel-trick/ \"https://yodalearning.com/tutorials/remove-password-from-excel-trick/\")\n\n","tags":["excel"]},{"title":"用更直覺的欄位名稱進行儲存格計算而不須使用位址參照(欄名列號)","url":"/2018/02/08/intuitive-column-name-cell-calculation/","content":"場景:  \n1\\_Excel常常會看到像這種相鄰的兩欄要做計算,但因為Excel的特性,  \n每一欄計算結果的公式會像這樣  \n=A2+B2  \n=A3+B3  \n=A4+B4  \n=A5+B5  \n‧‧‧‧‧‧  \n  \n其實很難看出A(及B)2,A(及B)3,A(及B)4...就是step1(及2)欄位  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n解法:  \n1\\_在[名稱管理員]新增step1(及2)欄位的[名稱]  \n2\\_[參照到:]輸入公式  \nstep1如右 **=****$A:$A**  \n\n* **$A:$A**→代表對應儲存格的該欄內所有的儲存格都指定成step1\n\n[![](qq.png)](qq.png )\n\n  \n  \n3\\_就可用比較直覺的公式\n\n=step1+step2  \n來計算結果,  \n而且每一列都不用修改參照位置  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\n","tags":["excel"]},{"title":"Windows 10 優化系統速度","url":"/2018/02/06/speedup-windows10/","content":"在[設定]>[尋找設定]>輸入\"選擇可以在背景執行的應用程式\"  \n [![](Capture_20180206215628.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n   \n 關閉[讓App在背景執行]選項即可。\n\n","tags":["windows"]},{"title":"SSIS引用第3方DLL發生異常","url":"/2018/02/01/ssis-reference-third_party-dll-exception/","content":"場景:  \n 1\\_SSIS專案引用第3方DLL(如想用epplus解析Excel內容)  \n [![](step2.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n   \n   \n 2\\_偵錯時顯示錯誤訊息而無法執行。  \n [![](step1.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")   \n   \n  \n解法:  \n 將第3方DLL加入GAC(全域組件快取)\n\n1\\_以管理員權限執行命令視窗。  \n 2\\_進入對應版本的.Net framework目錄下(本案例為SSIS 2014，使用.Net 4.0)  \n 所以到 C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v8.0A\\bin\\NETFX 4.0 Tools  \n 執行 gacutil.exe /i (DLL路徑)\\EPPlus.dll  \n [![](step3.png)](https://www.blogger.com/# \"https://www.blogger.com/#\")\n\n","tags":["ssis"]},{"title":"Windows 10 桌面右鍵選單出現\"很慢\"","url":"/2018/01/17/windows10-context_menu-slowly/","content":"一般狀況應該會在1秒內顯示右鍵選單, 延遲原因是因為被Intel顯卡右鍵選單拖慢。  \n\n[![](Capture_20180117232554.png)](Capture_20180117232554.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n對策:  \n在登錄檔,右鍵選單,Intel顯卡控制台移除即可。  \n將此機碼  \nHKEY\\_CLASSES\\_ROOT\\Directory\\Background\\shellex\\ContextMenuHandlers\\**igfxDTCM**  \n刪除。  \n  \n參考來源:[(分享)解決windows 10桌面右鍵選單反應很慢的方法](https://www.dcard.tw/f/3c/p/157357544 \"https://www.dcard.tw/f/3c/p/157357544\")\n\n","tags":["windows"]},{"title":"離線安裝Nuget套件","url":"/2017/12/27/install-nuget-package-offline/","content":"狀況:  \n當在僅有內網的環境下,有使用到Nuget的外部程式庫的開發需求。  \n  \n做法:  \n1.手動下載Nuget套件  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.新增Visual Studio Nuget套件的來源為本機路徑  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.即可在套件管理員搜尋到存於本機路徑的Nuget套件  \n\n[![](step3.png)](step3.png )\n\n  \n\n","tags":["visual studio"]},{"title":"列欄轉置語法(PIVOT)","url":"/2017/12/26/column-transposition-syntax-pivot/","content":"\n```\n SELECT \"欄位1\"  \n       ,\"欄位2\"  \n       ,\"欄位3\"  \n       ,\"A\",\"B\",\"C\",\"D\" /**轉置後的欄位*/  \n FROM  \n (  \n     SELECT \"欄位1\"  \n           ,\"欄位2\"  \n           ,\"欄位3\"  \n           ,\"條件欄位\"  \n           ,\"要統計的欄位\"  \n     FROM \"表格名稱\"  \n ) AS \"SOURCE\"  \n PIVOT  \n (  \n     SUM(\"要統計的欄位\") /**彙總函式*/  \n     FOR \"條件欄位\" IN (\"A\",\"B\",\"C\",\"D\") /**轉置後的欄位,即條件欄位的值*/  \n ) AS \"PIVOT_COLUMN\"\n```\n\n  \n   \n","tags":["sql"]},{"title":"Android Studio 無法Debug顯示錯誤訊息\"Error:Please select Android SDK\"","url":"/2017/12/20/android_studio-debug-sdk-error/","content":"\n狀況:  \n按[Debug]按鈕卻顯示組態視窗,並顯示錯誤訊息\"Error:Please select Android SDK\"\n\n[![](Image+1.png)](Image+1.png )\n\n解法:  \n重新Sync Project即可\n\n[![](Image+2.png)](Image+2.png )\n\n","tags":["android studio"]},{"title":"只在debug組態下設定變數及執行方法","url":"/2017/12/05/set-variable-method-in-debug/","content":"在程式片段前後加上**#if DEBUG**及**#endif**  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n當切換release組態則不會執行該程式片段;  \n另外視情況可加上**#else**作為當處於非debug模式(release或自訂組態)的動作。\n\n","tags":["visual studio"]},{"title":"Android Studio顯示錯誤訊息\"Cannot resolve XXX\"","url":"/2017/11/30/android_studio-cannot-resolve/","content":"狀況:  \n變數名稱顯示紅色,有錯誤訊息\"Cannot resolve XXX\"  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n解法:  \n1\\_在功能列>Build>Rebuild Project  \n\n[![](step2.png)](step2.png )\n\n  \n  \n2\\_當解法1無效時,可更動(如輸入空白再刪除等)build.gradle(Project)內容,以觸發Sync功能  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3\\_亦可嘗試清除快取  \n\n[![](step1.png)](step1.png )\n\n  \n\n","tags":["android studio"]},{"title":"SSRS無法解析ASP.NET Web Service回傳結果","url":"/2017/11/22/ssrs-cannot-parse-aspnet-result/","content":"場景:  \n1\\_使用ASP.NET建立Web Service，回傳結果格式為DataSet。  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2\\_欲使用SSRS將回傳結果當成Data Source以利重用，卻發現結果不是我們要的。  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3\\_建立自訂類別取代DataSet如下，將屬性為基本類型並設為公開：  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n4\\_SSRS可正確解析。  \n\n[![](step4.png)](step4.png )\n\n  \n\n","tags":["ssrs","asp.net","web service"]},{"title":"把\"文件\"釘選到Windows 10的[開始]畫面","url":"/2017/11/13/pin-file-to-start_screen/","content":"一般狀況只能將\"程式\"釘選到[開始]畫面,  \n但只要依照幾個步驟亦能釘選\"文件\"。  \n  \n1\\_建立捷徑。  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2\\_將捷徑移到  \nC:\\Users\\<帳號>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs  \n路徑下。  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3\\_捷徑會出現在程式集中,按右鍵即可加到[開始]畫面。  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n參考來源:[win 10 如何把檔案的捷徑拉到開始功能表的上面呢?](https://www.mobile01.com/topicdetail.php?f=300&t=4496270#57038977 \"https://www.mobile01.com/topicdetail.php?f=300&t=4496270#57038977\")\n\n","tags":["windows"]},{"title":"檢查XLL版本一直是舊版","url":"/2017/11/06/check-xll-always-old-version/","content":"**狀況**  \n使用FileVersionInfo類別的GetVersionInfo方法，  \n所得的FileVersion屬性一直是修改前的舊值(1.0.4)而不會更新(1.0.10)。  \n\n[![](oldversion.png)](oldversion.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n1\\_專案屬性>應用程式>組件資訊>檔案版本確實是1.0.10。  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2\\_<專案名稱>-AddIn.dna設定檔有加上UseVersionAsOutputVersion=\"true\"。  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n**解法**  \n將該檔案路徑停用共享，再重新開啟即正常。\n\n","tags":["excel-dna"]},{"title":"今天是[程式設計師節]!!","url":"/2017/10/24/programmers-day/","content":"\n```\n```\n  ___ ___                               ___________   ________    _____ ._.\n /   |   \\_____  ______ ______ ___.__. /_   \\   _  \\  \\_____  \\  /  |  || |\n/    ~    \\__  \\ \\____ \\\\____ <   |  |  |   /  /_\\  \\  /  ____/ /   |  || |\n\\    Y    // __ \\|  |_> >  |_> >___  |  |   \\  \\_/   \\/       \\/    ^   /\\|\n \\___|_  /(____  /   __/|   __// ____|  |___|\\_____  /\\_______ \\____   | __\n       \\/      \\/|__|   |__|   \\/                  \\/         \\/    |__| \\/\n```\n```\n","tags":["happy1024!"]},{"title":"[啟動/偵錯異常]The Ribbon/COM Add-in helper required by add-in \"增益集名稱\" Add-In could date: 2017-10-18 18:49:00 not be registered.","url":"/2017/10/18/ribbon-addin-register-error/","content":"狀況:  \n偵錯時發現Excel顯示錯誤訊息  \n\"The Ribbon/COM Add-in helper required by add-in \"增益集名稱\" Add-In could not be registered.\"  \n而無法載入增益集(如下圖)  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n解法:  \n當開發過程中如果發生例外狀況的次數較多時,  \nExcel有時會自動停用我們撰寫的增益集,  \n此時只要手動啟用即可  \n(工具列>選項>增益集>管理(A):>選[停用的項目]>執行(G)...>把\"增益集名稱\"啟用)  \n\n[![](step2.png)](step2.png )\n\n  \n\n","tags":["excel-dna"]},{"title":"在[檢視程式碼]←→[設計工具檢視]快速切換","url":"/2017/10/13/quickly-switch-between-code-designer/","content":"1\\_在Visual Studio的工具列的[工具]>[選項]，選項視窗的[環境]>[鍵盤]  \n輸入命令\"設計工具檢視\"，新增快速鍵\"F7\"，用於\"文字編輯器\"  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2\\_即可只用單一快速鍵\"F7\"就能在[檢視程式碼]←→[設計工具檢視]模式間快速切換  \n\n[![](step2.png)](step2.png )\n\n  \n\n","tags":["visual studio","windows form"]},{"title":"用Visual Studio Code對Python程式偵錯顯示錯誤訊息的解法","url":"/2017/10/10/vscode-show-python-debug-message/","content":"狀況:  \n1\\_已安裝Visual Studio 2017 Python開發環境(Python 3.6.2)  \n2\\_在Visual Studio Code對Python程式偵錯顯示錯誤訊息(如下圖)  \n\n[![](Image_20171009232420.png)](Image_20171009232420.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n解法:  \n1\\_在系統>進階系統設定>進階>環境變數>系統變數  \n選擇[Path]>按[編輯]  \n\n[![](Image_20171010162540.png)](Image_20171010162540.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2\\_新增Visual Studio 2017所安裝的Python 3的路徑(本例為C:\\Program Files\\Python36)  \n\n[![](Image_20171010162525.png)](Image_20171010162525.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3\\_重啟Visual Studio Code即可正常偵錯\n\n","tags":["python","visual studio code"]},{"title":"Excel-DNA輸出的XLL檔加上版本","url":"/2017/10/02/excel_dna-output-add-version/","content":"1\\_在設定檔<專案名稱>-AddIn.dna的節點  \n加上屬性UseVersionAsOutputVersion=\"true\"  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n2\\_專案屬性>應用程式>組件資訊>檔案版本，修改成現在的版次  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3\\_可利用類別FileVersionInfo的方法GetVersionInfo取得屬性FileVersion  \n\n[![](step4.png)](step4.png )\n\n  \n  \nPS\\_可將XLL檔加上DLL副檔名，即可確認版本屬性是否設定正確。  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n\n","tags":["excel-dna"]},{"title":"Excel-DNA已設中斷點卻不會中斷","url":"/2017/09/22/excel_dna-breakpoint-passthrough/","content":"狀況如下圖示:  \n\n[![](1.png)](1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n執行[清除]即恢復正常可中斷狀態。  \n\n[![](2.png)](2.png )\n\n  \n\n","tags":["excel-dna"]},{"title":"MSSQL連結MySQL","url":"/2017/09/22/mssql-link-to-mysql/","content":"\n1\\_在MySQL資料庫新增連線帳號(本例為root)允許存取的主機位址(本例為192.168.2.11)。\n\n[![](1_.png)](1_.png )\n\n2\\_設定root@192.168.2.11的存取權限(本例為Select)。\n\n[![](2_.png)](2_.png )\n\n3\\_在192.168.2.11設定ODBC驅動程式\n\n[![](3_.png)](3_.png )\n\n4\\_MySQL設定頁面1\n\n[![](4_1.png)](4_1.png )\n\n5\\_MySQL設定頁面2\n\n[![](5_.png)](5_.png )\n\n6\\_在192.168.2.11的SSMS設定連結伺服器(資料來源=ODBC驅動程式的名稱)\n\n[![](6_.png)](6_.png )\n\n7\\_連結伺服器頁面\n\n[![](7_.png)](7_.png )\n\n8\\_使用openquery語法即可查詢資料。\n\n[![](8_.png)](8_.png )\n\n","tags":["ssms"]},{"title":"透過超連結開啟本機端程式(URI Scheme)","url":"/2017/09/22/open-local-program-through-hyperlink/","content":"以鼎新Workflow ERP GP 系統為例:  \n  \n1\\_修改登錄檔  \n\n[![](1.png)](1.png )\n\n  \n  \n  \n\n\n\n\n\n\n\n\n**workflow**是在web頁面超連結的自訂通訊協定,  \n還要設定本機端程式的**路徑**及**參數**  \n\n2\\_在web頁面的超連結就可以輸入  \n\n\n\n\n\n  \n\n[![](2.png)](2.png )\n\n  \n  \n    \n\n3\\_點擊該超連結,如果瀏覽器是Chrome,則會顯示\n\n[![](setting.png)](setting.png )\n\n可選擇[記住..選擇],下次就會直接開啟鼎新Workflow ERP GP 系統。\n\n","tags":["web form"]},{"title":".NET Framework 4.7安裝在Windows 7 SP1的注意事項","url":"/2017/09/21/dotnet4_7-windows7_sp1-note/","content":"需先安裝  \n[update for D3DComplier (D3DCompiler\\_47.dll)](https://support.microsoft.com/en-gb/help/4020302/the-net-framework-4-7-installation-is-blocked-on-windows-7-windows-ser \"https://support.microsoft.com/en-gb/help/4020302/the-net-framework-4-7-installation-is-blocked-on-windows-7-windows-ser\")\n","tags":[".net framework"]},{"title":"刪除特定天數以前的檔案","url":"/2017/09/14/delete-file-older-specific-day/","content":"通常使用forfiles指令去遍歷某路徑下的檔案並執行刪除  \n 如:\n\n```\n forfiles /P \"D:\\xx\"[路徑] /D -3[天數] /C \"cmd /c del /q /f @file\"\n```\n\n  \n 若要刪除遠端主機的檔案(路徑格式為\\\\xx\\xx\\xx = UNC格式)，  \n 但因為forfiles不支援UNC格式，  \n 除了使用網路磁碟機對應(\\\\xx\\xx\\xx→X:\\)，  \n 還可以使用以下指令:  \n\n```\n PushD \"\\\\xx\\xx\\xx\"[UNC路徑] &&(  \n forfiles /D -3[天數] /C \"cmd /c del /q /f @file\"  \n ) & PopD\n```\n","tags":["dos command"]},{"title":"IIS設定遷移至新主機","url":"/2017/09/11/migrate-iis-setting-new-host/","content":"步驟:  \n1\\_在舊主機匯出IIS設定(站台及應用集區)  \n輸入指令(要以[系統管理員]權限執行):  \n\n```\n%windir%\\system32\\inetsrv\\appcmd list site /config /xml > d:\\sites.xml  \n%windir%\\system32\\inetsrv\\appcmd list apppool /config /xml > d:\\apppools.xml\n```\n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n2\\_刪除新主機預設站台及應用集區  \n\n[![](step2.png)](step2.png )\n\n[![](step3.png)](step3.png )\n\n  \n  \n3\\_匯入IIS設定到新主機即完成  \n輸入指令(要以[系統管理員]權限執行):  \n\n```\n%windir%\\system32\\inetsrv\\appcmd add site /in < d:\\sites.xml  \n%windir%\\system32\\inetsrv\\appcmd add apppool /in < d:\\apppools.xml\n```\n\n  \n  \n例外處理:  \n1\\_匯入應用集區設定檔時發生錯誤如下圖  \n[![](step5.png)](step5.png )  \n  \n  \n  \n  \n  \n2\\_因為舊主機IIS版本是10.0，而新主機是前1版的8.5，查閱MSDN可發現10.0新增一節點名為[environmentVariables]  \n\n[![](step4.png)](step4.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n所以將設定檔中所有8.5版本不支援的節點刪除，即可正常匯入。  \n\n[![](step6.png)](step6.png )\n\n  \n  \n  \n\n","tags":["internet information server"]},{"title":"在Windows認證下用另一台主機的本機帳號登入SQL Server","url":"/2017/08/18/login-mssql-local-account/","content":"\n```\nrunas /netonly /user:<另一台主機>\\<另一台主機的本機帳號> \"<另一台主機的執行檔路徑>\"\n```\n\n[![](Image_20170818124501.png)](Image_20170818124501.png )\n\n  \n\n","tags":["ssms"]},{"title":"偵錯時出現[由於另一個處理序正在使用檔案，所以無法執行該檔案]的訊息而無法偵錯","url":"/2017/08/17/debug-error-when-file-using/","content":"狀況：\n\n當按下[F5]開始偵錯時顯示錯誤訊息如下  \n![](step1.png)  \n  \n  \n解法:\n\n工作管理員刪除殘留的處理序DtsDebugHost.exe即可![](step2.png)\n\n","tags":["ssis"]},{"title":"用async/await避免UI無回應","url":"/2017/07/18/async-await-avoid-ui-unresponsive/","content":"private **async** void buttonExportExcel\\_Click(object sender, EventArgs e) {  \n    Button button = (Button)sender;  \n    button.Text = \"請稍候...\";  \n    button.Enabled = false;  \n    **await** Task.Run(() => {  \n        /\\*\\*用迴圈產生Excel內容的耗時作業\\*/  \n    });  \n    button.Text = \"匯出Excel\";  \n    button.Enabled = true;  \n    MessageBox.Show(\"儲存成功\");  \n}  \n  \n1.在Function新增async關鍵字,代表非同步作業。  \n 2.在耗時作業的部份加上await關鍵字,就會另外開啟執行緒處理,UI不會無回應。   \n   \n 參考:[Using Async and Await to update the UI Thread](https://www.blogger.com/# \"https://www.blogger.com/#\")\n","tags":["windows form"]},{"title":"ReportingService每日首次啟動緩慢","url":"/2017/06/27/ssrs-start-slowly-first-time/","content":"SSRS每12小時會回收資源,造成每日首次啟動緩慢的現象  \n我們可以增加RsReportServer.config的RecycleTime  \n但如果設太長導致未收回,恐會資源耗盡影響主機運作。  \n  \n較佳解法:  \n1.在SQL Agent設定每1分鐘執行1次的排程,  \n作用是模擬開啟SSRS首頁的行為,在資源回收後強制重新建立,  \n加快使用者開啟報表速度。  \n  \n2.執行類型:CmdExec  \n指令如下:  \n\n```\ncurl --ntlm --user <網域>/<使用者帳號>:<密碼> \"http://localhost/ReportServer/Pages/ReportViewer.aspx?%2f報表名稱\"\n```\n\nPS:curl執行檔需另外下載。  \n\n[![](runcurl.png)](runcurl.png )\n\n  \n\n","tags":["ssrs"]},{"title":"執行Office Automation異常","url":"/2017/06/22/office-automation-exception/","content":"狀況：用指令碼工作(或元件)執行Excel會顯示以下錯誤  \n[![](Image_20170622143636.png)](Image_20170622143636.png )  \n  \n  \n  \n  \n  \n  \n  \n解法：  \n1.執行【嵌入式管理單元】，指令：mmc(如果Excel是32位元，需新增參數 /32)  \n2.【檔案】>>【新增/移除崁入式管理單元】>>新增【元件服務】  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.【元件服務】>>【我的電腦】>>【DCOM設定】>>在【Microsoft Excel Application】按右鍵>>【內容】  \n\n[![](step3.png)](step3.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n4.【內容】>>【識別身份】頁籤>>【使用下列使用者】新增執行SQL AGENT的帳號(本例為prologium/mes)  \n\n[![](Image_20170622161048.png)](Image_20170622161048.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n5.【內容】>>【安全性】頁籤>>所有【權限】都新增執行SQL AGENT的帳號(本例為prologium/mes)  \n\n[![](step5.png)](step5.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\n[![](step6.png)](step6.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n參考:[Unhandled Exception: System.Runtime.InteropServices.COMException (0x800A03EC)](https://stackoverflow.com/questions/35642527/unhandled-exception-system-runtime-interopservices-comexception-0x800a03ec \"https://stackoverflow.com/questions/35642527/unhandled-exception-system-runtime-interopservices-comexception-0x800a03ec\")\n\n","tags":["ssis"]},{"title":"Visual Studio套件:SlowCheetah(切換設定檔)--載點","url":"/2017/05/25/visual_studio-extension-slowcheetah/","content":"使用方法網路上已有很多，這裡記錄下載的注意事項。  \n  \n如果使用Visual Studio 2013，要在GitHub下載→[https://github.com/sayedihashimi/slow-cheetah/releases/tag/v2.5.48](https://github.com/sayedihashimi/slow-cheetah/releases/tag/v2.5.48 \"https://github.com/sayedihashimi/slow-cheetah/releases/tag/v2.5.48\")  \n在Nuget安裝的版本，按右鍵不會顯示Add Transform。  \n官網的版本也只支援2015, 2017。\n","tags":["visual studio","testing","windows form"]},{"title":"MSSQL虛擬欄位(等同Oracle的ROWID)","url":"/2017/05/10/mssql-virtual-field-oracle-rowid/","content":"%%physloc%%  \n  \n內容:\n\n每筆資料的唯一識別值(即儲存位置)  \n\n[![](Image_20170510142134.png)](Image_20170510142134.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n作用:\n\n在規劃良好(有唯一主鍵/唯一索引鍵)的資料表其實派不上用場,  \n但可用來處理刪除重複資料(如上圖示)\n\n","tags":["sql"]},{"title":"Android Studio引用外部jar","url":"/2017/05/02/android_studio-reference-external-jar/","content":"1.取得宣告連結  \n\n[![](Image_20170502163145.jpg)](Image_20170502163145.jpg )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.在該項目的build.gradle增加  \n\n[![](gradle.png)](gradle.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.如果建置時發生錯誤【Duplicate files copied in APK META-INF/LICENSE】如下圖示:  \n\n[![](Image_20170508175212.png)](Image_20170508175212.png )\n\n  \n  \n  \n  \n  \n則需要再增加  \n\n```\nandroid {  \n     packagingOptions {  \n         exclude 'META-INF/DEPENDENCIES'  \n         exclude 'META-INF/NOTICE'  \n         exclude 'META-INF/LICENSE'  \n         exclude 'META-INF/LICENSE.txt'  \n         exclude 'META-INF/NOTICE.txt'  \n     }  \n }\n```\n\n  \n\\*\\*因為很多的第三方函式庫會拆解成多個(基本和擴充)，都擁有相同的版權宣告檔案，就會造成編譯時檔案衝突的錯誤而無法編譯。\n\n","tags":["android studio"]},{"title":"以系統事件(如Wifi連線時)觸發程式啟動","url":"/2017/05/02/trigger-program-by-system-event/","content":"在[系統管理工具]>[工作排程器]>[建立工作]>[觸發程序],  \n選擇[事件發生時]>[Microsoft-Windows-NetworkProfile/Operational],  \n如下圖方式輸入篩選條件:  \n\n[![](connect.png)](connect.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\\*\\*延遲工作的時間是確保程式啟動時網路已連接完成。\n\n","tags":["windows"]},{"title":"加速Android Studio/Gradle建置","url":"/2017/04/26/speedup-android_studio-gradle-build/","content":"1.在gradle.properties新增  \n #守護進程，改善Gradle的啟動和執行時間  \n org.gradle.daemon=true  \n #並行編譯  \n org.gradle.parallel=true  \n #按需配置，大型多項目的構建速度更快  \n org.gradle.configureondemand=true  \n #依主機配罝調整  \n org.gradle.jvmargs=-Xms2048m -Xmx2048m -XX:PermSize=512m -XX:MaxPermSize=512m  \n 參考:[Xms Xmx PermSize MaxPermSize 区别](https://www.blogger.com/# \"https://www.blogger.com/#\")  \n  \n  \n2.Gradle設定Use local gradle distribution和Offline work→避免編譯前更新  \n\n[![](%E5%9C%96%E7%89%8720170506_180043.png)](%E5%9C%96%E7%89%8720170506_180043.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.Compiler新增命令列參數--offline  \n\n[![](%E5%9C%96%E7%89%8720170506_033139.png)](%E5%9C%96%E7%89%8720170506_033139.png )\n\n  \n  \n4.SDK選21以上  \n  \n5.修改studio64.exe.vmoptions設定檔(與執行檔同一目錄)  \n新增(或修改)以下字段  \n-Xms2048m  \n -Xmx2048m  \n -XX:PermSize=512m  \n -XX:MaxPermSize=512m  \n -XX:ReservedCodeCacheSize=512m\n\n6.停用Android Studio未使用插件  \n**1.CVS Integration**  \n**2.Git Integration**  \n**3.GitHub**  \n**4.Google Cloud Tools for Android Studio**  \n**5.Subversion Integration**  \n\n[![](%E5%9C%96%E7%89%8720170506_023218.png)](%E5%9C%96%E7%89%8720170506_023218.png )\n\n","tags":["android studio"]},{"title":"SSIS設定需特別注意之處","url":"/2017/04/24/ssis-setting-note/","content":"SSISDB的[作業記錄檔]>>[保留週期]預設為365天， 在運行一段時期後，排程週期 x 執行專案數量 x 專案的元件數 所產生的log  \n 會使該DB容量激增，  \n 所以在初期規劃時就要注意該設定必須設在一個合理值。\n\n[![](1.png)](1.png )\n\n  \n  \n  \n記錄層次設為【效能】(只記錄錯誤事件)  \n\n[![](2.png)](2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n定期壓縮ldf檔(因[作業記錄檔]>[定期清除記錄檔]刪除動作會產生大量log)  \n→可加入到[SSIS Server Maintenance Job]的最後1個步驟。  \n\n[![](step1.png)](step1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n指令如下圖示:  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n需另外設定權限:  \n\n[![](step3.png)](step3.png )\n\n  \n\n","tags":["ssis"]},{"title":"取得遠端DB所連接伺服器的檢視有錯誤訊息","url":"/2017/04/21/connect-remote-database-error-message/","content":"狀況：要取得遠端DB=OA的特定資料表，但該資料表其實是以[連結的伺服器]=HRM所建立的View(如下圖)  \n  \n\n[![](%E7%B9%AA%E5%9C%962.png)](%E7%B9%AA%E5%9C%962.png )\n\n  \nSSIS程式會有以下問題：  \n1.OLE DB來源無法預覽，會顯示\"找不到資料行\"的錯誤訊息。  \n\n[![](1.png)](1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.\"指定一個以上的字碼頁\"的錯誤訊息。  \n\n[![](2.png)](2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n解法：把[OLE DB 來源]改成[ADO NET 來源]元件即可。  \n  \n  \n  \n參考：[How to add a linked server to the SSIS Data Flow destination?](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/554a360d-0265-4ff6-ab9b-d63fbaae5351/how-to-add-a-linked-server-to-the-ssis-data-flow-destination?forum=sqlintegrationservices \"https://social.msdn.microsoft.com/Forums/sqlserver/en-US/554a360d-0265-4ff6-ab9b-d63fbaae5351/how-to-add-a-linked-server-to-the-ssis-data-flow-destination?forum=sqlintegrationservices\")\n\n","tags":["ssis"]},{"title":"加速電腦啟動速度","url":"/2017/04/21/speedup-computer-startup/","content":"狀況：  \n如果有多個耗用資源較多的大型程式(如Outlook, Skype等)  \n都設定在開機時啟動，往往會影響開機的啟動速度。  \n  \n解法：  \n改以[工作排程器]延遲執行(如登入後5分鐘啟動)；  \n但因為此種執行方式的程式基本優先順序會為\"在標準以下\"，  \n為了不影響大型程式的執行效能，  \n所以要另外增加排程如下圖  \n\n[![](pro.png)](pro.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n用wmic指令將大型程式的基本優先順序提高到\"標準型\"。  \n\n```\nwmic process where name=\"OUTLOOK.EXE\" CALL setpriority \"normal\"\n```\n\n"},{"title":"建立磁碟用量監控機制","url":"/2017/04/17/establish-disk-usage-monitoring-mechanism/","content":"1.用dos指令取得欲監控主機的固定式磁碟使用率(drivetype=3)  \n\n```\nwmic logicaldisk where drivetype=3 get SystemName,Name,Size,FreeSpace > .\\127.0.0.1.txt\n```\n\n  \n  \n2.[欲監控主機]的[系統管理工具]>>[工作排程器]設定每小時25及55分執行1次[取得主機固定式磁碟使用率]的dos指令並匯出文字檔。  \n\n[![](step1.png)](step1.png )\n\n  \n\n[![](step2.png)](step2.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n3.使用SSIS解析文字檔，將超標數值設為[Parameters]，當使用率大於等於超標界線時即發信通知管理者。  \n\n[![](step3.png)](step3.png )\n\n  \n  \n\n","tags":["ssis"]},{"title":"SSIS讀入Excel只能讀到前幾列資料的解決方法","url":"/2017/04/17/ssis-read-first-row-problem/","content":"狀況:  \nUser將數個表格放在同一個工作表中，  \n用SSIS讀入發現前8列有值，但之後的列內容都是null。  \n  \n解法:  \n1.Excel檔的連線字串需增加IMEX=1→指定唯讀模式。  \n2.讀Excel的主機(開發區&正式區)的登錄檔需修改TypeGuessRows:8→0，  \n意指不以前8列推斷以下所有列的欄位型態  \n(因為當時前8列是屬於第1個表格，內容是數字，  \n但之後的列是屬於第2個表格，內容是文字，欄位型態不同導致讀取失敗)，  \n而是強制Excel讀取每列內容判斷欄位型態。  \n\n[![](type.png)](type.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n參考:[透過 OleDb 精準讀入](http://blog.miniasp.com/post/2008/08/05/How-to-read-Excel-file-using-OleDb-correctly.aspx \"http://blog.miniasp.com/post/2008/08/05/How-to-read-Excel-file-using-OleDb-correctly.aspx\")[Excel 檔的方法](http://blog.miniasp.com/post/2008/08/05/How-to-read-Excel-file-using-OleDb-correctly.aspx \"http://blog.miniasp.com/post/2008/08/05/How-to-read-Excel-file-using-OleDb-correctly.aspx\")\n\n","tags":["ssis"]},{"title":"Windows Form debug時拋出XmlSerializer例外","url":"/2017/04/14/xmlserializer-exception-thrown-windows_form/","content":"1.[Debug]>>[Exceptions]>>[Common Language Runtime Exceptions]>>[System.IO]>>[System.IO.FileNotFoundException]>>取消Thrown & User-unhandled  \n\n[![](exception.png)](exception.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.[Debug]>>[Exceptions]>>[Managed Debugging Assistants]>>[BindingFailure]>>取消Thrown  \n\n[![](Image_20170414132741.png)](Image_20170414132741.png )\n\n  \n  \n  \n  \n\n","tags":["windows form"]},{"title":"監看EasyFlow與DB間的SQL指令","url":"/2017/04/14/monitor-sql-command-between-easyflow_gp5_6/","content":"\n開啟[SQL Server Profiler]>>[新增追蹤]\n\n1.事件選取範圍  \n→選取事件RPC:Completed及SQL:BatchCompleted  \n\n[![](at1.png)](at1.png )\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n2.資料行篩選  \n在DatabaseName新增資料庫名稱  \n\n[![](at2.png)](at2.png )\n\n在TextData新增  \ndeclare @p1 int%  \nselect%  \nupdate%  \ndelete%  \ninsert%  \n\n[![](at3.png)](at3.png )\n\n  \n\n  \n  \n  \n  \n  \n  \n  \n3.即可在結果尋找相關的SQL指令\n\n[![](Image_20170414112019+%283%29.png)](Image_20170414112019+%283%29.png )\n\n","tags":["sql","easyflow gp","ssms"]},{"title":"Windows Form捕捉全域錯誤並處理","url":"/2017/04/14/windows_form-catch-global-error/","content":"在Program.cs的進入點(Main方法)新增  \n\n```\n// 宣告在Application.Run之前\n#region 捕捉全域錯誤\nApplication.ThreadException += new ThreadExceptionEventHandler(OnThreadException);\nApplication.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException);\nAppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(OnUnhandledException);\n#endregion\n```\n\n  \n 並在OnThreadException和OnUnhandledException事件做處理\n\n參考：[Application.SetUnhandledExceptionMode 方法](https://learn.microsoft.com/zh-tw/dotnet/api/system.windows.forms.application.setunhandledexceptionmode?view=windowsdesktop-8.0 \"https://learn.microsoft.com/zh-tw/dotnet/api/system.windows.forms.application.setunhandledexceptionmode?view=windowsdesktop-8.0\")\n","tags":["windows form"]},{"title":"Coded UI Test在本機執行方式","url":"/2017/04/14/run-coded-ui-test-locally/","content":"1.建立Coded UI Test專案並已新增測試方法。  \n2.建立Console專案，在進入點(Main方法)撰寫執行Coded UI Test方法的dos命令。  \n3.設定專案執行順序  \n[1]要被測試的Windows Form專案>>[2]呼叫Coded UI Test方法的Console專案 即可。  \n\n[![](test.png)](test.png )\n\n  \n  \n\n","tags":["testing"]},{"title":"SQL Agent顯示[指定的索引鍵不在字典中]的錯誤","url":"/2017/04/14/sql-agent-specified-index-error/","content":"狀況：查看之前Job的紀錄會顯示錯誤訊息如下圖。  \n\n[![](dic.png)](dic.png )\n\n  \n  \n解法：將管理工具選項重新安裝即可。  \n\n[![](mana.png)](mana.png )\n\n  \n  \n\n","tags":["ssms"]},{"title":"Error: 無法套用 ForEach Variable Mapping 數字 1 至變數 \"User::xxxx\"","url":"/2017/04/12/error-foreach-variable-mapping-1/","content":"狀況：此錯誤偶爾會發生，導致擷轉程式異常。  \n\n[![](step1.png)](step1.png )\n\n此元件所承接的結果是前1個元件(Execute SQL Task)所傳回的Result Set。\n\n[![](result2.png)](result2.png )\n\n解法：\n\n因為所傳回的Result Set含有NULL值，使用SQL指令過濾即可。\n\n[![](result.png)](result.png )\n\n  \n  \n\n","tags":["ssis"]},{"title":"將資料庫檔案附加到另一台主機無法以原帳號登入","url":"/2017/04/10/attach-database-file-another-host/","content":"因為該帳號存在於[資料庫].[DB\\_Name].[Security].[Users]  \n但不存在於[資料庫].[Security].[Users]  \n(或兩者設定不同)  \n  \n使用以下預存程式建立或同步設定  \n\n```\nEXEC sp_change_users_login 'Auto_Fix', '<有問題的帳號>', NULL, '<密碼>';\n```\n\n  \n  \n參考:[MS-SQL 資料庫還原到另一台主機無法登入](http://blog.xuite.net/tolarku/blog/39283410-MS-SQL+%E8%B3%87%E6%96%99%E5%BA%AB%E9%82%84%E5%8E%9F%E5%88%B0%E5%8F%A6%E4%B8%80%E5%8F%B0%E4%B8%BB%E6%A9%9F%E7%84%A1%E6%B3%95%E7%99%BB%E5%85%A5 \"http://blog.xuite.net/tolarku/blog/39283410-MS-SQL+%E8%B3%87%E6%96%99%E5%BA%AB%E9%82%84%E5%8E%9F%E5%88%B0%E5%8F%A6%E4%B8%80%E5%8F%B0%E4%B8%BB%E6%A9%9F%E7%84%A1%E6%B3%95%E7%99%BB%E5%85%A5\")\n","tags":["sql"]},{"title":"PSTools使用簡介","url":"/2017/04/07/ps_tools-introduction/","content":"1.**遠端安裝**  \n 1.1.\n\n```\npsexec \\\\<遠端電腦名稱> -accepteula -u <有管理權限的帳號> -p <密碼> -h cmd  \"/c <指令>“\n```\n\n  \n1.2. 案例：不在電腦前，想要安裝.net framework 4.6.2，可以下dos指令  \n\n```\npsexec \\\\192.168.3.201 -u prologium\\frank_tseng -p <我的密碼> -h cmd /c \\\\192.168.2.12\\mes\\NDP462-KB3151800-x86-x64-AllOS-ENU.exe /q /norestart /log %temp%\\NDP462-KB3151800-x86-x64-AllOS-ENU.htm\n```\n\n  \n  \n   \n 2.**遠端啟動服務**  \n 2.1.\n\n```\npsservice \\\\<遠端電腦名稱> -u <有管理權限的帳號> -p <密碼> start <服務名稱>\n```\n\n  \n 2.2. 案例：不在電腦前，想要啟動遠端桌面的服務，可以下dos指令  \n\n```\npsservice \\\\192.168.3.201 -u prologium\\frank_tseng -p <我的密碼> start termservice\n```\n"},{"title":"快速取得SQL連線字串","url":"/2017/04/07/quick-sql-connection-string/","content":"1.在桌面新增純文字文件,並改名為test.udl  \n2.雙擊該檔案開啟設置視窗如下  \n\n[![](udl.png)](udl.png )\n\n3.輸入連線資訊,按[確定]\n\n4.右鍵用文字編輯器(notepad++等)開啟,內容即為連線字串\n\n參考:[How to test an SQL Server connection](https://teusje.wordpress.com/2012/02/21/how-to-test-an-sql-server-connection/ \"https://teusje.wordpress.com/2012/02/21/how-to-test-an-sql-server-connection/\")\n\n","tags":["sql"]},{"title":"Visual Studio突破2GB Memory使用限制","url":"/2017/04/07/visual_studio-over-2gb-limit/","content":"\n在[Visual Studio 2013]>>[開發人員命令提示字元]\n\n按右鍵選單以系統管理員身分執行\n\n輸入editbin /LARGEADDRESSAWARE devenv.exe\n\n(原有執行檔建議先備份)\n\n[![](Image_20170407163554.png)](Image_20170407163554.png )\n\n  \n  \n參考:[[Visual Studio]使用Editbin命令讓Visual Studio突破2GB Memory使用限制](https://dotblogs.com.tw/larrynung/2011/11/03/50945 \"https://dotblogs.com.tw/larrynung/2011/11/03/50945\")\n\n","tags":["visual studio"]},{"title":"欄位別名在同一筆SQL指令立即使用","url":"/2017/04/07/field-alias-use-same-sql/","content":"使用通用資料表運算式(CTE)  \n  \n\n```\nWITH RESULT AS (  \n SELECT  \n     5 - 1 AS COLUMN1  \n     ,4 - 1 AS COLUMN2  \n )  \n SELECT COLUMN1, COLUMN2 FROM RESULT;\n```\n\n  \n  \n參考:[Tip: APPLY and Reuse of Column Aliases](http://sqlmag.com/blog/tip-apply-and-reuse-column-aliases \"http://sqlmag.com/blog/tip-apply-and-reuse-column-aliases\")\n","tags":["sql"]},{"title":"同一筆SQL指令進行新增/修改/刪除(MERGE)","url":"/2017/04/07/sql-merge-insert-update-delete/","content":"MERGE enginner AS Target  \nUSING(<比對的條件語法>) AS Source  \nON (Target.name = Source.name AND Target.dept = Source.dept)→目的和來源比較條件  \nWHEN MATCHED THEN→當目的符合來源就更新  \nUPDATE SET Target.position = Source.position  \nWHEN NOT MATCHED BY TARGET THEN→當目的無此紀錄就新增  \nINSERT (name, position) VALUES (Source.name, Source.position, Source.dept)  \nWHEN NOT MATCHED BY SOURCE THEN→當來源無此紀錄就刪除  \nDELETE;  \n  \n<比對的條件語法>  \n可以指定Table  \nSELECT name, position from employee  \n或指定固定值  \nSELECT ‘frank\\_tseng’ AS name, ‘engineer’ AS position  \n或指定參數(程式使用)  \nSELECT ? AS name, ? AS position  \n  \n\\*需MS SQL Server 2008以上;另外MERGE是ANSI SQL:2003的標準,  \n  每家資料庫廠商都有實作,所以不用擔心移殖的問題。  \n  \n\\*僅針對單一紀錄合併新增/更新/刪除動作。\n","tags":["sql"]},{"title":"面試問題","url":"/2017/04/07/interview-question/","content":"\n**## 1.** **確認專業度及工作價值觀**\n\n- 為何想離開原公司？：\n\n- 為何想投這個職位？：\n\n- 介紹工作及個人項目用到的技術\n\n  (做了哪些項目->應徵者當中是什麼角色->用什麼技術方案->為什麼選擇A方案而不是B方案)：\n\n- 履歷工作項目遇到的挫折(查核經歷及解決問題思路)：\n\n- 獨立作業或團隊合作？：\n\n- 詢問基本技術問題：\n\n- 學歷經歷矛盾疑義詢問：\n\n- 有無記筆記的習慣？：\n\n- 高危動作如何確認安全？：\n\n- 遇到沒需求的空檔會做什麼？：\n\n- 如果要請長假會如何安排工作？：\n\n- 如果遇到重複發生的問題？：\n\n- 對於自研系統被取代的看法？(任何語言任何系統只是提供服務的過渡手段)：\n\n \n\n**## 2.** **介紹工作項目環境**\n\n- 部門方向(導入或自研)：\n\n- 職位初期目標：\n\n- 職位是新設或頂替及前任離職原因：\n\n- 部門人員組成：\n\n- 主管管理風格：\n\n- on-call狀況：\n\n- 加班狀況：\n\n- 物理辧公環境(相鄰部門)：\n\n- 會議頻度：\n\n- 溝通管道：\n\n- 現有項目架構和技術：\n\n- 項目管理：\n\n- 開發流程(瀑布或敏捷)：\n\n- 開發環境建立(公版環境或需自行建立)：\n\n- 測試機制：\n\n- Bug管理：\n\n- 版控機制：\n\n- 監控機制：\n\n- 部署機制：\n\n- 知識管理：\n\n \n\n**## 3.** **總結**\n\n- 對應徵者的建議：\n","tags":["面試"]},{"title":"Visual Studio快速鍵","url":"/2017/04/07/visual_studio-shortcut/","content":"可在用到該方法的上一個/下一個位置快速移動方便找查。  \n  \n設定在該方法的各Reference間移動的快速鍵(個人是設定Ctrl+Shift+上下箭頭，如下圖)  \n\n[![](Image_20170407104604.png)](Image_20170407104604.png )\n\n  \n  \n\n[![](Image_20170407104630.png)](Image_20170407104630.png )\n\n  \n\n","tags":["visual studio"]},{"title":"DOM操作注意事項","url":"/2017/04/07/dom-operation-note/","content":"前提是要減少relayout及repaint。  \n  \n1.不逐一改變node屬性,用className或是cssText一次設定。  \n2.先設定node屬性,最後再一次插入childNode到DOM前。  \n3.使用DocumentFragment。  \n4.把要改變的node複製出來，設定好再取代舊的node。  \n5.或用display：none屬性把node隱藏，設定好再顯示。  \n6.如果要逐一改變屬性，則可快取屬性值，亦能提升效能。  \n  \n  \n參考：[【翻译】浏览器渲染Rendering那些事：repaint、reflow/relayout、restyle](http://www.cnblogs.com/ihardcoder/p/3927709.html \"http://www.cnblogs.com/ihardcoder/p/3927709.html\")\n","tags":["javascript"]}]